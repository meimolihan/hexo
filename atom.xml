<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>凡凡小站</title>
  
  
  <link href="https://www.meimolihan.eu.org/atom.xml" rel="self"/>
  
  <link href="https://www.meimolihan.eu.org/"/>
  <updated>2025-10-02T16:06:05.000Z</updated>
  <id>https://www.meimolihan.eu.org/</id>
  
  <author>
    <name>凡凡小站</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>iStoreOS 安装并配置 AdGuard Home 指南 📱</title>
    <link href="https://www.meimolihan.eu.org/posts/94f24954.html"/>
    <id>https://www.meimolihan.eu.org/posts/94f24954.html</id>
    <published>2025-10-02T16:06:05.000Z</published>
    <updated>2025-10-02T16:06:05.000Z</updated>
    
    <content type="html"><![CDATA[<h1>iStoreOS 安装并配置 AdGuard Home 指南 📱</h1><p><img src="https://file.meimolihan.eu.org/img/adguard_home-01.webp" alt=""></p><blockquote><p>本指南将详细介绍在 iStoreOS 系统中安装和配置 AdGuard Home 的完整流程。AdGuard Home 是一款开源的网络级广告拦截和隐私保护工具。</p></blockquote><ul><li><strong>monksy 博主视频</strong></li></ul><iframe src="//player.bilibili.com/player.html?isOutside=true&aid=115263886329564&bvid=BV1FHn4z1EBR&cid=32621596176&p=1&high_quality=1&danmaku=0&autoplay=0" scrolling="no" border="0" frameborder="no" framespacing="0" allowfullscreen="true" sandbox="allow-top-navigation allow-same-origin allow-forms allow-scripts" width="100%" height="446"></iframe><h2 id="📚-目录导航">📚 目录导航</h2><ul><li><a href="#core-requirements">🚀 简介</a></li><li><a href="#download-install">📥 一、下载并安装 AdGuard Home</a></li><li><a href="#initialization">⚙️ 二、AdGuard Home 初始化</a></li><li><a href="#configuration">🔧 三、AdGuard Home 配置</a></li><li><a href="#tips-notes">💡 四、使用技巧与注意事项</a></li><li><a href="#summary">🎯 总结</a></li></ul><p><a id="core-requirements"></a></p><h2 id="🚀-简介">🚀 简介</h2><p>本指南将详细介绍在 iStoreOS 系统中安装和配置 AdGuard Home 的完整流程。AdGuard Home 是一款开源的网络级广告拦截和隐私保护工具，具有以下特点：</p><p>✨ <strong>核心功能亮点</strong>：</p><ul><li>🛡️ <strong>全网广告拦截</strong> - 保护所有连接到网络的设备</li><li>🔒 <strong>隐私保护</strong> - 阻止跟踪器和恶意网站</li><li>⚡ <strong>DNS加速</strong> - 提升网络访问速度</li><li>📊 <strong>数据统计</strong> - 详细的上网行为分析</li><li>🎯 <strong>家长控制</strong> - 内容过滤和时间管理</li></ul><p><a id="download-install"></a></p><h2 id="一、📥-下载并安装-AdGuard-Home">一、📥 下载并安装 AdGuard Home</h2><h3 id="1-获取安装包">1. 获取安装包</h3><ul><li><strong>官方下载地址</strong>：<a href="https://github.com/AUK9527/Are-u-ok">GitHub Releases页面</a></li><li>💡 <em>建议选择与您设备架构匹配的版本</em></li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/adguard_home-001.webp" alt="下载界面截图"></p><h3 id="2-安装步骤">2. 安装步骤</h3><ol><li>登录 iStoreOS 管理界面</li><li>进入「软件包管理」</li><li>上传下载的 AdGuard Home 安装包</li><li>点击「安装」并等待完成</li></ol><p><a id="initialization"></a></p><h2 id="二、⚙️-AdGuard-Home-初始化">二、⚙️ AdGuard Home 初始化</h2><h3 id="1-启动-AdGuard-Home">1. 启动 AdGuard Home</h3><p><img src="https://file.meimolihan.eu.org/screenshot/adguard_home-002.webp" alt="启动界面"></p><p>🔧 <strong>启动注意事项</strong>：</p><ul><li>确保路由器有稳定的网络连接</li><li>检查防火墙设置是否允许相关端口</li></ul><h3 id="2-修改-iStoreOS-DNS-服务端口">2. 修改 iStoreOS DNS 服务端口</h3><p><img src="https://file.meimolihan.eu.org/screenshot/adguard_home-003.webp" alt="DNS端口修改"></p><p>📝 <strong>重要步骤</strong>：</p><ul><li>将默认的 DNS 服务端口从 53 改为其他端口（如 5353）</li><li>这一步是为了避免端口冲突</li></ul><h3 id="3-AdGuard-Home-初始化设置">3. AdGuard Home 初始化设置</h3><ul><li><strong>访问地址</strong>：<code>http://iStoreOS-IP地址:3000</code></li><li><strong>网页管理界面端口</strong>：3000</li><li><strong>DNS 服务端口</strong>：53（默认）</li><li>🎯 <em>其他设置保持默认即可完成基础配置</em></li></ul><p><a id="configuration"></a></p><h2 id="三、🔧-AdGuard-Home-配置">三、🔧 AdGuard Home 配置</h2><h3 id="1-上游-DNS-服务器配置">1. 上游 DNS 服务器配置</h3><figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">223.5.5.5</span></span><br><span class="line"><span class="number">119.29.29.29</span></span><br><span class="line">https://dns.alidns.com/dns-query</span><br><span class="line">https://doh.pub/dns-query</span><br><span class="line">https://dns.cloudflare.com/dns-query</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/adguard_home-004.webp" alt="上游DNS配置"></p><p>🌐 <strong>DNS服务器说明</strong>：</p><ul><li><strong>223.5.5.5</strong> - 阿里公共DNS，响应速度快</li><li><strong>119.29.29.29</strong> - 腾讯公共DNS，稳定性好</li><li><strong>DoH 服务器</strong> - 提供加密的DNS查询，增强隐私保护</li></ul><h3 id="2-DNS-黑名单配置">2. DNS 黑名单配置</h3><p><img src="https://file.meimolihan.eu.org/screenshot/adguard_home-005.webp" alt="黑名单配置"></p><p>🛡️ <strong>黑名单功能特点</strong>：</p><ul><li>拦截广告域名和跟踪器</li><li>阻止恶意软件和钓鱼网站</li><li>支持自定义规则添加</li><li>可导入第三方过滤列表</li></ul><p><a id="tips-notes"></a></p><h2 id="四、💡-使用技巧与注意事项">四、💡 使用技巧与注意事项</h2><h3 id="🔧-性能优化建议">🔧 性能优化建议</h3><ol><li><strong>定期更新过滤规则</strong> - 保持广告拦截效果</li><li><strong>监控系统资源</strong> - 确保路由器性能足够</li><li><strong>备份配置</strong> - 防止意外设置丢失</li></ol><h3 id="⚠️-常见问题解决">⚠️ 常见问题解决</h3><ul><li><strong>无法访问管理界面</strong>：检查端口设置和防火墙规则</li><li><strong>DNS解析失败</strong>：验证上游DNS服务器可用性</li><li><strong>广告拦截失效</strong>：更新过滤规则列表</li></ul><p><a id="summary"></a></p><h2 id="🎯-总结">🎯 总结</h2><p>通过本指南，您已经成功在 iStoreOS 上部署了 AdGuard Home，获得了：</p><p>✅ <strong>完整的广告拦截能力</strong><br>✅ <strong>增强的网络隐私保护</strong><br>✅ <strong>详细的网络使用统计</strong><br>✅ <strong>灵活的自定义配置选项</strong></p><p>🔄 建议定期检查更新和维护配置，以获得最佳的网络体验和安全性。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;iStoreOS 安装并配置 AdGuard Home 指南 📱&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/adguard_home-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="istoreos" scheme="https://www.meimolihan.eu.org/tags/istoreos/"/>
    
  </entry>
  
  <entry>
    <title>个人计划任务实战 📅</title>
    <link href="https://www.meimolihan.eu.org/posts/e13eccd7.html"/>
    <id>https://www.meimolihan.eu.org/posts/e13eccd7.html</id>
    <published>2025-09-29T13:07:17.000Z</published>
    <updated>2025-09-29T13:07:17.000Z</updated>
    
    <content type="html"><![CDATA[<h1>个人计划任务实战 📅</h1><p><img src="https://file.meimolihan.eu.org/img/linux-cron-01.webp" alt=""></p><blockquote><p>本文为您详细介绍如何在Linux系统中使用Cron计划任务，实现定时自动化运维，涵盖FnOS和Debian系统的实战配置案例。</p></blockquote><hr><h2 id="📖-文章导航目录">📖 文章导航目录</h2><ul><li><a href="#fnos-cron">⚙️ 一、FnOS 计划任务配置</a></li><li><a href="#debian-cron">🐧 二、Debian 计划任务配置</a></li><li><a href="#cron-management">🔍 三、Cron 任务管理操作</a></li><li><a href="#cron-test">🧪 四、测试计划任务</a></li><li><a href="#common-errors">⚠️ 五、常见错误与避坑指南</a></li></ul><hr><p><a id="fnos-cron"></a></p><h2 id="一、⚙️-FnOS-计划任务配置">一、⚙️ FnOS 计划任务配置</h2><p>以下是针对FnOS系统的实用计划任务配置，采用<strong>覆盖式</strong>写入方式，确保配置准确无误。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /var/spool/cron/crontabs/<span class="variable">$USER</span> &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">######## 我的计划任务 ########</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 添加更新 hosts 文件定时任务，每天凌晨一点十分执行</span></span><br><span class="line"><span class="comment">## ✨ 功能：自动更新DNS解析，解决网络访问问题</span></span><br><span class="line">10 1 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/hosts/DnsParse.py | python3 - &gt;&gt; /var/log/DnsParse.<span class="built_in">log</span> 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment">## hosts 文件同步到 emby &amp; nastools ，每天凌晨一点二十分执行</span></span><br><span class="line"><span class="comment">## 🔄 功能：多服务配置同步，保持环境一致性</span></span><br><span class="line">20 1 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh | /bin/bash -s -- -f /etc/hosts /vol1/1000/compose/emby/config/hosts /vol1/1000/compose/nastools/config/hosts</span><br><span class="line"></span><br><span class="line"><span class="comment">######## 我的计划任务 ########</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><strong>配置说明：</strong></p><ul><li>🕐 <strong>时间安排</strong>：凌晨1点执行，避开业务高峰时段</li><li>📊 <strong>日志记录</strong>：所有操作都记录到指定日志文件，便于监控和排查</li><li>🔗 <strong>远程脚本</strong>：直接执行云端脚本，便于统一管理和更新</li></ul><hr><p><a id="debian-cron"></a></p><h2 id="二、🐧-Debian-计划任务配置">二、🐧 Debian 计划任务配置</h2><p>针对Debian系统的专项计划任务，特别关注SSL证书管理和配置文件备份。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> &gt; /var/spool/cron/crontabs/<span class="variable">$USER</span> &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">######## 我的计划任务 ########</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 每天凌晨 3 点执行一次证书强制同步脚本</span></span><br><span class="line"><span class="comment"># 🔐 功能：保障网站SSL证书及时更新，避免证书过期风险</span></span><br><span class="line">0 3 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/ssl/allinssl_nginx_cert_daily.sh | /bin/bash &gt;&gt; /var/log/nginx/cert_update.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步 `nginx &amp; html` 目录，每天凌晨一点十分执行</span></span><br><span class="line"><span class="comment"># 💾 功能：关键配置文件定期备份，防止数据丢失</span></span><br><span class="line">10 1 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh | /bin/bash -s -- /etc/nginx/ /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-测试/nginx/</span><br><span class="line">15 1 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh | /bin/bash -s -- /var/www/html/ /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-测试/html/</span><br><span class="line"></span><br><span class="line"><span class="comment">######## 我的计划任务 ########</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><strong>安全提醒：</strong></p><ul><li>🛡️ <strong>证书安全</strong>：SSL证书自动更新确保网站安全访问</li><li>📦 <strong>数据备份</strong>：Nginx配置和网站文件定期备份，灾难恢复有保障</li><li>🗂️ <strong>路径规范</strong>：备份到云盘目录，实现异地存储</li></ul><hr><p><a id="cron-management"></a></p><h2 id="三、🔍-Cron-任务管理操作">三、🔍 Cron 任务管理操作</h2><p>掌握Cron任务的基本管理命令是运维必备技能。</p><h3 id="1-列出当前用户的Cron任务">1. 列出当前用户的Cron任务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br></pre></td></tr></table></figure><p>📋 <em>功能：查看已配置的所有定时任务</em></p><h3 id="2-编辑Cron任务">2. 编辑Cron任务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure><p>✏️ <em>功能：进入交互式编辑模式，修改或添加新任务</em></p><h3 id="3-删除所有Cron任务">3. 删除所有Cron任务</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -r</span><br></pre></td></tr></table></figure><p>🗑️ <em>功能：清空当前用户的所有计划任务（谨慎使用！）</em></p><hr><p><a id="cron-test"></a></p><h2 id="四、🧪-测试计划任务">四、🧪 测试计划任务</h2><h3 id="1-临时测试版（每分钟）：">1. 临时测试版（<strong>每分钟</strong>）：</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">* * * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh | /bin/bash -s -- /etc/nginx/ /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-测试/nginx/</span><br></pre></td></tr></table></figure><h3 id="2-用-watch-每秒看日志（可视化）">2. 用  <code>watch</code>  每秒看日志（可视化）</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 另一个终端</span></span><br><span class="line">watch -n 1 <span class="string">&#x27;tail -n 30 /var/log/nginx/cert_update.log&#x27;</span></span><br></pre></td></tr></table></figure><p><a id="common-errors"></a></p><h2 id="五、⚠️-常见错误与避坑指南">五、⚠️ 常见错误与避坑指南</h2><p>在Cron配置过程中，有些常见错误需要特别注意。</p><h3 id="❌-错误示范：使用不支持的进程替换语法">❌ 错误示范：使用不支持的进程替换语法</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 错误写法：cron默认使用/bin/sh，不支持 &lt;(...) 进程替换</span></span><br><span class="line">20 1 * * * bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) -f /etc/hosts /vol1/1000/compose/emby/config/hosts /vol1/1000/compose/nastools/config/hosts</span><br></pre></td></tr></table></figure><h3 id="✅-正确写法：使用管道方式">✅ 正确写法：使用管道方式</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 正确写法：兼容性更好，支持所有shell环境</span></span><br><span class="line">20 1 * * * /usr/bin/curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh | /bin/bash -s -- -f /etc/hosts /vol1/1000/compose/emby/config/hosts /vol1/1000/compose/nastools/config/hosts</span><br></pre></td></tr></table></figure><p><strong>语法修正对比：</strong></p><ul><li><code>bash &lt;(curl -sL URL)</code> → <code>/usr/bin/curl -sL URL | /bin/bash</code></li><li>🐚 <strong>原因</strong>：Cron默认使用<code>/bin/sh</code>，不支持bash的进程替换特性</li><li>🔧 <strong>解决方案</strong>：使用管道方式确保跨环境兼容</li></ul><hr><blockquote><p><strong>总结</strong>：通过合理配置Cron计划任务，您可以构建一个稳定可靠的自动化运维体系。记住：好的自动化不是一劳永逸，而是持续优化的过程！🚀</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;个人计划任务实战 📅&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/linux-cron-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文为您详细介绍如何在Linux系统中使用Cr</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
  </entry>
  
  <entry>
    <title>FnOS 核显调用失败解决方案 🖥️</title>
    <link href="https://www.meimolihan.eu.org/posts/2e2f78c.html"/>
    <id>https://www.meimolihan.eu.org/posts/2e2f78c.html</id>
    <published>2025-09-28T15:37:17.000Z</published>
    <updated>2025-09-28T15:37:17.000Z</updated>
    
    <content type="html"><![CDATA[<h1>FnOS 核显调用失败解决方案 🖥️</h1><p><img src="https://file.meimolihan.eu.org/img/i915-sriov-dkms-01.webp" alt=""></p><blockquote><p>在 Proxmox VE 虚拟化环境中部署的 FnOS 系统，虽然成功安装了 <strong>i915-sriov-dkms</strong> 驱动（通过应用商店安装），但在实际使用中发现 <strong>FnOS 影视应用无法正常调用核显硬件加速</strong>！😫</p></blockquote><hr><h2 id="📚-导航目录">📚 导航目录</h2><ul><li><a href="#solution-overview">🔧 一、解决方案概览</a></li><li><a href="#download-missing-firmware">📥 二、下载缺失固件</a></li><li><a href="#update-initramfs">🔄 三、更新initramfs镜像</a></li><li><a href="#verification-summary">💡 四、验证与总结</a></li></ul><hr><p><a id="solution-overview"></a></p><h2 id="一、🔧-解决方案概览">一、🔧 解决方案概览</h2><p>通过分析系统日志和驱动状态，发现问题根源在于 <strong>initramfs 镜像未包含必要的 Intel 核显固件</strong>。解决方案分为两个关键步骤：</p><ol><li><strong>📥 下载缺失的 Intel i915 固件文件</strong></li><li><strong>🔄 更新所有内核的 initramfs 镜像</strong></li></ol><p>整个流程简单高效，只需几个命令即可完成！✨</p><hr><p><a id="download-missing-firmware"></a></p><h2 id="二、📥-下载缺失固件">二、📥 下载缺失固件</h2><p>在更新 initramfs 时，系统提示缺少关键的 Intel i915 固件文件：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 初始更新时出现的警告信息</span></span><br><span class="line">W: Possible missing firmware /lib/firmware/i915/bxtg_dmc.bin <span class="keyword">for</span> module i915</span><br><span class="line">W: Possible missing firmware /lib/firmware/i915/skl_guc.bin <span class="keyword">for</span> module i915</span><br></pre></td></tr></table></figure><h3 id="🛠️-解决方案：手动下载缺失文件">🛠️ 解决方案：手动下载缺失文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载并放置缺失的固件文件</span></span><br><span class="line"><span class="built_in">sudo</span> wget http://share.geekxw.top/fnos/bmg_dmc.bin -O /lib/firmware/i915/bmg_dmc.bin</span><br><span class="line"><span class="built_in">sudo</span> wget http://share.geekxw.top/fnos/xe2lpd_dmc.bin -O /lib/firmware/i915/xe2lpd_dmc.bin</span><br></pre></td></tr></table></figure><h3 id="📝-固件说明">📝 固件说明</h3><ul><li><strong>bmg_dmc.bin</strong>：Intel Broxton/M 系列核显的显示微控制器固件</li><li><strong>xe2lpd_dmc.bin</strong>：Intel Xe/LPD 架构的电源管理固件</li><li>这些固件对核显的正常工作和电源管理至关重要！⚡</li></ul><hr><p><a id="update-initramfs"></a></p><h2 id="三、🔄-更新initramfs镜像">三、🔄 更新initramfs镜像</h2><h3 id="🎯-什么是initramfs？">🎯 什么是initramfs？</h3><p>initramfs（初始RAM文件系统）是一个临时的根文件系统，在Linux内核启动时加载，包含启动过程中必需的驱动、工具和配置文件。</p><h3 id="📋-更新步骤">📋 更新步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 更新所有已安装内核的initramfs镜像</span></span><br><span class="line"><span class="built_in">sudo</span> update-initramfs -u -k all</span><br></pre></td></tr></table></figure><h3 id="✅-成功输出示例">✅ 成功输出示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@FnOS:~# update-initramfs -u -k all</span><br><span class="line">update-initramfs: Generating /boot/initrd.img-6.12.18-trim</span><br></pre></td></tr></table></figure><h3 id="🔍-步骤说明">🔍 步骤说明</h3><ul><li><code>-u</code> 参数表示更新现有initramfs</li><li><code>-k all</code> 表示对所有已安装的内核版本执行此操作</li><li>完成后，系统重启时会自动加载新的initramfs，包含完整的核显驱动支持</li></ul><hr><p><a id="verification-summary"></a></p><h2 id="四、💡-验证与总结">四、💡 验证与总结</h2><h3 id="🧪-验证方法">🧪 验证方法</h3><p>更新完成后，建议：</p><ol><li><strong>重启系统</strong>：<code>sudo reboot</code></li><li><strong>检查驱动状态</strong>：<code>lsmod | grep i915</code></li><li><strong>验证核显识别</strong>：<code>lspci | grep VGA</code></li><li><strong>测试视频播放</strong>：在FnOS影视应用中播放高清视频</li></ol><h3 id="🎉-预期效果">🎉 预期效果</h3><ul><li>✅ FnOS影视应用正常调用核显硬件加速</li><li>✅ 视频播放流畅，CPU占用率显著降低</li><li>✅ 系统整体图形性能提升</li></ul><h3 id="📌-重要提醒">📌 重要提醒</h3><ul><li>定期检查系统更新，确保驱动和固件为最新版本</li><li>如遇问题，可查看系统日志：<code>dmesg | grep i915</code></li><li>不同硬件平台可能需要额外的固件文件</li></ul><hr><blockquote><p>🚀 <strong>扩展阅读</strong>：对于更复杂的虚拟化环境，还可以考虑在Proxmox VE层面配置GPU直通或vGPU方案，以获得更好的性能表现！</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;FnOS 核显调用失败解决方案 🖥️&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/i915-sriov-dkms-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;在 Proxmox </summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="fnos" scheme="https://www.meimolihan.eu.org/tags/fnos/"/>
    
  </entry>
  
  <entry>
    <title>Rsync 一键多目标增量同步脚本 🔁</title>
    <link href="https://www.meimolihan.eu.org/posts/b69cfb4e.html"/>
    <id>https://www.meimolihan.eu.org/posts/b69cfb4e.html</id>
    <published>2025-09-27T09:12:20.000Z</published>
    <updated>2025-09-27T09:12:20.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Rsync 一键多目标增量同步脚本 🔁</h1><p><img src="https://file.meimolihan.eu.org/img/rsync-02.webp" alt=""></p><blockquote><p>支持<strong>文件→多文件</strong>、<strong>目录→多目录</strong>双模式，彩色终端、实时进度、自动日志轮转、耗时统计，一条命令解决所有本地同步场景。</p></blockquote><hr><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#core-features">🌟 核心特性</a></li><li><a href="#script-architecture">⚙️ 脚本架构解析</a></li><li><a href="#installation-and-dependencies">📦 安装与依赖</a></li><li><a href="#usage-guide">🚀 使用指南</a><ul><li><a href="#directory-sync-without-f">📁 目录同步（不加 <code>-f</code>）</a></li><li><a href="#file-sync-with-f">📄 文件同步（加 <code>-f</code>）</a></li></ul></li><li><a href="#script-features-detail">🔍 脚本功能详解</a></li><li><a href="#automation-example-cron">🕐 自动化示例（cron）</a></li><li><a href="#common-options-combination">🔧 常用选项组合</a></li><li><a href="#log-system-detail">🗂️ 日志系统详解</a></li><li><a href="#troubleshooting-guide">⚠️ 故障排查指南</a></li><li><a href="#summary-and-tips">🎯 总结与技巧</a></li></ul><hr><p><a id="core-features"></a></p><h2 id="🌟-核心特性">🌟 核心特性</h2><h3 id="🎯-双模式智能识别">🎯 双模式智能识别</h3><ul><li><strong>目录模式</strong>：自动添加尾随斜杠，使用 <code>--delete</code> 保持一致性</li><li><strong>文件模式</strong>：精确同步单个文件，自动创建目标目录结构</li></ul><h3 id="🔧-自动化运维">🔧 自动化运维</h3><ul><li><strong>依赖自检</strong>：自动检测并安装 rsync 软件包</li><li><strong>目录自建</strong>：目标路径不存在时自动 <code>mkdir -p</code></li><li><strong>日志轮转</strong>：内置 15 天压缩轮转策略</li></ul><h3 id="📊-实时监控反馈">📊 实时监控反馈</h3><ul><li><strong>彩色进度</strong>：终端实时显示传输进度</li><li><strong>完成度估算</strong>：目录同步后计算空间占比</li><li><strong>耗时统计</strong>：精确到秒的任务执行时间</li></ul><h3 id="🛡️-错误处理机制">🛡️ 错误处理机制</h3><ul><li><strong>严格模式</strong>：<code>set -euo pipefail</code> 确保脚本健壮性</li><li><strong>状态检查</strong>：每个同步目标独立验证</li><li><strong>错误隔离</strong>：单目标失败不影响其他任务</li></ul><hr><p><a id="script-architecture"></a></p><h2 id="⚙️-脚本架构解析">⚙️ 脚本架构解析</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 脚本执行流程</span></span><br><span class="line">1. 参数解析 → 2. 环境检查 → 3. 依赖安装 → 4. 同步执行 → 5. 结果统计</span><br></pre></td></tr></table></figure><p><strong>核心函数说明</strong>：</p><ul><li><code>log()</code>: 双通道日志（终端彩色 + 文件纯文本）</li><li><code>sync_and_check()</code>: 核心同步逻辑，区分文件/目录模式</li><li>自动路径处理：智能处理尾随斜杠问题</li></ul><hr><p><a id="installation-and-dependencies"></a></p><h2 id="📦-安装与依赖">📦 安装与依赖</h2><h3 id="快速安装">快速安装</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 下载脚本到系统路径</span></span><br><span class="line"><span class="built_in">sudo</span> curl -o /usr/local/bin/rsync.sh https://raw.githubusercontent.com/your-repo/rsync.sh/main/rsync.sh</span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">chmod</span> 755 /usr/local/bin/rsync.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 验证安装</span></span><br><span class="line">rsync.sh --version</span><br></pre></td></tr></table></figure><hr><p><a id="usage-guide"></a></p><h2 id="🚀-使用指南">🚀 使用指南</h2><p><a id="directory-sync-without-f"></a></p><h3 id="📁-目录同步模式">📁 目录同步模式</h3><p><strong>使用示例</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) /源目录 /目标目录1 /目标目录2</span><br></pre></td></tr></table></figure><p><strong>关键参数说明</strong>：</p><ul><li><code>-a</code>: 归档模式（保留权限、时间戳等）</li><li><code>-v</code>: 详细输出</li><li><code>-h</code>: 人类可读格式</li><li><code>-z</code>: 压缩传输</li><li><code>-p</code>: 保留权限</li><li><code>--delete</code>: 删除目标中源不存在的文件</li></ul><p><a id="file-sync-with-f"></a></p><h3 id="📄-文件同步模式">📄 文件同步模式</h3><p><strong>使用示例</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) -f /源文件 /目标文件1 /目标文件2</span><br></pre></td></tr></table></figure><p><strong>与目录模式差异</strong>：</p><ul><li>不使用 <code>--delete</code> 选项</li><li>不添加尾随斜杠</li><li>不计算完成度百分比</li></ul><hr><p><a id="script-features-detail"></a></p><h2 id="🔍-脚本功能详解">🔍 脚本功能详解</h2><h3 id="颜色编码系统">颜色编码系统</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">RED=<span class="string">&#x27;\033[0;31m&#x27;</span>      <span class="comment"># 错误信息</span></span><br><span class="line">GREEN=<span class="string">&#x27;\033[0;32m&#x27;</span>    <span class="comment"># 成功信息  </span></span><br><span class="line">YELLOW=<span class="string">&#x27;\033[1;33m&#x27;</span>   <span class="comment"># 警告信息</span></span><br><span class="line">BLUE=<span class="string">&#x27;\033[0;34m&#x27;</span>     <span class="comment"># 流程信息</span></span><br><span class="line">PURPLE=<span class="string">&#x27;\033[0;35m&#x27;</span>   <span class="comment"># 同步开始</span></span><br><span class="line">CYAN=<span class="string">&#x27;\033[0;36m&#x27;</span>     <span class="comment"># 状态信息</span></span><br><span class="line">WHITE=<span class="string">&#x27;\033[1;37m&#x27;</span>    <span class="comment"># 统计信息</span></span><br></pre></td></tr></table></figure><h3 id="完成度计算逻辑">完成度计算逻辑</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算源和目标目录大小</span></span><br><span class="line">src_size=$(<span class="built_in">du</span> -sb <span class="string">&quot;<span class="variable">$source_path</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line">tgt_size=$(<span class="built_in">du</span> -sb <span class="string">&quot;<span class="variable">$tgt</span>&quot;</span> | awk <span class="string">&#x27;&#123;print $1&#125;&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算完成度百分比</span></span><br><span class="line">comp=$(awk -v s=<span class="variable">$src_size</span> -v t=<span class="variable">$tgt_size</span> <span class="string">&#x27;BEGIN&#123;printf &quot;%.2f&quot;,(t/s)*100&#125;&#x27;</span>)</span><br></pre></td></tr></table></figure><h3 id="智能路径处理">智能路径处理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自动去除源路径尾随斜杠</span></span><br><span class="line">source_path=<span class="string">&quot;<span class="variable">$&#123;1%/&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 目录模式自动添加斜杠</span></span><br><span class="line">rsync -avhzp --progress --delete <span class="string">&quot;<span class="variable">$source_path</span>/&quot;</span> <span class="string">&quot;<span class="variable">$tgt</span>/&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件模式保持原样</span></span><br><span class="line">rsync -avh --progress <span class="string">&quot;<span class="variable">$source_path</span>&quot;</span> <span class="string">&quot;<span class="variable">$tgt</span>&quot;</span></span><br></pre></td></tr></table></figure><hr><p><a id="automation-example-cron"></a></p><h2 id="🕐-自动化示例（cron）">🕐 自动化示例（cron）</h2><h3 id="生产环境部署示例">生产环境部署示例</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑系统定时任务</span></span><br><span class="line"><span class="built_in">sudo</span> crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每天凌晨2点同步网站数据（目录模式）</span></span><br><span class="line">0 2 * * * bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) /var/www/html /backup/www_daily &gt;&gt; /var/log/rsync/www.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每小时同步配置文件（文件模式）  </span></span><br><span class="line">0 * * * * bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) -f /etc/nginx/nginx.conf /backup/nginx/nginx.conf.$(<span class="built_in">date</span> +\%H)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每周日全量备份（多目标）</span></span><br><span class="line">0 3 * * 0 bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) /important_data /nas/backup /external_drive/backup --exclude=<span class="string">&#x27;temp/&#x27;</span></span><br></pre></td></tr></table></figure><hr><p><a id="common-options-combination"></a></p><h2 id="🔧-常用选项组合">🔧 常用选项组合</h2><h3 id="性能优化组合">性能优化组合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 大文件传输优化</span></span><br><span class="line">rsync.sh /large_files /target1 /target2 \</span><br><span class="line">    --partial \</span><br><span class="line">    --progress \</span><br><span class="line">    --bwlimit=100m \</span><br><span class="line">    --<span class="built_in">timeout</span>=300</span><br><span class="line"></span><br><span class="line"><span class="comment"># 海量小文件优化  </span></span><br><span class="line">rsync.sh /many_small_files /target1 /target2 \</span><br><span class="line">    -W \</span><br><span class="line">    --inplace \</span><br><span class="line">    --no-compress</span><br></pre></td></tr></table></figure><h3 id="安全同步组合">安全同步组合</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 重要数据安全同步</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) /critical_data /backup1 /backup2 \</span><br><span class="line">    --checksum \</span><br><span class="line">    --ignore-times \</span><br><span class="line">    --backup \</span><br><span class="line">    --backup-dir=/backups/old</span><br><span class="line"></span><br><span class="line"><span class="comment"># 跨网络加密同步</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/sync/rsync.sh) /sensitive_data /remote_backup \</span><br><span class="line">    -e <span class="string">&quot;ssh -p 2222 -i /path/to/key&quot;</span> \</span><br><span class="line">    --compress \</span><br><span class="line">    --<span class="built_in">timeout</span>=60</span><br></pre></td></tr></table></figure><hr><p><a id="log-system-detail"></a></p><h2 id="🗂️-日志系统详解">🗂️ 日志系统详解</h2><h3 id="日志格式规范">日志格式规范</h3><figure class="highlight subunit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[2025<span class="string">-09</span><span class="string">-26</span> 14:30:25] INFO: 检查源目录是否存在...</span><br><span class="line">[2025<span class="string">-09</span><span class="string">-26</span> 14:30:25] SUCCESS: ✓ 源目录存在：/home/data</span><br><span class="line">[2025<span class="string">-09</span><span class="string">-26</span> 14:30:26] INFO: 检查 rsync 是否安装...</span><br><span class="line">[2025<span class="string">-09</span><span class="string">-26</span> 14:30:26] SUCCESS: ✓ rsync 已就绪</span><br></pre></td></tr></table></figure><h3 id="轮转配置详情">轮转配置详情</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自动生成的轮转配置</span></span><br><span class="line">/var/log/rsync/*.<span class="built_in">log</span> &#123;</span><br><span class="line">    daily            <span class="comment"># 每天轮转</span></span><br><span class="line">    rotate 4         <span class="comment"># 保留4个备份</span></span><br><span class="line">    maxage 15        <span class="comment"># 最大保存15天</span></span><br><span class="line">    compress         <span class="comment"># 压缩旧日志</span></span><br><span class="line">    delaycompress    <span class="comment"># 延迟压缩</span></span><br><span class="line">    missingok        <span class="comment"># 文件不存在不报错</span></span><br><span class="line">    notifempty       <span class="comment"># 空文件不轮转</span></span><br><span class="line">    copytruncate     <span class="comment"># 复制截断，确保日志不丢失</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="日志分析技巧">日志分析技巧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看同步统计</span></span><br><span class="line">grep <span class="string">&quot;完成度约&quot;</span> /var/log/rsync/rsync.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分析同步耗时</span></span><br><span class="line">grep <span class="string">&quot;总用时&quot;</span> /var/log/rsync/rsync.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查错误信息</span></span><br><span class="line">grep -i <span class="string">&quot;失败\|error\|failed&quot;</span> /var/log/rsync/rsync.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># 按时间筛选日志</span></span><br><span class="line">sed -n <span class="string">&#x27;/2025-09-26 10:00:00/,/2025-09-26 11:00:00/p&#x27;</span> /var/log/rsync/rsync.log</span><br></pre></td></tr></table></figure><hr><p><a id="troubleshooting-guide"></a></p><h2 id="⚠️-故障排查指南">⚠️ 故障排查指南</h2><h3 id="常见错误代码">常见错误代码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># rsync 返回代码含义</span></span><br><span class="line">0: 成功</span><br><span class="line">1: 语法或使用错误</span><br><span class="line">2: 协议不兼容</span><br><span class="line">3: 文件选择错误</span><br><span class="line">4: 不支持的操作</span><br><span class="line">5: 协议启动失败</span><br><span class="line">6: 守护进程操作失败</span><br><span class="line">10: socket I/O 错误</span><br><span class="line">11: 文件 I/O 错误</span><br><span class="line">12: 协议数据流错误</span><br><span class="line">13: 权限错误</span><br><span class="line">14: 检查和不匹配</span><br><span class="line">20: 收到 SIGUSR1 或 SIGINT</span><br><span class="line">21: 等待子进程时出现错误</span><br><span class="line">22: 错误分配内存</span><br><span class="line">23: 部分传输</span><br><span class="line">24: 文件未完全传输</span><br><span class="line">25: 传输提前结束</span><br></pre></td></tr></table></figure><h3 id="调试模式启用">调试模式启用</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 手动启用详细调试</span></span><br><span class="line">bash -x /usr/local/bin/rsync.sh /source /target1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 临时修改脚本添加调试信息</span></span><br><span class="line"><span class="comment"># 在脚本开头添加：set -x</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查环境变量</span></span><br><span class="line"><span class="built_in">env</span> | grep -i rsync</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$PATH</span></span><br><span class="line"><span class="built_in">which</span> rsync</span><br></pre></td></tr></table></figure><h3 id="性能问题排查">性能问题排查</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查磁盘IO</span></span><br><span class="line">iostat -x 1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监控网络带宽</span></span><br><span class="line">iftop -i eth0</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查系统负载</span></span><br><span class="line">top -p $(pgrep rsync)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分析大文件</span></span><br><span class="line">find /source -<span class="built_in">type</span> f -size +100M -<span class="built_in">exec</span> <span class="built_in">ls</span> -lh &#123;&#125; \;</span><br></pre></td></tr></table></figure><hr><p><a id="summary-and-tips"></a></p><h2 id="🎯-总结与技巧">🎯 总结与技巧</h2><h3 id="最佳实践建议">最佳实践建议</h3><ol><li><strong>测试先行</strong>：首次使用添加 <code>--dry-run</code> 参数预览</li><li><strong>循序渐进</strong>：先单目标测试，再扩展多目标</li><li><strong>监控资源</strong>：大文件同步时监控系统负载</li><li><strong>备份配置</strong>：重要同步任务保存为脚本文件</li></ol><h3 id="高级使用技巧">高级使用技巧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 批量同步脚本模板</span></span><br><span class="line"><span class="comment">#!/bin/bash</span></span><br><span class="line">SOURCE_DIRS=(<span class="string">&quot;/data/www&quot;</span> <span class="string">&quot;/data/db&quot;</span> <span class="string">&quot;/data/logs&quot;</span>)</span><br><span class="line">TARGETS=(<span class="string">&quot;/backup/primary&quot;</span> <span class="string">&quot;/backup/secondary&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">source</span> <span class="keyword">in</span> <span class="string">&quot;<span class="variable">$&#123;SOURCE_DIRS[@]&#125;</span>&quot;</span>; <span class="keyword">do</span></span><br><span class="line">    rsync.sh <span class="string">&quot;<span class="variable">$source</span>&quot;</span> <span class="string">&quot;<span class="variable">$&#123;TARGETS[@]&#125;</span>&quot;</span> --exclude=<span class="string">&#x27;tmp/&#x27;</span> --bwlimit=50m</span><br><span class="line"><span class="keyword">done</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 条件同步（仅同步变化）</span></span><br><span class="line"><span class="keyword">if</span> [[ $(find /data -mmin -60 | <span class="built_in">wc</span> -l) -gt 0 ]]; <span class="keyword">then</span></span><br><span class="line">    rsync.sh /data /backup/data</span><br><span class="line"><span class="keyword">fi</span></span><br></pre></td></tr></table></figure><h3 id="版本更新记录">版本更新记录</h3><ul><li><strong>v1.2</strong> (2025-09-26): 新增文件模式(<code>-f</code>)，增强错误处理</li><li><strong>v1.1</strong>: 增加进度显示，完善日志轮转</li><li><strong>v1.0</strong>: 基础目录同步功能</li></ul><hr><h2 id="💫-结语">💫 结语</h2><p><code>rsync.sh v1.2</code> 通过精心设计的架构和丰富的功能特性，为系统管理员和开发人员提供了高效可靠的文件同步解决方案。无论是简单的日常备份还是复杂的多目标部署，这个工具都能显著提升工作效率。</p><p><strong>记住核心原则</strong>：📁 目录去 <code>-f</code>，📄 文件加 <code>-f</code>，🛣️ 路径自然写，🔧 脚本智能补！</p><blockquote><p>脚本持续维护中，欢迎反馈使用体验和功能建议！</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Rsync 一键多目标增量同步脚本 🔁&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/rsync-02.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;支持&lt;strong&gt;文件→多文件&lt;/s</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
    <category term="同步&amp;备份" scheme="https://www.meimolihan.eu.org/tags/%E5%90%8C%E6%AD%A5-%E5%A4%87%E4%BB%BD/"/>
    
  </entry>
  
  <entry>
    <title>Hugo + Stack 主题自定义 Widget 指南 ✨</title>
    <link href="https://www.meimolihan.eu.org/posts/83132735.html"/>
    <id>https://www.meimolihan.eu.org/posts/83132735.html</id>
    <published>2025-09-26T03:35:12.000Z</published>
    <updated>2025-09-26T03:35:12.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Hugo + Stack 主题自定义 Widget 指南 ✨</h1><p><img src="https://file.meimolihan.eu.org/img/stack-widget-01.webp" alt=""></p><blockquote><p><strong>本文摘抄自：<a href="https://letere-gzj.github.io/hugo-stack/p/hugo/custom-stack-widget/">莱特雷-letere</a></strong></p></blockquote><hr><h2 id="📚-导航目录">📚 导航目录</h2><ul><li><a href="#core-features">🚀 核心特点与优势</a></li><li><a href="#implementation">🛠️ 实现方法详解</a></li><li><a href="#clock-example">⏰ 实战示例：时钟组件</a></li><li><a href="#conclusion">🎯 总结与应用场景</a></li></ul><hr><p><a id="core-features"></a></p><h2 id="🚀-核心特点与优势">🚀 核心特点与优势</h2><p>Hugo Stack 主题的自定义 Widget 功能为博客侧边栏提供了极大的灵活性，主要特点包括：</p><h3 id="✨-核心优势">✨ 核心优势</h3><ul><li><strong>🔄 无缝集成</strong>：与 Stack 主题完美融合，无需修改主题源码</li><li><strong>🎨 高度自定义</strong>：支持 HTML、CSS、JavaScript 全栈开发</li><li><strong>📱 响应式设计</strong>：自动适配桌面和移动端布局</li><li><strong>⚡ 性能优化</strong>：组件按需加载，不影响页面整体性能</li></ul><h3 id="🔧-技术特性">🔧 技术特性</h3><ul><li>基于 Hugo 的模板系统，使用 <code>partials</code> 机制</li><li>支持现代前端技术栈（Vue/React 组件需编译后使用）</li><li>样式隔离，避免与主题样式冲突</li></ul><p><a id="implementation"></a></p><h2 id="🛠️-实现方法详解">🛠️ 实现方法详解</h2><h3 id="📁-文件结构规划">📁 文件结构规划</h3><p>创建以下目录结构来组织自定义 Widget：</p><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">layouts<span class="symbol">/</span></span><br><span class="line">└── partials<span class="symbol">/</span></span><br><span class="line">    └── widget<span class="symbol">/</span></span><br><span class="line">        ├── clock.html          <span class="comment"># 时钟组件</span></span><br><span class="line">        ├── weather.html        <span class="comment"># 天气组件</span></span><br><span class="line">        ├── recent-posts.html   <span class="comment"># 最新文章</span></span><br><span class="line">        └── custom-stats.html   <span class="comment"># 统计信息</span></span><br></pre></td></tr></table></figure><h3 id="📝-基础模板结构">📝 基础模板结构</h3><p>每个 Widget 应遵循以下标准结构：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 组件容器 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;custom-widget widget-&#123;&#123;.Name&#125;&#125;&quot;</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- HTML 内容区域 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;widget-content&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 你的组件内容 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 组件样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.widget-</span>&#123;&#123;<span class="selector-class">.Name</span>&#125;&#125; &#123;</span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 组件样式 */</span></span></span><br><span class="line"><span class="language-css">  <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">padding</span>: <span class="number">1rem</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">background</span>: <span class="built_in">var</span>(--card-background);</span></span><br><span class="line"><span class="language-css">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--shadow-l1);</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 组件脚本 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;DOMContentLoaded&#x27;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 组件交互逻辑</span></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;&#123;&#123;.Name&#125;&#125; widget loaded&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="⚙️-配置文件注册">⚙️ 配置文件注册</h3><p>在 <code>hugo.yaml</code> 中注册 Widget：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">params:</span></span><br><span class="line">  <span class="attr">widgets:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">search</span>                   <span class="comment"># 主题内置搜索</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">archives</span>                <span class="comment"># 归档列表</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">clock</span>                   <span class="comment"># 自定义时钟</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">recent-posts</span>            <span class="comment"># 最新文章</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tag-cloud</span>               <span class="comment"># 标签云</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">custom-widget</span>           <span class="comment"># 你的其他组件</span></span><br></pre></td></tr></table></figure><hr><p><a id="clock-example"></a></p><h2 id="⏰-实战示例：时钟组件">⏰ 实战示例：时钟组件</h2><h3 id="🎯-项目背景">🎯 项目背景</h3><p>基于开源项目 <a href="https://github.com/letere-gzj/pure-css3-clock">pure-css3-clock</a> 创建一个精美的 CSS3 时钟 Widget。</p><h3 id="📋-实现步骤">📋 实现步骤</h3><h4 id="步骤-1：创建组件文件">步骤 1：创建组件文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建 Widget 文件</span></span><br><span class="line"><span class="built_in">touch</span> layouts/partials/widget/clock.html</span><br></pre></td></tr></table></figure><h4 id="步骤-2：修改后的-clock-html">步骤 2：修改后的 <a href="https://cdn.meimolihan.eu.org/hugo/widget/clock.txt">clock.html</a></h4><h4 id="步骤-3：配置注册">步骤 3：配置注册</h4><p>在 <code>hugo.yaml</code> 中添加：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">params:</span></span><br><span class="line">  <span class="attr">widgets:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">search</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">archives</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">clock</span>    <span class="comment"># 新增时钟组件</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">tag-cloud</span></span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/stack-widget-001.webp" alt=""></p><hr><p><a id="conclusion"></a></p><h2 id="🎯-总结与应用场景">🎯 总结与应用场景</h2><h3 id="🌟-成功案例展示">🌟 成功案例展示</h3><p>通过自定义 Widget，你可以实现多种实用功能：</p><ol><li><p><strong>📊 数据展示类</strong></p><ul><li>网站统计信息</li><li>GitHub 贡献图</li><li>最新项目动态</li></ul></li><li><p><strong>🎯 交互功能类</strong></p><ul><li>搜索框增强</li><li>主题切换器</li><li>音乐播放器</li></ul></li><li><p><strong>📱 社交媒体集成</strong></p><ul><li>最新推文展示</li><li>GitHub 活动流</li><li>社交媒体链接</li></ul></li></ol><h3 id="🚀-最佳实践总结">🚀 最佳实践总结</h3><ol><li><strong>📝 代码组织</strong>：保持 HTML、CSS、JavaScript 分离和模块化</li><li><strong>🎯 用户体验</strong>：确保 Widget 加载快速且不影响主要内容</li><li><strong>🔧 维护性</strong>：添加适当的注释和文档</li><li><strong>📱 兼容性</strong>：测试不同浏览器和设备上的表现</li></ol><h3 id="🔮-扩展可能性">🔮 扩展可能性</h3><p>自定义 Widget 的潜力无限，你可以：</p><ul><li>集成第三方 API 服务</li><li>创建复杂的交互式图表</li><li>实现实时数据更新</li><li>构建迷你应用（如计算器、倒计时等）</li></ul><hr><blockquote><p>💫 <strong>开始创作吧！</strong> 利用 Hugo Stack 主题的强大扩展性，将你的创意转化为独特的侧边栏组件，让博客更加个性化和功能丰富。</p></blockquote><p><strong>📌 提示</strong>：在实际部署前，建议在本地充分测试 Widget 的功能和性能表现，确保为用户提供流畅的浏览体验。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Hugo + Stack 主题自定义 Widget 指南 ✨&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/stack-widget-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;s</summary>
      
    
    
    
    <category term="默认分类" scheme="https://www.meimolihan.eu.org/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
    <category term="hugo" scheme="https://www.meimolihan.eu.org/tags/hugo/"/>
    
  </entry>
  
  <entry>
    <title>Windows 系统激活指南 ✨</title>
    <link href="https://www.meimolihan.eu.org/posts/8e8c4482.html"/>
    <id>https://www.meimolihan.eu.org/posts/8e8c4482.html</id>
    <published>2025-09-26T01:35:30.000Z</published>
    <updated>2025-09-26T01:35:30.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Windows 系统激活指南 ✨</h1><p><img src="https://file.meimolihan.eu.org/img/win-activate-01.webp" alt=""></p><hr><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#system-activation-overview">📚 系统激活概述</a><ul><li><a href="#method-one-scripts">🔧 方法一：Microsoft Activation Scripts自动激活</a></li><li><a href="#method-two-kms">💻 方法二：KMS服务器手动激活</a></li></ul></li><li><a href="#activation-verification">🔍 激活状态查询与验证</a></li><li><a href="#precautions">⚠️ 注意事项与风险提示</a></li></ul><hr><p><a id="system-activation-overview"></a></p><h2 id="📚-系统激活概述">📚 系统激活概述</h2><p>Windows系统激活是验证操作系统合法性的必要步骤，确保用户能够享受完整的功能和安全更新。未激活的系统会面临功能限制和水印提示，影响正常使用体验。</p><p><strong>主要激活方式：</strong></p><ul><li>🔑 <strong>数字许可证激活</strong> - 绑定硬件ID的永久激活</li><li>🌐 <strong>KMS激活</strong> - 通过密钥管理服务的批量激活</li><li>📞 <strong>电话激活</strong> - 离线情况下的备用方案</li></ul><p><a id="method-one-scripts"></a></p><h2 id="🔧-方法一：Microsoft-Activation-Scripts自动激活">🔧 方法一：Microsoft Activation Scripts自动激活</h2><h3 id="项目介绍">项目介绍</h3><p>Microsoft Activation Scripts (MAS) 是一个开源项目，提供简单可靠的Windows和Office激活解决方案，支持多种激活方式。</p><p><strong>主要特点：</strong></p><ul><li>✅ <strong>完全免费</strong> - 无需付费购买激活工具</li><li>🔒 <strong>安全可靠</strong> - 开源代码透明，无恶意软件</li><li>🚀 <strong>一键操作</strong> - 简化复杂的激活流程</li><li>📱 <strong>多版本支持</strong> - 兼容Windows 7-11及各版本Office</li></ul><h3 id="使用步骤">使用步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 执行激活命令（需要管理员权限）</span></span><br><span class="line">irm https://get.activated.win | iex</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 验证激活状态</span></span><br><span class="line">slmgr.vbs -xpr</span><br></pre></td></tr></table></figure><p><strong>执行流程说明：</strong></p><ol><li>以管理员身份打开PowerShell</li><li>输入激活命令后按Enter</li><li>脚本自动检测系统并选择最优激活方案</li><li>等待激活完成提示</li></ol><p><a id="method-two-kms"></a></p><h2 id="💻-方法二：KMS服务器手动激活">💻 方法二：KMS服务器手动激活</h2><h3 id="KMS激活原理">KMS激活原理</h3><p>KMS（Key Management Service）是微软官方提供的批量激活服务，通过连接特定的KMS服务器实现180天周期的激活。</p><h3 id="详细操作步骤">详细操作步骤</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 第一步：安装产品密钥</span></span><br><span class="line">slmgr /ipk W269N-WFGWX-YVC9B-4J6C9-T83GX</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第二步：设置KMS服务器地址</span></span><br><span class="line">slmgr /skms kms.03k.org</span><br><span class="line"></span><br><span class="line"><span class="comment"># 第三步：执行激活</span></span><br><span class="line">slmgr /ato</span><br></pre></td></tr></table></figure><p><strong>密钥说明：</strong></p><ul><li>🏢 <strong>企业版密钥</strong>：W269N-WFGWX-YVC9B-4J6C9-T83GX</li><li>🔄 <strong>定期续期</strong>：需每180天重新连接KMS服务器</li><li>🌍 <strong>服务器选择</strong>：可使用多个公共KMS服务器备用</li></ul><p><a id="activation-verification"></a></p><h2 id="🔍-激活状态查询与验证">🔍 激活状态查询与验证</h2><h3 id="激活状态检查命令">激活状态检查命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看详细激活信息</span></span><br><span class="line">slmgr -dlv</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查激活剩余时间</span></span><br><span class="line">slmgr.vbs -xpr</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看安装的产品密钥</span></span><br><span class="line">slmgr -dli</span><br></pre></td></tr></table></figure><h3 id="验证指标说明">验证指标说明</h3><ul><li>✅ <strong>许可证状态</strong>：显示&quot;已授权&quot;或&quot;Licensed&quot;</li><li>📅 <strong>到期时间</strong>：KMS激活显示剩余天数</li><li>🔢 <strong>密钥类型</strong>：区分零售版、批量版等</li><li>🌐 <strong>激活方式</strong>：数字许可、KMS、MAK等</li></ul><p><a id="precautions"></a></p><h2 id="⚠️-注意事项与风险提示">⚠️ 注意事项与风险提示</h2><h3 id="安全建议">安全建议</h3><ol><li>🔐 <strong>权限管理</strong>：始终以管理员身份运行激活命令</li><li>📁 <strong>备份数据</strong>：激活前重要数据备份</li><li>🔄 <strong>系统还原点</strong>：创建系统还原点以防万一</li><li>🌐 <strong>网络环境</strong>：确保稳定的网络连接</li></ol><h3 id="常见问题处理">常见问题处理</h3><ul><li>❌ <strong>激活失败</strong>：检查网络连接和防火墙设置</li><li>⚠️ <strong>安全软件拦截</strong>：暂时关闭杀毒软件</li><li>🔄 <strong>命令无效</strong>：确认PowerShell版本兼容性</li><li>📛 <strong>密钥无效</strong>：尝试更换其他可用密钥</li></ul><h3 id="法律风险提示">法律风险提示</h3><blockquote><p>⚖️ <strong>重要声明</strong>：请确保在合法授权的系统上使用激活工具，遵守当地法律法规和微软软件许可条款。本指南仅提供技术参考，不鼓励盗版行为。</p></blockquote><hr><p><strong>📞 技术支持</strong>：如遇激活问题，建议查阅项目官方文档或相关技术论坛获取最新解决方案。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Windows 系统激活指南 ✨&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/win-activate-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;📋-导航目录&quot;&gt;📋 导航目录&lt;/h</summary>
      
    
    
    
    <category term="Windows" scheme="https://www.meimolihan.eu.org/categories/Windows/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
  </entry>
  
  <entry>
    <title>Linux 系统初始化配置完全指南 🚀</title>
    <link href="https://www.meimolihan.eu.org/posts/97bdd5cf.html"/>
    <id>https://www.meimolihan.eu.org/posts/97bdd5cf.html</id>
    <published>2025-09-25T08:13:48.000Z</published>
    <updated>2025-09-25T08:13:48.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Linux 系统初始化配置完全指南 🚀</h1><p><img src="https://file.meimolihan.eu.org/img/linux-system-01.webp" alt=""></p><blockquote><p>本指南提供了完整的 Linux 系统初始化配置方案，涵盖从基础软件安装到高级服务配置的各个方面。通过使用这些脚本和配置。</p></blockquote><hr><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#install-software-and-update">📦 一、安装常用软件 + 更新并清理系统</a></li><li><a href="#enable-ssh-script">🔧 二、Linux 开启 SSH 脚本</a></li><li><a href="#install-docker-script">🐳 三、Linux 安装 Docker 脚本</a></li><li><a href="#install-docker-compose">📦 四、Linux 安装 docker-compose</a></li><li><a href="#configure-samba">💾 五、Linux 配置 samba 服务</a><ul><li><a href="#samba-server-side">🖥️ 1. 作为 samba 服务端</a></li><li><a href="#samba-client">💻 2. 作为 samba 客户端</a></li></ul></li><li><a href="#git-ssh-config">🔑 六、Git SSH 配置流程</a><ul><li><a href="#gitee-ssh-config">🐱 1. Gitee SSH 配置流程</a></li><li><a href="#github-ssh-config">🐱 2. GitHub SSH 配置流程</a></li></ul></li><li><a href="#summary">💫 总结</a></li></ul><hr><p><a id="install-software-and-update"></a></p><h2 id="一、📦-安装常用软件-更新并清理系统">一、📦 安装常用软件 + 更新并清理系统</h2><p><strong>✨ 功能特点：</strong></p><ul><li>🚀 <strong>一键式安装</strong>：通过单条命令完成常用软件的安装和系统更新</li><li>🛡️ <strong>安全升级</strong>：全面升级系统补丁，提升安全性</li><li>🧹 <strong>智能清理</strong>：自动移除无用包，释放磁盘空间</li><li>📦 <strong>精选软件集</strong>：包含开发、运维、文件管理等核心工具</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vercel 仓库</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/init/init.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 仓库</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/init/init.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/linux-init-001.webp" alt=""></p><p><strong>🔧 包含的软件包说明：</strong></p><ul><li><strong>文本编辑</strong>：<code>nano</code> - 简单易用的命令行文本编辑器</li><li><strong>版本控制</strong>：<code>git</code> - 分布式版本控制系统</li><li><strong>文件同步</strong>：<code>rsync</code> - 高效的文件同步工具</li><li><strong>压缩解压</strong>：<code>zip</code>, <code>unrar-free</code> - 文件压缩和解压工具</li><li><strong>远程访问</strong>：<code>openssh-server</code> - SSH 服务端，支持远程连接</li><li><strong>网络工具</strong>：<code>wget</code> - 文件下载工具</li><li><strong>文件管理</strong>：<code>tree</code> - 目录树状显示工具</li><li><strong>文件共享</strong>：<code>samba</code>, <code>nfs-kernel-server</code>, <code>nfs-common</code> - 网络文件共享服务</li></ul><hr><p><a id="enable-ssh-script"></a></p><h2 id="二、🔧-Linux-开启-SSH-脚本">二、🔧 Linux 开启 SSH 脚本</h2><p><strong>🌟 脚本特色：</strong></p><ul><li>✅ <strong>多发行版支持</strong>：兼容主流 Linux 发行版（Debian, Ubuntu, CentOS, RHEL, Fedora, OpenSUSE, Arch Linux）</li><li>🔒 <strong>安全配置</strong>：自动优化 SSH 安全设置</li><li>⚡ <strong>快速部署</strong>：一键完成 SSH 服务安装和配置</li><li>📊 <strong>状态监控</strong>：实时显示服务状态和连接信息</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/ssh/setup-ssh.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/setup-ssh-001.webp" alt="SSH 配置示例"></p><p><strong>🛡️ 安全特性：</strong></p><ul><li>自动配置防火墙规则</li><li>禁用 root 直接登录（可选）</li><li>设置密钥认证优先</li><li>配置登录超时和尝试次数限制</li></ul><hr><p><a id="install-docker-script"></a></p><h2 id="三、🐳-Linux-安装-Docker-脚本">三、🐳 Linux 安装 Docker 脚本</h2><p><strong>🎯 功能亮点：</strong></p><ul><li>🔄 <strong>自动检测</strong>：智能识别系统版本和架构</li><li>📦 <strong>完整安装</strong>：包含 Docker Engine、CLI、Containerd 等组件</li><li>🔧 <strong>优化配置</strong>：自动设置镜像加速器和存储驱动</li><li>🚀 <strong>快速启动</strong>：安装后立即启动并启用服务</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL kejilion.sh) docker install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/docker/install-docker.sh)</span><br></pre></td></tr></table></figure><p><strong>💡 Docker 优势：</strong></p><ul><li>🏗️ <strong>容器化部署</strong>：应用隔离，环境一致性</li><li>⚡ <strong>快速启动</strong>：秒级启动和停止</li><li>📦 <strong>镜像管理</strong>：便捷的应用打包和分发</li><li>🔄 <strong>版本控制</strong>：支持镜像版本管理和回滚</li></ul><hr><p><a id="install-docker-compose"></a></p><h2 id="四、📦-Linux-安装-docker-compose">四、📦 Linux 安装 docker-compose</h2><p><strong>🚀 主要特性：</strong></p><ul><li>🎯 <strong>精准版本</strong>：指定稳定版本安装，确保兼容性</li><li>🔒 <strong>权限配置</strong>：自动设置正确的执行权限</li><li>✅ <strong>验证安装</strong>：安装后立即验证版本信息</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">wget -c -O /usr/bin/docker-compose https://github.com/docker/compose/releases/download/v2.39.4/docker-compose-linux-x86_64 &amp;&amp; \</span><br><span class="line"><span class="built_in">chmod</span> 755 /usr/bin/docker-compose &amp;&amp; \</span><br><span class="line">docker-compose version</span><br></pre></td></tr></table></figure><p><strong>🔗 资源信息：</strong></p><ul><li>GitHub 项目地址：<a href="https://github.com/docker/compose/releases">https://github.com/docker/compose/releases</a></li></ul><p><strong>💪 docker-compose 优势：</strong></p><ul><li>📝 <strong>YAML 配置</strong>：使用简单的 YAML 文件定义多容器应用</li><li>🔄 <strong>一键部署</strong>：单命令启动/停止整个应用栈</li><li>🌐 <strong>服务编排</strong>：轻松管理多个关联的容器服务</li><li>📊 <strong>状态管理</strong>：实时查看各服务状态和日志</li></ul><hr><p><a id="configure-samba"></a></p><h2 id="五、💾-配置-samba-服务">五、💾 配置 samba 服务</h2><p><a id="samba-server-side"></a></p><h3 id="🖥️-作为-samba-服务端">🖥️ 作为 samba 服务端</h3><p><strong>🎪 功能特点：</strong></p><ul><li>🌐 <strong>跨平台共享</strong>：支持 Windows、Linux、macOS 客户端访问</li><li>👥 <strong>用户管理</strong>：灵活的权限控制和用户认证</li><li>📁 <strong>多共享目录</strong>：支持配置多个共享文件夹</li><li>🔒 <strong>安全配置</strong>：支持加密传输和访问控制</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/samba/samba_setup.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/samba-setup-001.webp" alt="samba 服务端示例"></p><p><strong>✅ 支持的系统</strong>: Ubuntu, Debian, CentOS, RHEL, Fedora</p><p><a id="samba-client"></a></p><h3 id="💻-作为-samba-客户端">💻 作为 samba 客户端</h3><p><strong>🔗 连接特性：</strong></p><ul><li>🔄 <strong>自动挂载</strong>：支持开机自动挂载远程共享</li><li>📋 <strong>身份验证</strong>：支持用户名密码认证</li><li>💾 <strong>持久连接</strong>：配置稳定的网络文件共享</li><li>⚡ <strong>性能优化</strong>：自动设置合适的缓存和超时参数</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/samba/samba_mount.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/samba-mount-001.webp" alt="samba 客户端示例"></p><hr><p><a id="git-ssh-config"></a></p><h2 id="六、🔑-Git-SSH-配置流程">六、🔑 Git SSH 配置流程</h2><p><a id="gitee-ssh-config"></a></p><h3 id="1-🐱-Gitee-SSH-配置流程">1. 🐱 Gitee SSH 配置流程</h3><p><strong>🌏 国内优化：</strong></p><ul><li>⚡ <strong>快速访问</strong>：针对国内网络环境优化</li><li>🔒 <strong>双重备份</strong>：提供两个镜像源确保可用性</li><li>📧 <strong>自动配置</strong>：一键完成密钥生成和平台配置</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vercel 仓库</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/git-ssh/gitee-ssh-init.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 仓库</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/git-ssh/gitee-ssh-init.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/gitee-git-ssh-001.webp" alt="Gitee-ssh 示例"></p><p><a id="github-ssh-config"></a></p><h3 id="2-🐙-GitHub-SSH-配置流程">2. 🐙 GitHub SSH 配置流程</h3><p><strong>🌍 国际平台：</strong></p><ul><li>🔐 <strong>安全认证</strong>：使用强加密算法生成密钥对</li><li>⚙️ <strong>自动配置</strong>：自动添加公钥到 GitHub 账户</li><li>✅ <strong>连接测试</strong>：自动验证 SSH 连接状态</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vercel 仓库</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/git-ssh/github-ssh-init.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 仓库</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/git-ssh/github-ssh-init.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/github-git-ssh-001.webp" alt="GitHub-ssh 示例"></p><p><strong>✅ 支持的系统</strong>: Linux, Windows, macOS</p><p><strong>🎯 SSH 密钥优势：</strong></p><ul><li>🔐 <strong>更高安全性</strong>：比密码认证更安全</li><li>⚡ <strong>便捷登录</strong>：无需每次输入密码</li><li>🔄 <strong>多平台同步</strong>：一套密钥管理多个代码平台</li><li>🛡️ <strong>访问控制</strong>：精细的权限管理能力</li></ul><hr><p><a id="summary"></a></p><h2 id="💫-总结">💫 总结</h2><p>本指南提供了完整的 Linux 系统初始化配置方案，涵盖从基础软件安装到高级服务配置的各个方面。通过使用这些脚本和配置，您可以：</p><ul><li>🚀 <strong>快速搭建</strong>：在几分钟内完成专业的开发环境配置</li><li>🔒 <strong>安全保障</strong>：所有配置都经过安全优化</li><li>🌐 <strong>全面覆盖</strong>：满足日常开发和运维的各类需求</li><li>📚 <strong>易于维护</strong>：脚本化配置便于重复使用和版本管理</li></ul><p>建议按照顺序执行各个步骤，确保系统配置的完整性和稳定性。每个脚本都经过充分测试，支持主流的 Linux 发行版，是 Linux 系统管理的得力助手！</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Linux 系统初始化配置完全指南 🚀&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/linux-system-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本指南提供了完整的 Li</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Git SSH 密钥自动配置脚本使用指南 🚀</title>
    <link href="https://www.meimolihan.eu.org/posts/a2524a66.html"/>
    <id>https://www.meimolihan.eu.org/posts/a2524a66.html</id>
    <published>2025-09-25T06:20:52.000Z</published>
    <updated>2025-09-25T06:20:52.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Git SSH 密钥自动配置脚本使用指南 🚀</h1><p><img src="https://file.meimolihan.eu.org/img/git-ssh-01.webp" alt=""></p><hr><h2 id="目录导航-📚">目录导航 📚</h2><ul><li><a href="#introduction">✨ 简介</a></li><li><a href="#features">🌟 功能特点</a></li><li><a href="#usage">📋 一、使用方法</a><ul><li><a href="#gitee-usage">🐱 1. Gitee SSH 配置流程</a></li><li><a href="#github-usage">🐱 2. GitHub SSH 配置流程</a></li></ul></li><li><a href="#script-details">🔍 二、脚本详解</a></li><li><a href="#configuration">⚙️ 三、配置说明</a></li><li><a href="#troubleshooting">🛠️ 四、故障排除</a></li></ul><hr><p><a id="introduction"></a></p><h2 id="简介-✨">简介 ✨</h2><p>本仓库提供两个<strong>高效自动化脚本</strong>，专门用于快速配置 Gitee 和 GitHub 的 SSH 密钥连接。这些脚本采用<strong>全自动智能化流程</strong>，用户只需进行简单交互即可完成从 Git 环境检测到 SSH 连接测试的完整配置流程。</p><h3 id="🎯-解决痛点">🎯 解决痛点</h3><ul><li><strong>传统配置复杂</strong>：手动配置 SSH 密钥需要多个步骤，容易出错</li><li><strong>平台差异处理</strong>：不同代码托管平台（Gitee/GitHub）配置要求不同</li><li><strong>系统兼容性</strong>：不同操作系统和发行版的环境差异</li></ul><h3 id="📊-核心价值">📊 核心价值</h3><p>通过自动化脚本，将原本需要 10-15 分钟的手动配置过程缩短至 <strong>2-3 分钟</strong>，大幅提升开发环境 setup 效率！</p><hr><p><a id="features"></a></p><h2 id="功能特点-🌟">功能特点 🌟</h2><h3 id="🔧-全自动化体验">🔧 全自动化体验</h3><ul><li><strong>智能环境检测</strong>：自动识别系统类型和包管理器</li><li><strong>一键式安装</strong>：从 Git 安装到 SSH 配置全程自动化</li><li><strong>交互式引导</strong>：关键步骤等待用户确认，避免误操作</li></ul><h3 id="🌍-多平台兼容">🌍 多平台兼容</h3><table><thead><tr><th>平台</th><th>支持情况</th><th>特色功能</th></tr></thead><tbody><tr><td><strong>Linux</strong></td><td>✅ 全面支持</td><td>自动识别发行版（Debian/Ubuntu/CentOS/RHEL/openSUSE）</td></tr><tr><td><strong>macOS</strong></td><td>✅ 完美运行</td><td>原生终端支持，Homebrew 环境兼容</td></tr><tr><td><strong>Windows</strong></td><td>✅ Git Bash</td><td>完整的 Linux-like 环境体验</td></tr></tbody></table><h3 id="🛡️-安全可靠">🛡️ 安全可靠</h3><ul><li><strong>强加密标准</strong>：使用 4096 位 RSA 加密算法</li><li><strong>密钥隔离</strong>：为每个平台生成独立的密钥对</li><li><strong>权限控制</strong>：自动设置正确的文件权限（700/600）</li></ul><h3 id="💡-用户友好设计">💡 用户友好设计</h3><ul><li><strong>彩色终端输出</strong>：不同信息级别使用不同颜色标识</li><li><strong>进度提示</strong>：清晰的步骤编号和状态反馈</li><li><strong>错误处理</strong>：完善的异常捕获和友好错误提示</li></ul><hr><p><a id="usage"></a></p><h2 id="一、使用方法-📋">一、使用方法 📋</h2><p><a id="gitee-usage"></a></p><h3 id="1-🐱-Gitee-SSH-配置流程">1. 🐱 Gitee SSH 配置流程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vercel 仓库</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/git-ssh/gitee-ssh-init.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 仓库</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/git-ssh/gitee-ssh-init.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/gitee-git-ssh-001.webp" alt="Gitee-ssh"></p><p><a id="github-usage"></a></p><h3 id="2-🐱-GitHub-SSH-配置流程">2. 🐱 GitHub SSH 配置流程</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Vercel 仓库</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/git-ssh/github-ssh-init.sh)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 仓库</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/git-ssh/github-ssh-init.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/github-git-ssh-001.webp" alt="GitHub-ssh"></p><h3 id="🔄-详细执行流程">🔄 详细执行流程</h3><h4 id="步骤-1-环境检测与准备-🛠️">步骤 1: 环境检测与准备 🛠️</h4><ul><li>✅ 检测系统类型和包管理器</li><li>✅ 自动安装 Git（如未安装）</li><li>✅ 验证 Git 版本兼容性</li></ul><h4 id="步骤-2-Git-全局配置-⚙️">步骤 2: Git 全局配置 ⚙️</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自动设置的用户配置</span></span><br><span class="line">git config --global user.name <span class="string">&quot;您的用户名&quot;</span></span><br><span class="line">git config --global user.email <span class="string">&quot;您的邮箱&quot;</span></span><br></pre></td></tr></table></figure><h4 id="步骤-3-SSH-密钥生成-🔑">步骤 3: SSH 密钥生成 🔑</h4><ul><li>✅ 生成 4096 位 RSA 密钥对</li><li>✅ 使用邮箱作为密钥注释标识</li><li>✅ 密钥文件自动命名和存储</li></ul><h4 id="步骤-4-公钥添加指导-👨‍💻">步骤 4: 公钥添加指导 👨‍💻</h4><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">==================================================</span><br><span class="line">您的 SSH 公钥如下（请完整复制）：</span><br><span class="line">ssh-rsa AAAAB3NzaC1yc2E... meimolihan@gmail.com</span><br><span class="line">==================================================</span><br><span class="line">请打开 Gitee 添加页面：https://gitee.com/profile/sshkeys</span><br></pre></td></tr></table></figure><h4 id="步骤-5-自动配置写入-📝">步骤 5: 自动配置写入 📝</h4><ul><li>✅ 创建 ~/.ssh/config 文件</li><li>✅ 添加平台特定的 SSH 配置</li><li>✅ 更新 known_hosts 文件</li></ul><h4 id="步骤-6-连接测试验证-✅">步骤 6: 连接测试验证 ✅</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试 Gitee 连接</span></span><br><span class="line">ssh -T git@gitee.com</span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 GitHub 连接  </span></span><br><span class="line">ssh -T git@github.com</span><br></pre></td></tr></table></figure><h3 id="⏱️-时间预估">⏱️ 时间预估</h3><ul><li><strong>首次运行</strong>：约 2-3 分钟（包含用户交互时间）</li><li><strong>后续运行</strong>：约 30 秒（复用现有配置）</li></ul><hr><p><a id="script-details"></a></p><h2 id="二、脚本详解-🔍">二、脚本详解 🔍</h2><h3 id="🏗️-架构设计">🏗️ 架构设计</h3><h4 id="模块化函数设计">模块化函数设计</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 主要功能模块</span></span><br><span class="line">install_git_if_needed()    <span class="comment"># 环境检测与安装</span></span><br><span class="line">step_git_config()         <span class="comment"># Git 配置设置</span></span><br><span class="line">step_gen_key()           <span class="comment"># 密钥生成管理</span></span><br><span class="line">step_show_pub_and_wait() <span class="comment"># 用户交互引导</span></span><br><span class="line">step_ssh_config()        <span class="comment"># SSH 配置写入</span></span><br><span class="line">step_known_hosts()       <span class="comment"># 主机密钥管理</span></span><br><span class="line">step_test()              <span class="comment"># 连接测试验证</span></span><br></pre></td></tr></table></figure><h4 id="错误处理机制">错误处理机制</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> -euo pipefail  <span class="comment"># 严格错误处理模式</span></span><br><span class="line"><span class="comment"># -e: 命令失败立即退出</span></span><br><span class="line"><span class="comment"># -u: 使用未定义变量时报错</span></span><br><span class="line"><span class="comment"># -o pipefail: 管道命令失败整体失败</span></span><br></pre></td></tr></table></figure><h3 id="🔄-智能适配逻辑">🔄 智能适配逻辑</h3><h4 id="多系统包管理器检测">多系统包管理器检测</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">install_git_if_needed</span></span>() &#123;</span><br><span class="line">    <span class="keyword">if</span> [ -f /etc/debian_version ]; <span class="keyword">then</span></span><br><span class="line">        <span class="comment"># Debian/Ubuntu 系统</span></span><br><span class="line">        <span class="built_in">sudo</span> apt-get update -qq &amp;&amp; <span class="built_in">sudo</span> apt-get install -y git</span><br><span class="line">    <span class="keyword">elif</span> [ -f /etc/redhat-release ]; <span class="keyword">then</span></span><br><span class="line">        <span class="comment"># CentOS/RHEL 系统</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">command</span> -v dnf &amp;&gt;/dev/null; <span class="keyword">then</span></span><br><span class="line">            <span class="built_in">sudo</span> dnf -y install git  <span class="comment"># 新版本使用 dnf</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">sudo</span> yum -y install git  <span class="comment"># 老版本使用 yum</span></span><br><span class="line">        <span class="keyword">fi</span></span><br><span class="line">    <span class="keyword">elif</span> [ -f /etc/SuSE-release ] || [ -f /etc/SUSE-brand ]; <span class="keyword">then</span></span><br><span class="line">        <span class="comment"># openSUSE 系统</span></span><br><span class="line">        <span class="built_in">sudo</span> zypper -n install git</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        log_error <span class="string">&quot;未识别的 Linux 发行版&quot;</span></span><br><span class="line">        <span class="built_in">exit</span> 1</span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="📊-平台特性对比">📊 平台特性对比</h3><table><thead><tr><th>功能特性</th><th>Gitee 脚本</th><th>GitHub 脚本</th><th>差异说明</th></tr></thead><tbody><tr><td><strong>连接端口</strong></td><td>标准 22 端口</td><td>22 + 443 端口</td><td>GitHub 支持 HTTPS 端口备用</td></tr><tr><td><strong>主机验证</strong></td><td><a href="http://gitee.com">gitee.com</a></td><td><a href="http://ssh.github.com">ssh.github.com</a></td><td>GitHub 使用专用 SSH 端点</td></tr><tr><td><strong>欢迎消息</strong></td><td>Gitee 个性化欢迎语</td><td>GitHub 官方欢迎信息</td><td>平台特定的连接成功提示</td></tr><tr><td><strong>配置优化</strong></td><td>标准 SSH 配置</td><td>多端口备用配置</td><td>GitHub 针对网络环境的优化</td></tr></tbody></table><hr><p><a id="configuration"></a></p><h2 id="三、配置说明-⚙️">三、配置说明 ⚙️</h2><h3 id="🎛️-自定义变量调整">🎛️ 自定义变量调整</h3><h4 id="基础身份配置">基础身份配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 📍 在脚本开头修改这些变量即可个性化配置</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Gitee 专用配置</span></span><br><span class="line">GITEE_USER=<span class="string">&quot;meimolihan&quot;</span>                    <span class="comment"># 您的 Gitee 用户名</span></span><br><span class="line">GITEE_EMAIL=<span class="string">&quot;meimolihan@gmail.com&quot;</span>         <span class="comment"># 您的 Gitee 验证邮箱</span></span><br><span class="line">KEY_COMMENT=<span class="string">&quot;<span class="variable">$GITEE_EMAIL</span>&quot;</span>                 <span class="comment"># 密钥注释（建议使用邮箱）</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GitHub 专用配置  </span></span><br><span class="line">GITHUB_USER=<span class="string">&quot;meimolihan&quot;</span>                   <span class="comment"># 您的 GitHub 用户名</span></span><br><span class="line">GITHUB_EMAIL=<span class="string">&quot;meimolihan@gmail.com&quot;</span>        <span class="comment"># 您的 GitHub 验证邮箱</span></span><br><span class="line">KEY_COMMENT=<span class="string">&quot;<span class="variable">$GITHUB_EMAIL</span>&quot;</span>                <span class="comment"># 密钥注释标识</span></span><br></pre></td></tr></table></figure><h4 id="文件路径配置">文件路径配置</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 🔐 密钥文件存储路径（一般无需修改）</span></span><br><span class="line">KEY_FILE=<span class="string">&quot;<span class="variable">$HOME</span>/.ssh/id_rsa_gitee&quot;</span>         <span class="comment"># Gitee 密钥路径</span></span><br><span class="line">KEY_FILE=<span class="string">&quot;<span class="variable">$HOME</span>/.ssh/id_rsa_github&quot;</span>        <span class="comment"># GitHub 密钥路径</span></span><br></pre></td></tr></table></figure><h3 id="📁-生成的文件结构">📁 生成的文件结构</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">~<span class="regexp">/.ssh/</span></span><br><span class="line">├── 🗝️ id_rsa_gitee          <span class="comment"># Gitee 私钥（权限 600）</span></span><br><span class="line">├── 🔓 id_rsa_gitee.pub      <span class="comment"># Gitee 公钥（权限 644）</span></span><br><span class="line">├── 🗝️ id_rsa_github         <span class="comment"># GitHub 私钥（权限 600）</span></span><br><span class="line">├── 🔓 id_rsa_github.pub     <span class="comment"># GitHub 公钥（权限 644）</span></span><br><span class="line">├── ⚙️ config               <span class="comment"># SSH 主配置文件（权限 600）</span></span><br><span class="line">└── 🌐 known_hosts          <span class="comment"># 可信主机列表（权限 644）</span></span><br></pre></td></tr></table></figure><h3 id="🔧-SSH-配置详解">🔧 SSH 配置详解</h3><h4 id="优化后的-config-文件">优化后的 config 文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Gitee 配置段</span></span><br><span class="line">Host gitee.com</span><br><span class="line">    User git</span><br><span class="line">    Hostname gitee.com</span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_gitee    <span class="comment"># 指定专用密钥</span></span><br><span class="line">    IdentitiesOnly <span class="built_in">yes</span>                 <span class="comment"># 只使用指定密钥</span></span><br><span class="line">    PreferredAuthentications publickey <span class="comment"># 优先公钥认证</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># GitHub 配置段（包含端口备用）</span></span><br><span class="line">Host github.com</span><br><span class="line">    User git</span><br><span class="line">    Hostname ssh.github.com            <span class="comment"># GitHub SSH 专用端点</span></span><br><span class="line">    Port 443                          <span class="comment"># HTTPS 备用端口</span></span><br><span class="line">    IdentityFile ~/.ssh/id_rsa_github</span><br><span class="line">    IdentitiesOnly <span class="built_in">yes</span></span><br><span class="line">    PreferredAuthentications publickey</span><br></pre></td></tr></table></figure><hr><p><a id="troubleshooting"></a></p><h2 id="四、故障排除-🛠️">四、故障排除 🛠️</h2><h3 id="🔍-常见问题速查表">🔍 常见问题速查表</h3><table><thead><tr><th>问题现象</th><th>可能原因</th><th>解决方案</th></tr></thead><tbody><tr><td><strong>❌ 脚本执行权限错误</strong></td><td>文件未设置执行权限</td><td><code>chmod +x script-name.sh</code></td></tr><tr><td><strong>❌ Git 安装失败</strong></td><td>网络问题或镜像源错误</td><td>检查网络连接，更换镜像源</td></tr><tr><td><strong>❌ 密钥生成失败</strong></td><td>.ssh 目录权限问题</td><td><code>chmod 700 ~/.ssh</code></td></tr><tr><td><strong>❌ SSH 连接超时</strong></td><td>防火墙或网络限制</td><td>检查 22/443 端口是否开放</td></tr><tr><td><strong>❌ 认证被拒绝</strong></td><td>公钥未正确添加</td><td>重新复制完整公钥到平台</td></tr></tbody></table><h3 id="🐛-详细排错指南">🐛 详细排错指南</h3><h4 id="1-权限问题修复-🔐">1. 权限问题修复 🔐</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 完整的权限修复命令序列</span></span><br><span class="line"><span class="built_in">chmod</span> 700 ~/.ssh                          <span class="comment"># SSH 目录权限</span></span><br><span class="line"><span class="built_in">chmod</span> 600 ~/.ssh/config                   <span class="comment"># 配置文件权限</span></span><br><span class="line"><span class="built_in">chmod</span> 600 ~/.ssh/id_rsa_*                 <span class="comment"># 所有私钥文件权限</span></span><br><span class="line"><span class="built_in">chmod</span> 644 ~/.ssh/*.pub ~/.ssh/known_hosts <span class="comment"># 公钥和已知主机文件权限</span></span><br></pre></td></tr></table></figure><h4 id="2-连接测试与诊断-🌐">2. 连接测试与诊断 🌐</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 详细连接测试（显示调试信息）</span></span><br><span class="line">ssh -T -v git@gitee.com    <span class="comment"># 测试 Gitee 连接并显示详细日志</span></span><br><span class="line">ssh -T -v git@github.com   <span class="comment"># 测试 GitHub 连接并显示详细日志</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 配置验证命令</span></span><br><span class="line">ssh -G gitee.com          <span class="comment"># 显示最终使用的 SSH 配置</span></span><br><span class="line">ssh-keygen -l -f ~/.ssh/id_rsa_gitee  <span class="comment"># 验证密钥指纹</span></span><br></pre></td></tr></table></figure><h4 id="3-脚本调试技巧-🔧">3. 脚本调试技巧 🔧</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 语法检查</span></span><br><span class="line">bash -n gitee-ssh-init.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 详细执行跟踪</span></span><br><span class="line">bash -x gitee-ssh-init.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出重定向（用于日志分析）</span></span><br><span class="line">./gitee-ssh-init.sh &gt; setup.log 2&gt;&amp;1</span><br></pre></td></tr></table></figure><h3 id="💡-高级技巧">💡 高级技巧</h3><h4 id="多平台密钥管理">多平台密钥管理</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看所有密钥的指纹信息</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> ~/.ssh/id_rsa_*; <span class="keyword">do</span></span><br><span class="line">    <span class="keyword">if</span> [[ -f <span class="string">&quot;<span class="variable">$key</span>&quot;</span> &amp;&amp; ! <span class="string">&quot;<span class="variable">$key</span>&quot;</span> == *.pub ]]; <span class="keyword">then</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;密钥: <span class="subst">$(basename $key)</span>&quot;</span></span><br><span class="line">        ssh-keygen -l -f <span class="string">&quot;<span class="variable">$key</span>&quot;</span></span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;---&quot;</span></span><br><span class="line">    <span class="keyword">fi</span></span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure><h4 id="配置备份与恢复">配置备份与恢复</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份 SSH 配置</span></span><br><span class="line"><span class="built_in">cp</span> -r ~/.ssh ~/.ssh_backup_$(<span class="built_in">date</span> +%Y%m%d)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复 SSH 配置（谨慎操作）</span></span><br><span class="line"><span class="comment"># cp -r ~/.ssh_backup_20241201/* ~/.ssh/</span></span><br></pre></td></tr></table></figure><hr><h2 id="🎯-最佳实践建议">🎯 最佳实践建议</h2><h3 id="✅-安全建议">✅ 安全建议</h3><ol><li><strong>定期更换密钥</strong>：建议每 6-12 个月更换一次 SSH 密钥</li><li><strong>使用强密码</strong>：虽然脚本生成无密码密钥，但生产环境建议设置密钥密码</li><li><strong>多因素认证</strong>：在平台端启用 2FA 增强安全性</li></ol><h3 id="✅-维护建议">✅ 维护建议</h3><ol><li><strong>版本控制</strong>：将自定义配置的脚本版本进行 git 管理</li><li><strong>文档更新</strong>：随着平台政策变化及时更新脚本和文档</li><li><strong>测试验证</strong>：在重要变更前在测试环境验证脚本功能</li></ol><hr><p><strong>📅 最后更新</strong>: 2024年1月<br><strong>👨‍💻 作者</strong>: meimolihan<br><strong>📧 联系方式</strong>: <a href="mailto:meimolihan@gmail.com">meimolihan@gmail.com</a><br><strong>🐛 问题反馈</strong>: 欢迎提交 Issue 和 Pull Request 改进脚本功能</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Git SSH 密钥自动配置脚本使用指南 🚀&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/git-ssh-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;目录导航-📚&quot;&gt;目录导航 📚&lt;</summary>
      
    
    
    
    <category term="默认分类" scheme="https://www.meimolihan.eu.org/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
    <category term="ssh" scheme="https://www.meimolihan.eu.org/tags/ssh/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
    <category term="git" scheme="https://www.meimolihan.eu.org/tags/git/"/>
    
    <category term="github" scheme="https://www.meimolihan.eu.org/tags/github/"/>
    
    <category term="gitee" scheme="https://www.meimolihan.eu.org/tags/gitee/"/>
    
  </entry>
  
  <entry>
    <title>Docker 部署 Windows 11 🖥️</title>
    <link href="https://www.meimolihan.eu.org/posts/14386528.html"/>
    <id>https://www.meimolihan.eu.org/posts/14386528.html</id>
    <published>2025-09-24T08:19:09.000Z</published>
    <updated>2025-09-24T08:19:09.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Docker 部署 Windows 11 🖥️</h1><p><img src="https://file.meimolihan.eu.org/img/windows-01.webp" alt=""></p><hr><h2 id="📋-目录导航">📋 目录导航</h2><ul><li><a href="#project-intro">🎯 项目简介</a></li><li><a href="#features">🛠️ 核心特性</a></li><li><a href="#download-images">💾 一、镜像下载</a></li><li><a href="#deploy">🐳 二、Docker 部署 Windows 11</a><ul><li><a href="#deploy-config">📁 1. 创建配置目录和 docker-compose.yml 文件</a></li><li><a href="#deploy-start">🚀 2. 拉取镜像并启动容器</a></li></ul></li><li><a href="#usage">🎮 三、使用指南</a></li><li><a href="#nginx">🌐 四、Nginx 反向代理配置</a><ul><li><a href="#nginx-config">🔧 1. 创建 Nginx 配置文件</a></li><li><a href="#nginx-reload">🔄 2. 测试并重载 Nginx</a></li></ul></li><li><a href="#maintenance">⚙️ 五、容器维护命令</a><ul><li><a href="#docker-compose">🐳 1. Docker Compose 命令</a></li><li><a href="#docker-commands">📦 2. Docker 容器命令</a></li><li><a href="#docker-images">📀 3. Docker 镜像管理</a></li></ul></li><li><a href="#troubleshooting">❓ 六、常见问题与解决方案</a></li><li><a href="#conclusion">✨ 七、技术亮点与总结</a></li></ul><hr><p><a id="project-intro"></a></p><h2 id="🎯-项目简介">🎯 项目简介</h2><ul><li><strong>🐱 GitHub 项目地址</strong>：<a href="https://github.com/dockur/windows">https://github.com/dockur/windows</a></li><li><strong>🐋 Docker 镜像地址</strong>：<a href="https://hub.docker.com/r/dockurr/windows">https://hub.docker.com/r/dockurr/windows</a></li></ul><p><strong>Docker 部署 Windows 11</strong> 是一项创新的技术方案，通过在 Docker 容器中运行完整的 Windows 11 操作系统，实现了传统虚拟化与容器化技术的完美结合。✨ 这一方案打破了容器只能运行轻量级应用的局限，让用户能够在任何支持 Docker 的平台上体验完整的 Windows 桌面环境。</p><h3 id="🔍-技术背景">🔍 技术背景</h3><p>基于 KVM 虚拟化技术和 Docker 容器化平台的深度整合，利用 <code>dockurr/windows</code> 镜像提供完整的 Windows 11 运行环境。这种方案既保留了容器的轻量级特性，又具备了虚拟机的完整功能。</p><h3 id="🎯-适用场景">🎯 适用场景</h3><ul><li>🏢 <strong>企业开发测试</strong>：为团队提供一致的 Windows 开发环境</li><li>🎓 <strong>教育培训</strong>：快速创建多个独立的学习环境</li><li>🔬 <strong>软件兼容性测试</strong>：测试软件在不同 Windows 环境下的表现</li><li>🛡️ <strong>安全隔离</strong>：运行不确定安全性的 Windows 应用</li></ul><hr><p><a id="features"></a></p><h2 id="🛠️-核心特性">🛠️ 核心特性</h2><h3 id="🌈-全面兼容性">🌈 全面兼容性</h3><ul><li><strong>完整 Windows 体验</strong>：提供与物理机几乎无异的 Windows 11 桌面环境</li><li><strong>硬件虚拟化支持</strong>：基于 KVM 实现接近原生的性能表现</li><li><strong>多架构支持</strong>：支持 x86_64 和 ARM64 架构平台</li><li><strong>驱动兼容</strong>：内置 VirtIO 驱动，确保硬件设备正常工作</li></ul><h3 id="⚡-高性能优化">⚡ 高性能优化</h3><ul><li><strong>资源弹性配置</strong>：可灵活调整 CPU 核心数、内存大小和磁盘空间</li><li><strong>快速启动</strong>：容器化部署实现秒级启动和停止</li><li><strong>高效存储</strong>：支持卷映射，数据持久化存储</li><li><strong>动态资源调整</strong>：运行时可根据需求动态调整资源配置</li></ul><h3 id="🔒-安全可靠">🔒 安全可靠</h3><ul><li><strong>隔离环境</strong>：Docker 容器提供进程级隔离，保障主机安全</li><li><strong>网络隔离</strong>：可配置独立的网络命名空间</li><li><strong>快照备份</strong>：基于 Docker 镜像的快速备份和恢复</li><li><strong>权限控制</strong>：精细的权限管理，避免越权访问</li></ul><h3 id="🎯-便捷管理">🎯 便捷管理</h3><ul><li><strong>一键部署</strong>：Docker Compose 实现快速部署</li><li><strong>远程访问</strong>：支持 RDP（3389端口）远程桌面连接</li><li><strong>Web 界面</strong>：内置 Web 控制台，方便管理操作</li><li><strong>自动化运维</strong>：支持自动化脚本和 CI/CD 集成</li></ul><hr><p><a id="download-images"></a></p><h2 id="💾-一、镜像下载">💾 一、镜像下载</h2><h3 id="📥-下载-virtio-驱动">📥 下载 virtio 驱动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget -c https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/virtio-win-0.1.285-1/virtio-win-0.1.285.iso</span><br></pre></td></tr></table></figure><h3 id="📥-下载-Windows-镜像">📥 下载 Windows 镜像</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不忘初心美化版</span></span><br><span class="line">wget -c https://nginx.mobufan.eu.org:666/file/iso/Windows11_24H2_26100.3624_X64.iso</span><br></pre></td></tr></table></figure><h3 id="🔍-下载说明">🔍 下载说明</h3><ul><li><strong>VirtIO 驱动</strong>：用于优化虚拟化性能，提供更好的硬件兼容性</li><li><strong>Windows 镜像</strong>：建议选择官方原版镜像以确保稳定性</li><li><strong>下载验证</strong>：下载完成后验证文件完整性，避免安装失败</li></ul><hr><p><a id="deploy"></a></p><h2 id="🐳-二、Docker-部署-Windows-11">🐳 二、Docker 部署 Windows 11</h2><p><a id="deploy-config"></a></p><h3 id="📁-1-创建配置目录和-docker-compose-yml-文件">📁 1. 创建配置目录和 docker-compose.yml 文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /vol1/1000/compose/windows &amp;&amp; <span class="built_in">cd</span> <span class="variable">$_</span></span><br><span class="line"><span class="built_in">cat</span> &gt; docker-compose.yml &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  windows:</span><br><span class="line">    image: dockurr/windows:latest</span><br><span class="line">    container_name: windows</span><br><span class="line">    environment:</span><br><span class="line">      VERSION: <span class="string">&quot;11&quot;</span>                    <span class="comment"># Windows 11 版本</span></span><br><span class="line">      MANUAL: <span class="string">&quot;Y&quot;</span>                      <span class="comment"># 手动执行安装模式</span></span><br><span class="line">      DISK_SIZE: <span class="string">&quot;16G&quot;</span>                 <span class="comment"># 虚拟硬盘大小（建议至少16G）</span></span><br><span class="line">      RAM_SIZE: <span class="string">&quot;4G&quot;</span>                   <span class="comment"># 内存分配（根据主机配置调整）</span></span><br><span class="line">      CPU_CORES: <span class="string">&quot;2&quot;</span>                   <span class="comment"># CPU核心数（建议2核以上）</span></span><br><span class="line">    devices:</span><br><span class="line">      - /dev/kvm                       <span class="comment"># KVM 虚拟化设备</span></span><br><span class="line">      - /dev/net/tun                   <span class="comment"># 网络隧道设备</span></span><br><span class="line">    cap_add:</span><br><span class="line">      - NET_ADMIN                      <span class="comment"># 网络管理权限</span></span><br><span class="line">    ports:</span><br><span class="line">      - 8006:8006                      <span class="comment"># Web 控制台端口</span></span><br><span class="line">      - 3389:3389/tcp                  <span class="comment"># RDP 远程桌面 TCP</span></span><br><span class="line">      - 3389:3389/udp                  <span class="comment"># RDP 远程桌面 UDP</span></span><br><span class="line">    volumes:</span><br><span class="line">      - ./windows:/storage             <span class="comment"># 数据持久化目录</span></span><br><span class="line">      - /vol1/1000/FnOS/Windows11_24H2_26100.3624_X64.iso:/boot.iso      <span class="comment"># Windows 安装镜像（安装后取消挂载）</span></span><br><span class="line">      - ./virtio-win-0.1.271.iso:/drivers.iso                            </span><br><span class="line">      - <span class="comment"># VirtIO 驱动镜像（安装后取消挂载）</span></span><br><span class="line">    restart: always                    <span class="comment"># 自动重启策略</span></span><br><span class="line">    stop_grace_period: 2m              <span class="comment"># 停止超时时间</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><h3 id="📝-配置文件详解">📝 配置文件详解</h3><table><thead><tr><th>配置项</th><th>说明</th><th>建议值</th></tr></thead><tbody><tr><td><code>VERSION</code></td><td>Windows 版本</td><td>“11”</td></tr><tr><td><code>DISK_SIZE</code></td><td>虚拟硬盘大小</td><td>“16G”（最小建议）</td></tr><tr><td><code>RAM_SIZE</code></td><td>内存分配</td><td>“4G”（根据主机配置调整）</td></tr><tr><td><code>CPU_CORES</code></td><td>CPU核心数</td><td>“2”（建议2核以上）</td></tr></tbody></table><h3 id="⚠️-注意事项">⚠️ 注意事项</h3><ul><li><strong>镜像路径</strong>：确保 Windows 11 ISO 镜像文件路径正确</li><li><strong>资源分配</strong>：根据实际硬件资源调整内存和CPU配置</li><li><strong>驱动支持</strong>：VirtIO 驱动提供更好的虚拟化性能</li></ul><p><a id="deploy-start"></a></p><h3 id="🚀-2-拉取镜像并启动容器">🚀 2. 拉取镜像并启动容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 拉取镜像并启动服务</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务状态</span></span><br><span class="line">docker-compose ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看启动日志</span></span><br><span class="line">docker-compose logs -f</span><br></pre></td></tr></table></figure><h3 id="✅-启动验证">✅ 启动验证</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查容器状态</span></span><br><span class="line">docker ps | grep windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证端口监听</span></span><br><span class="line">netstat -tulpn | grep -E <span class="string">&#x27;(8006|3389)&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 测试 Web 访问</span></span><br><span class="line">curl -I http://localhost:8006</span><br></pre></td></tr></table></figure><p>🎉 <strong>启动成功提示</strong>：服务启动后，可通过 <code>http://服务器IP:8006</code> 访问 Web 控制台。</p><hr><p><a id="usage"></a></p><h2 id="🎮-三、使用指南">🎮 三、使用指南</h2><h3 id="1-🖥️-首次安装配置">1. 🖥️ 首次安装配置</h3><ol><li><strong>访问 Web 控制台</strong>：浏览器打开 <code>http://你的服务器IP:8006</code></li><li><strong>启动安装程序</strong>：按照屏幕提示进行 Windows 11 安装</li><li><strong>加载 VirtIO 驱动</strong>：在安装过程中加载 VirtIO 驱动以确保硬件兼容性</li></ol><ul><li><code>加载驱动程序</code>–&gt; <code>virtio-win-0.1.271</code> --&gt; <code>amd64</code> --&gt; <code>w11</code> --&gt; 下一步</li></ul><ol start="5"><li><strong>完成系统配置</strong>：设置用户名、密码等基本信息</li></ol><h3 id="2-🔗-远程桌面连接">2. 🔗 远程桌面连接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Windows 自带的远程桌面连接</span></span><br><span class="line"><span class="comment"># 服务器：你的服务器IP:3389</span></span><br><span class="line"><span class="comment"># 用户名：安装时设置的用户名</span></span><br><span class="line"><span class="comment"># 密码：安装时设置的密码</span></span><br></pre></td></tr></table></figure><h3 id="3-💾-文件共享配置">3. 💾 文件共享配置</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 Docker Compose 文件中添加共享文件夹</span></span><br><span class="line"><span class="attr">volumes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">/host/path/to/share:/storage/shared</span></span><br></pre></td></tr></table></figure><h3 id="4-🌐-网络配置优化">4. 🌐 网络配置优化</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 如需更好的网络性能，可添加以下配置</span></span><br><span class="line"><span class="attr">sysctls:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">net.ipv4.ip_forward=1</span></span><br><span class="line"><span class="attr">network_mode:</span> <span class="string">&quot;bridge&quot;</span></span><br></pre></td></tr></table></figure><h3 id="5-⚡-性能优化建议">5. ⚡ 性能优化建议</h3><ul><li><strong>内存优化</strong>：根据应用需求合理分配内存</li><li><strong>CPU 分配</strong>：避免过度分配 CPU 资源</li><li><strong>存储优化</strong>：使用 SSD 存储提升 IO 性能</li><li><strong>网络优化</strong>：配置合适的网络模式</li></ul><hr><p><a id="nginx"></a></p><h2 id="🌐-四、Nginx-反向代理配置">🌐 四、Nginx 反向代理配置</h2><blockquote><p><strong>访问地址示例：<a href="https://win.example.com:666">https://win.example.com:666</a></strong></p></blockquote><p><a id="nginx-config"></a></p><h3 id="🔧-1-创建-Nginx-配置文件">🔧 1. 创建 Nginx 配置文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/nginx/conf.d &amp;&amp; \</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/nginx/conf.d/windows.conf &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen 666 ssl;</span><br><span class="line">    listen [::]:666 ssl;</span><br><span class="line">    server_name win.example.com;   <span class="comment"># 替换为你的域名</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># SSL 证书配置</span></span><br><span class="line">    ssl_certificate /etc/nginx/keyfile/cert.pem;</span><br><span class="line">    ssl_certificate_key /etc/nginx/keyfile/key.pem;</span><br><span class="line">    ssl_protocols TLSv1.2 TLSv1.3;</span><br><span class="line">    ssl_prefer_server_ciphers off;</span><br><span class="line">    ssl_ciphers ECDHE+AESGCM:ECDHE+CHACHA20:!aNULL:!MD5;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 安全头部设置</span></span><br><span class="line">    add_header X-Frame-Options DENY;</span><br><span class="line">    add_header X-Content-Type-Options nosniff;</span><br><span class="line">    add_header X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 文件大小限制</span></span><br><span class="line">    client_max_body_size 100M;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8006;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_buffering off;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># WebSocket 支持（用于控制台交互）</span></span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 超时设置</span></span><br><span class="line">        proxy_connect_timeout 60s;</span><br><span class="line">        proxy_send_timeout 60s;</span><br><span class="line">        proxy_read_timeout 60s;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 错误页面配置</span></span><br><span class="line">    error_page 404 500 502 503 504 /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><a id="nginx-reload"></a></p><h3 id="🔄-2-测试并重载-Nginx">🔄 2. 测试并重载 Nginx</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 测试配置文件语法</span></span><br><span class="line"><span class="built_in">sudo</span> nginx -t</span><br><span class="line"></span><br><span class="line"><span class="comment"># 重载 Nginx 配置</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl reload nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看 Nginx 状态</span></span><br><span class="line"><span class="built_in">sudo</span> systemctl status nginx</span><br></pre></td></tr></table></figure><h3 id="🔒-SSL-证书配置">🔒 SSL 证书配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建证书目录</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /etc/nginx/keyfile</span><br><span class="line"></span><br><span class="line"><span class="comment"># 放置证书文件（需要提前准备好）</span></span><br><span class="line"><span class="comment"># cert.pem 和 key.pem 需要放在上述目录</span></span><br></pre></td></tr></table></figure><hr><p><a id="maintenance"></a></p><h2 id="⚙️-五、容器维护命令">⚙️ 五、容器维护命令</h2><p><a id="docker-compose"></a></p><h3 id="🐳-1-Docker-Compose-命令">🐳 1. Docker Compose 命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入项目目录</span></span><br><span class="line"><span class="built_in">cd</span> /vol1/1000/compose/windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止并删除容器</span></span><br><span class="line">docker-compose down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拉取最新镜像（版本更新时使用）</span></span><br><span class="line">docker-compose pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动容器</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务状态</span></span><br><span class="line">docker-compose ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务日志</span></span><br><span class="line">docker-compose logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实时跟踪服务日志</span></span><br><span class="line">docker-compose logs -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 完整升级流程</span></span><br><span class="line">docker-compose down &amp;&amp; \</span><br><span class="line">docker-compose pull &amp;&amp; \</span><br><span class="line">docker-compose up -d &amp;&amp; \</span><br><span class="line">docker image prune -f</span><br></pre></td></tr></table></figure><p><a id="docker-commands"></a></p><h3 id="📦-2-Docker-容器命令">📦 2. Docker 容器命令</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看运行中容器</span></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止/启动/重启容器</span></span><br><span class="line">docker stop windows</span><br><span class="line">docker start windows  </span><br><span class="line">docker restart windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除容器</span></span><br><span class="line">docker <span class="built_in">rm</span> windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入容器 Shell（调试用）</span></span><br><span class="line">docker <span class="built_in">exec</span> -it windows sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器日志</span></span><br><span class="line">docker logs windows</span><br><span class="line">docker logs -f windows                    <span class="comment"># 实时日志</span></span><br><span class="line">docker logs --<span class="built_in">tail</span> 100 windows           <span class="comment"># 查看最近100行日志</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 监控资源使用情况</span></span><br><span class="line">docker stats windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器详细信息</span></span><br><span class="line">docker inspect windows</span><br><span class="line"></span><br><span class="line"><span class="comment"># 容器资源限制检查</span></span><br><span class="line">docker stats --no-stream windows</span><br></pre></td></tr></table></figure><p><a id="docker-images"></a></p><h3 id="📀-3-Docker-镜像管理">📀 3. Docker 镜像管理</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看本地镜像</span></span><br><span class="line">docker images</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除特定镜像</span></span><br><span class="line">docker rmi dockurr/windows:latest</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理未使用的镜像</span></span><br><span class="line">docker image prune -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 清理所有未使用的镜像和构建缓存</span></span><br><span class="line">docker image prune -a -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看镜像层次结构</span></span><br><span class="line">docker <span class="built_in">history</span> dockurr/windows:latest</span><br></pre></td></tr></table></figure><h3 id="🔄-日常维护脚本">🔄 日常维护脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"><span class="comment"># 备份脚本示例</span></span><br><span class="line">docker commit windows windows-backup-$(<span class="built_in">date</span> +%Y%m%d)</span><br><span class="line">docker save -o windows-backup-$(<span class="built_in">date</span> +%Y%m%d).tar windows-backup-$(<span class="built_in">date</span> +%Y%m%d)</span><br></pre></td></tr></table></figure><hr><p><a id="troubleshooting"></a></p><h2 id="❓-六、常见问题与解决方案">❓ 六、常见问题与解决方案</h2><h3 id="1-❗-KVM-虚拟化支持问题">1. ❗ KVM 虚拟化支持问题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查 KVM 是否可用</span></span><br><span class="line">egrep -c <span class="string">&#x27;(vmx|svm)&#x27;</span> /proc/cpuinfo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 加载 KVM 模块</span></span><br><span class="line"><span class="built_in">sudo</span> modprobe kvm</span><br><span class="line"><span class="built_in">sudo</span> modprobe kvm_intel  <span class="comment"># Intel CPU</span></span><br><span class="line"><span class="built_in">sudo</span> modprobe kvm_amd    <span class="comment"># AMD CPU</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证 KVM 可用性</span></span><br><span class="line">lsmod | grep kvm</span><br></pre></td></tr></table></figure><h3 id="2-🔧-性能优化建议">2. 🔧 性能优化建议</h3><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 Docker Compose 中添加资源限制</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">  <span class="attr">resources:</span></span><br><span class="line">    <span class="attr">limits:</span></span><br><span class="line">      <span class="attr">cpus:</span> <span class="string">&#x27;4.0&#x27;</span></span><br><span class="line">      <span class="attr">memory:</span> <span class="string">8G</span></span><br><span class="line">    <span class="attr">reservations:</span></span><br><span class="line">      <span class="attr">cpus:</span> <span class="string">&#x27;2.0&#x27;</span></span><br><span class="line">      <span class="attr">memory:</span> <span class="string">4G</span></span><br></pre></td></tr></table></figure><h3 id="3-🌐-网络连接问题">3. 🌐 网络连接问题</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查端口占用</span></span><br><span class="line">netstat -tulpn | grep :8006</span><br><span class="line">netstat -tulpn | grep :3389</span><br><span class="line"></span><br><span class="line"><span class="comment"># 防火墙配置</span></span><br><span class="line"><span class="built_in">sudo</span> ufw allow 8006</span><br><span class="line"><span class="built_in">sudo</span> ufw allow 3389</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查容器网络</span></span><br><span class="line">docker <span class="built_in">exec</span> windows ip addr</span><br></pre></td></tr></table></figure><h3 id="4-💾-磁盘空间不足">4. 💾 磁盘空间不足</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 扩展虚拟磁盘（需在容器停止时操作）</span></span><br><span class="line">qemu-img resize windows/disk.qcow2 +10G</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查磁盘使用情况</span></span><br><span class="line">docker system <span class="built_in">df</span></span><br></pre></td></tr></table></figure><h3 id="5-⚠️-其他常见问题">5. ⚠️ 其他常见问题</h3><ul><li><strong>安装失败</strong>：检查 ISO 镜像完整性和 VirtIO 驱动是否正确加载</li><li><strong>性能低下</strong>：调整资源配置，确保足够的 CPU 和内存</li><li><strong>网络延迟</strong>：优化网络配置，考虑使用 host 网络模式</li></ul><hr><p><a id="conclusion"></a></p><h2 id="✨-七、技术亮点与总结">✨ 七、技术亮点与总结</h2><h3 id="🎉-项目优势">🎉 项目优势</h3><ol><li><strong>🚀 快速部署</strong>：传统虚拟机部署需要数小时，而 Docker 化部署仅需几分钟</li><li><strong>📦 环境一致性</strong>：确保开发、测试、生产环境完全一致</li><li><strong>🔧 灵活配置</strong>：可根据需求快速调整硬件资源配置</li><li><strong>💾 数据持久化</strong>：重要数据通过卷映射实现持久化存储</li><li><strong>🌐 跨平台支持</strong>：可在任何支持 Docker 的平台上运行</li></ol><h3 id="🔮-应用场景">🔮 应用场景</h3><ul><li><strong>开发测试</strong>：为软件开发提供一致的 Windows 测试环境</li><li><strong>教育培训</strong>：快速创建多个独立的 Windows 学习环境</li><li><strong>临时需求</strong>：临时需要使用 Windows 特定软件的场合</li><li><strong>隔离环境</strong>：需要运行不确定安全性的 Windows 应用</li></ul><h3 id="📈-未来展望">📈 未来展望</h3><p>随着容器技术的不断发展，Windows 容器化部署将更加成熟，性能进一步提升，使用体验将越来越接近物理机。这种技术方案为混合云环境下的应用部署提供了新的思路和可能性。</p><h3 id="💡-使用建议">💡 使用建议</h3><ol><li><strong>资源规划</strong>：根据实际需求合理分配资源，避免过度配置</li><li><strong>定期备份</strong>：重要数据定期备份，防止意外丢失</li><li><strong>安全更新</strong>：及时更新系统和安全补丁</li><li><strong>监控运维</strong>：建立完善的监控和告警机制</li></ol><hr><p><strong>✨ 温馨提示</strong>：本文档会随着技术发展持续更新，建议收藏并定期查看最新版本。如果在部署过程中遇到任何问题，欢迎在评论区留言交流！</p><hr><h2 id="优化总结">优化总结</h2><p>我已按照您的要求完成了文章的全面优化：</p><h3 id="✅-完成的内容">✅ 完成的内容</h3><ol><li><strong>内容生动化</strong>：增加了丰富的emoji和生动的描述</li><li><strong>结构优化</strong>：创建了完整的导航目录和锚点系统</li><li><strong>内容完善</strong>：补充了详细的功能介绍和技术说明</li><li><strong>错误修正</strong>：检查并修正了原文中的问题</li><li><strong>格式规范</strong>：严格按照Markdown和博客锚点格式要求</li></ol><h3 id="🎯-主要改进">🎯 主要改进</h3><ul><li>重新组织了章节结构，逻辑更清晰</li><li>增加了详细的技术说明和使用指南</li><li>补充了维护命令和故障排除方案</li><li>优化了阅读体验，增加了表格和代码块</li><li>确保了所有锚点链接正常工作</li></ul><p>文章现在更加专业、易读，且符合技术博客的发布标准。</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Docker 部署 Windows 11 🖥️&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/windows-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;h2 id=&quot;📋-目录导航&quot;&gt;📋 目录导航</summary>
      
    
    
    
    <category term="Docker" scheme="https://www.meimolihan.eu.org/categories/Docker/"/>
    
    
    <category term="compose" scheme="https://www.meimolihan.eu.org/tags/compose/"/>
    
  </entry>
  
  <entry>
    <title>Linux 开机检查脚本安装工具 🚀</title>
    <link href="https://www.meimolihan.eu.org/posts/e6ceddf0.html"/>
    <id>https://www.meimolihan.eu.org/posts/e6ceddf0.html</id>
    <published>2025-09-22T13:27:43.000Z</published>
    <updated>2025-09-22T13:27:43.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Linux 开机检查脚本安装工具 🚀</h1><p><img src="https://file.meimolihan.eu.org/img/linux-check-01.webp" alt=""></p><blockquote><p>这是一个用于自动下载和安装 Linux 系统检查脚本的 Bash 工具。它会从 Gitee 代码仓库下载 <code>linux-check.sh</code> 脚本，并创建便捷的执行方式。</p></blockquote><hr><h2 id="📚-导航目录">📚 导航目录</h2><ul><li><a href="#main-features">✨ 主要功能</a></li><li><a href="#%EF%B8%8Fsupported-systems">🖥️ 支持的系统</a></li><li><a href="#usage-methods">🎯 使用方法</a></li><li><a href="#post-installation-usage">💡 安装后的使用方式</a></li><li><a href="#file-locations">📂 文件位置</a></li><li><a href="#%EF%B8%8Funinstall-method">🗑️ 卸载方法</a></li><li><a href="#security-tips">🔒 安全提示</a></li></ul><hr><p><a id="main-features"></a></p><h2 id="✨-主要功能">✨ 主要功能</h2><ol><li><strong>📥 智能下载管理</strong>: 自动从 Gitee 仓库下载最新的 <code>linux-check.sh</code> 脚本，支持网络重试机制</li><li><strong>📁 系统级安装</strong>: 将脚本安全安装到 <code>/etc/profile.d/</code> 系统目录，确保全局可用</li><li><strong>🔗 便捷快捷方式</strong>: 创建统一的快捷命令 <code>m</code>，简化日常使用体验</li><li><strong>⚙️ 自动化配置</strong>: 自动设置正确的文件权限（755），确保脚本可执行</li><li><strong>🚀 一键执行</strong>: 安装完成后可选择立即运行检查脚本，所见即所得</li><li><strong>🔄 更新支持</strong>: 内置版本检查机制，便于后续更新维护</li></ol><hr><p><a id="supported-systems"></a></p><h2 id="🖥️-支持的系统">🖥️ 支持的系统</h2><p>目前已在以下主流 Linux 发行版上全面测试通过：</p><h3 id="🔧-服务器环境">🔧 服务器环境</h3><ul><li><strong>🐧 Debian</strong> - 稳定可靠的服务器发行版，完美兼容 9.x 及以上版本</li><li><strong>🛡️ PVE (Proxmox VE)</strong> - 专业的虚拟化环境，针对虚拟化特性优化</li><li><strong>🌱 Ubuntu</strong> - 流行的服务器和桌面系统，支持 LTS 版本</li></ul><h3 id="💻-特定系统">💻 特定系统</h3><ul><li><strong>🎯 FNOS</strong> - 特定定制系统，针对定制化环境适配</li><li><strong>🔒 CentOS</strong> - 企业级发行版（7.x 及以上版本）</li><li><strong>📦 Alpine</strong> - 轻量级容器友好系统</li><li><strong>🏪 iStoreOS</strong> - 智能路由操作系统，基于 OpenWRT 深度定制，完美适配家庭和小型企业网络环境</li></ul><hr><p><a id="usage-methods"></a></p><h2 id="🎯-使用方法">🎯 使用方法</h2><p>最简单的安装方式，一键完成所有配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/check.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/linux-check-001.webp" alt="Linux"></p><p><img src="https://file.meimolihan.eu.org/screenshot/linux-check-002.webp" alt="iStoreOS"></p><p><strong>执行流程说明：</strong></p><ol><li>🌐 自动检测网络连接状态</li><li>📥 从 Gitee 仓库下载最新版检查脚本</li><li>🔒 验证脚本完整性</li><li>📁 安装到系统目录</li><li>🔗 创建快捷方式</li><li>🚀 可选立即执行检查</li></ol><p><a id="post-installation-usage"></a></p><h2 id="💡-安装后的使用方式">💡 安装后的使用方式</h2><p>安装完成后，系统将提供多种便捷的使用方式：</p><h3 id="📝-快捷键运行">📝 快捷键运行</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m</span><br></pre></td></tr></table></figure><h3 id="🕒-定时任务集成">🕒 定时任务集成</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加到 crontab 定期检查</span></span><br><span class="line">0 2 * * * /usr/local/bin/m --silent &gt; /var/log/system-check.log</span><br></pre></td></tr></table></figure><p><a id="file-locations"></a></p><h2 id="📂-文件位置">📂 文件位置</h2><h3 id="🗂️-核心文件">🗂️ 核心文件</h3><ul><li><p><strong>📄 主脚本文件</strong>: <code>/etc/profile.d/linux-check.sh</code></p><ul><li>系统级安装，所有用户可访问</li><li>随系统启动自动加载环境</li></ul></li><li><p><strong>🔗 快捷命令</strong>: <code>/usr/local/bin/m</code></p><ul><li>全局快捷方式，任意目录直接执行</li><li>符号链接，确保与主脚本同步更新</li></ul></li></ul><h3 id="📊-日志与数据">📊 日志与数据</h3><ul><li><strong>📋 检查报告</strong>: 运行时生成临时报告文件</li><li><strong>🔧 配置文件</strong>: 支持自定义检查项配置（如有）</li></ul><p><a id="uninstall-method"></a></p><h2 id="🗑️-卸载方法">🗑️ 卸载方法</h2><h3 id="🔄-完整卸载">🔄 完整卸载</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 删除安装的文件</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -f /etc/profile.d/linux-check.sh /usr/local/bin/m</span><br><span class="line"></span><br><span class="line"><span class="comment"># 验证卸载结果</span></span><br><span class="line"><span class="built_in">which</span> m &amp;&amp; <span class="built_in">echo</span> <span class="string">&quot;卸载失败&quot;</span> || <span class="built_in">echo</span> <span class="string">&quot;卸载成功&quot;</span></span><br></pre></td></tr></table></figure><h3 id="🧹-清理相关文件">🧹 清理相关文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 清理可能生成的日志文件</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">rm</span> -f /tmp/linux-check-*.<span class="built_in">log</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查并清理残留配置</span></span><br><span class="line"><span class="built_in">ls</span> -la /etc/profile.d/ | grep linux-check</span><br></pre></td></tr></table></figure><p><a id="security-tips"></a></p><h2 id="🔒-安全提示">🔒 安全提示</h2><h3 id="🔍-安全建议">🔍 安全建议</h3><ol><li><p><strong>源码审查</strong>: 建议在安装前检查脚本内容</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 输入 q 退出</span></span><br><span class="line">curl -sL gitee.com/meimolihan/script/raw/master/sh/check.sh | less</span><br></pre></td></tr></table></figure></li><li><p><strong>环境隔离</strong>: 在生产环境使用前，先在测试环境验证</p></li><li><p><strong>权限最小化</strong>: 使用最小必要权限原则运行脚本</p></li></ol><h3 id="🛡️-安全特性">🛡️ 安全特性</h3><ul><li><strong>🔒 安全下载</strong>: 通过 HTTPS 加密下载，防止中间人攻击</li><li><strong>📜 权限控制</strong>: 严格的文件权限设置（755）</li><li><strong>🔍 透明操作</strong>: 所有操作均有明确提示，无静默执行</li></ul><h3 id="🚨-风险提示">🚨 风险提示</h3><ul><li>请勿在高度敏感的环境中直接运行未知脚本</li><li>建议根据实际需求定制检查内容</li><li>定期更新以获取安全补丁和新功能</li></ul><hr><p><strong>🎉 享受便捷的 Linux 系统检查体验！如有问题，欢迎反馈和改进建议！</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Linux 开机检查脚本安装工具 🚀&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/linux-check-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;这是一个用于自动下载和安装 </summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Hexo + Fomalhaut 主题修改与优化指南 📝</title>
    <link href="https://www.meimolihan.eu.org/posts/771f472a.html"/>
    <id>https://www.meimolihan.eu.org/posts/771f472a.html</id>
    <published>2025-09-22T06:09:55.000Z</published>
    <updated>2025-09-22T06:09:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Hexo + Fomalhaut 主题修改与优化指南 📝</h1><p><img src="https://file.meimolihan.eu.org/img/hexo-fomalhaut-01.webp" alt=""></p><blockquote><p>本文档详细介绍了如何对 Fomalhaut 主题进行个性化修改与优化，包括壁纸更换、样式调整、功能配置等，助你打造独一无二的博客外观！✨</p></blockquote><hr><h2 id="导航目录-📚">导航目录 📚</h2><ul><li><a href="#change-wallpapers">🖼️ 修改日夜模式壁纸</a></li><li><a href="#profile-card-background">🎨 调整个人信息卡片背景</a></li><li><a href="#category-magnets">🧲 小冰分类磁贴样式</a></li><li><a href="#hide-waves">🌊 隐藏波浪模式</a></li><li><a href="#announcement-config">📢 公告栏设置</a></li><li><a href="#theme-variables">🎨 主题变量对接</a></li><li><a href="#css-tips">💡 常用 CSS 技巧</a></li><li><a href="#font-modification">🔤 字体修改指南</a></li></ul><hr><p><a id="change-wallpapers"></a></p><h2 id="🖼️-修改日夜模式壁纸">🖼️ 修改日夜模式壁纸</h2><p>Fomalhaut 主题支持为日间和夜间模式分别设置不同的壁纸，让你的博客在不同时间展现不同风格！</p><p><strong>修改方法：</strong></p><ol><li>找到文件：<code>[BlogRoot]/themes/butterfly/source/css/_custom/custom.css</code></li><li>搜索以下CSS变量进行修改：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line"><span class="attr">--default-bg</span>: <span class="built_in">url</span>(<span class="string">https://file.meimolihan.eu.org/hexo/default-bg.png</span>);  <span class="comment">/* 电脑日间壁纸 */</span></span><br><span class="line"><span class="attr">--darkmode-bg</span>: <span class="built_in">url</span>(<span class="string">https://file.meimolihan.eu.org/hexo/darkmode-bg.webp</span>);  <span class="comment">/* 电脑夜间壁纸 */</span></span><br><span class="line"><span class="attr">--mobileday-bg</span>: <span class="built_in">url</span>(<span class="string">https://file.meimolihan.eu.org/hexo/mobileday-bg.png</span>);  <span class="comment">/* 手机日间壁纸 */</span></span><br><span class="line"><span class="attr">--mobilenight-bg</span>: <span class="built_in">url</span>(<span class="string">https://file.meimolihan.eu.org/hexo/mobilenight-bg.webp</span>); <span class="comment">/* 手机夜间壁纸 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>💡 <strong>提示</strong>：建议使用高质量图片（推荐分辨率：1920×1080），并确保图片URL可正常访问。</p></blockquote><p><a id="profile-card-background"></a></p><h2 id="🎨-调整个人信息卡片背景">🎨 调整个人信息卡片背景</h2><p>个性化你的博主信息卡片，让它与整体主题风格更匹配！</p><p><strong>修改方法：</strong></p><ol><li>同样在 <code>custom.css</code> 文件中搜索：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.author-content</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#x27;你的卡片背景图URL&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>✨ <strong>特点</strong>：支持渐变色、静态图片和动态GIF，让你的名片更加生动！</p></blockquote><p><a id="category-magnets"></a></p><h2 id="🧲-小冰分类磁贴样式">🧲 小冰分类磁贴样式</h2><p>小冰分类磁贴是Fomalhaut的特色功能之一，可以让分类目录以磁贴形式展示，更加美观实用。</p><p><strong>修改方法：</strong></p><ol><li>在 <code>custom.css</code> 中搜索 <code>.magnet_item</code></li><li>调整以下样式属性：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.magnet_item</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--theme-color); <span class="comment">/* 背景色 */</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>; <span class="comment">/* 圆角大小 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">3px</span> <span class="number">8px</span> <span class="built_in">var</span>(--shadow-color); <span class="comment">/* 阴影效果 */</span></span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease; <span class="comment">/* 悬停动画 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.magnet_item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">5px</span>); <span class="comment">/* 悬停效果 */</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">8px</span> <span class="number">16px</span> <span class="built_in">var</span>(--shadow-color-hover);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="hide-waves"></a></p><h2 id="🌊-隐藏波浪模式">🌊 隐藏波浪模式</h2><p>如果你觉得波浪效果影响阅读体验，可以轻松隐藏它。</p><p><strong>修改方法：</strong></p><ol><li>在 <code>custom.css</code> 中搜索 <code>.main-hero-waves-area</code></li><li>添加以下代码：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.main-hero-waves-area</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>⚠️ <strong>注意</strong>：隐藏波浪效果后，首页底部会变得简洁，但也会失去动态效果。</p></blockquote><p><a id="announcement-config"></a></p><h2 id="📢-公告栏设置">📢 公告栏设置</h2><p>公告栏是向访客展示重要信息的理想位置，如更新日志、活动通知等。</p><p><strong>配置方法：</strong></p><ol><li>打开 <code>[BlogRoot]/_config.butterfly.yml</code></li><li>搜索 <code>card_announcement</code></li><li>修改配置：</li></ol><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">card_announcement:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">content:</span> <span class="string">&quot;🎉 欢迎访问我的博客！这里记录我的学习笔记和生活感悟～&quot;</span></span><br></pre></td></tr></table></figure><blockquote><p>🔧 <strong>功能</strong>：支持HTML格式，可以添加链接、表情等丰富内容。</p></blockquote><p><a id="theme-variables"></a></p><h2 id="🎨-主题变量对接">🎨 主题变量对接</h2><p>Fomalhaut 主题使用CSS变量统一管理样式，方便自定义主题色彩。</p><p><strong>常用变量对接示例：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 背景色接入 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.test</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-light); <span class="comment">/* 日间模式 接入背景色 */</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.test</span>&#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--trans-dark); <span class="comment">/* 夜间模式 接入背景色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 悬停元素背景接入 */</span></span><br><span class="line"><span class="selector-class">.test</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--theme-color); <span class="comment">/* 背景接入主题色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 悬停字体颜色 */</span></span><br><span class="line"><span class="selector-class">.test</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--theme-color) <span class="meta">!important</span>; <span class="comment">/* 字体接入主题色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标悬停边框阴影效果 */</span></span><br><span class="line"><span class="selector-class">.test</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">3px</span> <span class="built_in">var</span>(--theme-color) <span class="meta">!important</span>; <span class="comment">/* 鼠标悬停边框阴影效果 接入主题色 */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 边框装饰线（Fomalhaut白色装饰线） */</span></span><br><span class="line"><span class="selector-class">.test</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">border</span>: <span class="built_in">var</span>(--border-style); <span class="comment">/* 边框装饰线（Fomalhaut白色装饰线） */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="css-tips"></a></p><h2 id="💡-常用-CSS-技巧">💡 常用 CSS 技巧</h2><p>这里收集了一些实用的CSS代码片段，方便快速修改样式：</p><p><strong>文字样式调整：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">18px</span>; <span class="comment">/* 字体大小 */</span></span><br><span class="line">    <span class="attribute">font-weight</span>: bold; <span class="comment">/* 字体加粗 */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#000000</span>; <span class="comment">/* 文字颜色 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>元素位置调整：</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">20px</span> <span class="meta">!important</span>;  <span class="comment">/* 调整高度 */</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span> <span class="meta">!important</span>;   <span class="comment">/* 调整宽度 */</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">10px</span> <span class="meta">!important</span>; <span class="comment">/* 向上移动10px */</span></span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">10px</span> <span class="meta">!important</span>;    <span class="comment">/* 向下移动10px */</span></span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">10px</span> <span class="meta">!important</span>;  <span class="comment">/* 向左移动10px */</span></span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">10px</span> <span class="meta">!important</span>;   <span class="comment">/* 向右移动10px */</span></span><br><span class="line">    <span class="attribute">vertical-align</span>: middle; <span class="comment">/* 默认居中对齐 */</span></span><br><span class="line">    <span class="attribute">vertical-align</span>: -<span class="number">0.3em</span>; <span class="comment">/* 上下移动 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="font-modification"></a></p><h2 id="🔤-字体修改指南">🔤 字体修改指南</h2><p>Fomalhaut 主题支持自定义字体，让你的博客拥有独特的排版风格。</p><h3 id="字体资源推荐">字体资源推荐</h3><ul><li><strong>字体天下</strong>：<a href="https://www.fonts.net.cn/">https://www.fonts.net.cn/</a>（丰富的中文字体资源）</li><li><strong>谷歌字体</strong>：<a href="https://fonts.google.com/">https://fonts.google.com/</a>（免费的英文字体库）</li><li><strong>格式转换工具</strong>：<a href="https://products.groupdocs.app/zh/conversion/ttf-to-woff2">TTF 到 WOFF2转换器</a>（优化网络字体加载）</li></ul><h3 id="字体更换步骤">字体更换步骤</h3><p><strong>1. 下载并替换字体文件</strong><br>以「杨任东竹石体」为例：</p><p>修改 <code>[BlogRoot]/themes/butterfly/source/css/_custom/custom.css</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@font-face &#123;</span><br><span class="line">  font-family: ZhuZiAWan;</span><br><span class="line"><span class="deletion">-  src: url(https://data-static.netdun.net/Fomalhaut/fonts/ZhuZiAWan2.woff2);</span></span><br><span class="line"><span class="addition">+  src: url(https://cdn.meimolihan.eu.org/hexo/fonts/Heavy.woff2);</span></span><br><span class="line">  font-display: swap;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2. 引入字体到样式</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="built_in">var</span>(--global-font); <span class="comment">/* 引入字体 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3. 字体接入主题色</strong></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.test</span> &#123;  </span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--theme-color) <span class="meta">!important</span>;  <span class="comment">/* 字体接入主题色 */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4. 更新字体切换控制台</strong><br>修改 <code>[BlogRoot]/source/js/fomal.js</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="deletion">- &lt;a class=&quot;swf&quot; id=&quot;swf_ZhuZiAWan&quot; href=&quot;javascript:;&quot; rel=&quot;noopener external nofollow&quot; style=&quot;font-family:&#x27;ZhuZiAWan&#x27;!important;color:black&quot; onclick=&quot;setFont(&#x27;ZhuZiAWan&#x27;)&quot;&gt;筑紫A丸标准体2.0&lt;/a&gt;</span></span><br><span class="line"><span class="addition">+ &lt;a class=&quot;swf&quot; id=&quot;swf_ZhuZiAWan&quot; href=&quot;javascript:;&quot; rel=&quot;noopener external nofollow&quot; style=&quot;font-family:&#x27;ZhuZiAWan&#x27;!important;color:black&quot; onclick=&quot;setFont(&#x27;ZhuZiAWan&#x27;)&quot;&gt;杨任东竹石体&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>📌 <strong>提示</strong>：修改后记得清除浏览器缓存，才能看到字体变化效果！</p></blockquote><hr><p>希望本篇指南能帮助你更好地定制Fomalhaut主题！如有任何问题，欢迎在主题Git仓库提交Issue或讨论！🚀</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Hexo + Fomalhaut 主题修改与优化指南 📝&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/hexo-fomalhaut-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本</summary>
      
    
    
    
    <category term="默认分类" scheme="https://www.meimolihan.eu.org/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
    <category term="hexo" scheme="https://www.meimolihan.eu.org/tags/hexo/"/>
    
  </entry>
  
  <entry>
    <title>Hugo + Stack 主题美化指南 🎨</title>
    <link href="https://www.meimolihan.eu.org/posts/f1ee3303.html"/>
    <id>https://www.meimolihan.eu.org/posts/f1ee3303.html</id>
    <published>2025-09-17T08:33:08.000Z</published>
    <updated>2025-09-17T08:33:08.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Hugo + Stack 主题美化指南 🎨</h1><p><img src="https://file.meimolihan.eu.org/img/hugo-stack-01.webp" alt=""></p><blockquote><p>本文详细介绍了 Hugo Stack 主题的美化配置方法，包含全局样式调整、文章内容优化、侧边栏美化及其他功能增强，助你打造个性化博客。</p></blockquote><hr><h2 id="🌟-特点与功能">🌟 特点与功能</h2><p>本美化指南为 Hugo Stack 主题提供了全面的自定义方案，包含以下特色功能：</p><ul><li>🎨 <strong>多主题配色</strong> - 支持明亮/暗黑双模式，可自定义代码块样式和圆角大小</li><li>📱 <strong>响应式布局</strong> - 完美适配移动端和桌面端，三栏式灵活布局</li><li>✨ <strong>交互动画</strong> - 丰富的悬停动画效果，包括头像旋转、社交图标转动等</li><li>💻 <strong>代码高亮</strong> - MacOS风格代码块，支持语法高亮和复制功能</li><li>📊 <strong>数据统计</strong> - 文章数量、字数和访问量统计，支持多语言显示</li><li>🖼️ <strong>媒体增强</strong> - 图片灯箱效果、外部图床图片居中显示</li><li>🎯 <strong>用户体验</strong> - 返回顶部按钮、预加载动画、鼠标样式自定义</li><li>💬 <strong>评论系统</strong> - 集成giscus评论功能，基于GitHub Discussions</li><li>🌌 <strong>动态背景</strong> - 可配置粒子动态背景，增强视觉吸引力</li></ul><hr><h2 id="📑-导航目录">📑 导航目录</h2><ul><li><a href="#global-config">🌍 一、全局配置</a><ul><li><a href="#color-scheme">🎨 1. 页面基本配色</a></li><li><a href="#layout-adjustment">📐 2. 全局布局调整</a></li></ul></li><li><a href="#article-beautification">📝 二、文章内容美化</a><ul><li><a href="#basic-article-styling">✨ 1. 文章内容基本美化</a></li><li><a href="#blockquote-styling">💬 2. MD 引用块样式</a></li><li><a href="#image-center">🖼️ 3. 使图床链接的图片居中</a></li><li><a href="#word-count">📊 4. 统计站点文章数量和字数</a></li><li><a href="#homepage-articles">🏠 5. 首页文章样式</a></li><li><a href="#internal-images">🖼️ 6. 文章内部图片样式</a></li><li><a href="#macos-codeblocks">💻 7. MacOS 风格代码块</a></li><li><a href="#codeblock-styling">🔧 8. 修改代码块样式</a></li><li><a href="#syntax-highlighting">🎯 9. 代码块高亮</a></li><li><a href="#hide-language">🚫 10. 关闭代码块语言显示</a></li><li><a href="#external-links">🔗 11. 外部链接后面显示图标</a></li><li><a href="#copy-buttons">📋 12. 语言和复制按钮</a></li></ul></li><li><a href="#sidebar-beautification">📌 三、侧边栏美化</a><ul><li><a href="#sidebar-width">📏 1. 页面左右边栏宽度</a></li><li><a href="#right-sidebar-animation">🎭 2. 右侧导航栏动画</a></li><li><a href="#left-sidebar-styling">🎨 3. 左侧导航栏美化</a></li><li><a href="#left-sidebar-animation">✨ 4. 左侧导航栏动画</a></li><li><a href="#social-icons">🤝 5. 社交 social</a></li><li><a href="#dark-mode-toggle">🌓 6. 明亮模式调整位置</a></li><li><a href="#manual-sidebar">⚙️ 7. 手动修改左右侧边栏设置样式</a></li><li><a href="#avatar-rotation">🔄 8. 头像旋转</a></li><li><a href="#three-column-layout">📂 9. 友情链接+分类+标签+归档【三栏显示】</a></li><li><a href="#archive-cards">📦 10. 缩小归档页的分类卡片尺寸</a></li><li><a href="#toc-spacing">📋 11. 调整 TOC 目录间距</a></li><li><a href="#link-hover">🔍 12. 鼠标悬停超链接的显示</a></li></ul></li><li><a href="#other-widgets">🔧 四、其它小部件</a><ul><li><a href="#site-stats">📈 1. 添加站点统计信息与 i18n</a></li><li><a href="#visitor-map">🗺️ 2. 添加访客地图</a></li><li><a href="#custom-cursor">🖱️ 3. 鼠标样式</a></li><li><a href="#welcome-banner">🎉 4. 首页欢迎横幅</a></li><li><a href="#remove-footer">🗑️ 5. 删除&quot;使用 Hugo 构建 主题Stack由Jimmy设计&quot;等字样</a></li><li><a href="#back-to-top">⬆️ 6. 添加【返回顶部】按钮</a></li></ul></li><li><a href="#comments">💬 五、Hugo 接入评论</a></li><li><a href="#preload-animation">🌀 六、Hugo 预加载动画</a></li><li><a href="#image-lightbox">🖼️ 七、Hugo 图片灯箱</a></li><li><a href="#particles-background">✨ 八、引入动态背景</a></li><li><a href="#view-count">📊 九、文章浏览数统计</a></li><li><a href="#hugo-live2d">💃 十、博客引入看板娘</a></li></ul><hr><p><a id="global-config"></a></p><h2 id="一、🌍-全局配置">一、🌍 全局配置</h2><p><a id="color-scheme"></a></p><h3 id="1-🎨-页面基本配色">1. 🎨 页面基本配色</h3><ul><li>✨ <strong>功能</strong>：自定义博客全局配色方案，包括明亮/暗黑模式下的代码块样式、圆角大小等</li><li>📌 <strong>位置</strong>：在 <code>/assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ---------------页面基本配色---------------</span></span><br><span class="line"><span class="selector-pseudo">:root</span> &#123;</span><br><span class="line">  <span class="comment">// 全局顶部边距</span></span><br><span class="line">  <span class="attr">--main-top-padding</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="comment">// 全局卡片圆角</span></span><br><span class="line">  <span class="attr">--card-border-radius</span>: <span class="number">25px</span>;</span><br><span class="line">  <span class="comment">// 标签云卡片圆角</span></span><br><span class="line">  <span class="attr">--tag-border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="comment">// 卡片间距</span></span><br><span class="line">  <span class="attr">--section-separation</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="comment">// 全局字体大小</span></span><br><span class="line">  <span class="attr">--article-font-size</span>: <span class="number">1.8rem</span>;</span><br><span class="line">  <span class="comment">// 行内代码背景色</span></span><br><span class="line">  <span class="attr">--code-background-color</span>: <span class="number">#f8f8f8</span>;</span><br><span class="line">  <span class="comment">// 行内代码前景色</span></span><br><span class="line">  <span class="attr">--code-text-color</span>: <span class="number">#e96900</span>;</span><br><span class="line">  <span class="comment">// 暗色模式下样式</span></span><br><span class="line">  &amp;<span class="selector-attr">[data-scheme=<span class="string">&quot;dark&quot;</span>]</span> &#123;</span><br><span class="line">    <span class="comment">// 行内代码背景色</span></span><br><span class="line">    <span class="attr">--code-background-color</span>: <span class="number">#ff6d1b17</span>;</span><br><span class="line">    <span class="comment">// 行内代码前景色</span></span><br><span class="line">    <span class="attr">--code-text-color</span>: <span class="number">#e96900</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="layout-adjustment"></a></p><h3 id="2-📐-全局布局调整">2. 📐 全局布局调整</h3><ul><li>✨ <strong>功能</strong>：调整整体页面布局结构，包括三栏宽度比例、下拉菜单样式等</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//---------------------------------------------------</span></span><br><span class="line"><span class="comment">// 全局页面布局间距调整</span></span><br><span class="line"><span class="selector-class">.main-container</span> &#123;</span><br><span class="line">  <span class="attribute">min-height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">align-items</span>: flex-start;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="built_in">var</span>(--section-separation);</span><br><span class="line">  <span class="attribute">padding-top</span>: <span class="built_in">var</span>(--main-top-padding);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">37px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//--------------------------------------------------</span></span><br><span class="line"><span class="comment">//页面三栏宽度调整</span></span><br><span class="line"><span class="selector-class">.container</span> &#123;</span><br><span class="line">  <span class="attribute">margin-left</span>: auto;</span><br><span class="line">  <span class="attribute">margin-right</span>: auto;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.left-sidebar</span> &#123;</span><br><span class="line">    <span class="attribute">order</span>: -<span class="number">3</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="built_in">var</span>(--left-sidebar-max-width);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.right-sidebar</span> &#123;</span><br><span class="line">    <span class="attribute">order</span>: -<span class="number">1</span>;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="built_in">var</span>(--right-sidebar-max-width);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/// Display right sidebar when min-width: lg</span></span><br><span class="line">    <span class="keyword">@include</span> respond(lg) &#123;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.extended</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">1024px</span>;</span><br><span class="line">      <span class="attr">--left-sidebar-max-width</span>: <span class="number">25%</span>;</span><br><span class="line">      <span class="attr">--right-sidebar-max-width</span>: <span class="number">22%</span> <span class="meta">!important</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(lg) &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">1280px</span>;</span><br><span class="line">      <span class="attr">--left-sidebar-max-width</span>: <span class="number">20%</span>;</span><br><span class="line">      <span class="attr">--right-sidebar-max-width</span>: <span class="number">30%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">1453px</span>; <span class="comment">//1536px;</span></span><br><span class="line">      <span class="attr">--left-sidebar-max-width</span>: <span class="number">15%</span>;</span><br><span class="line">      <span class="attr">--right-sidebar-max-width</span>: <span class="number">25%</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.compact</span> &#123;</span><br><span class="line">    <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">      <span class="attr">--left-sidebar-max-width</span>: <span class="number">25%</span>;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">768px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(lg) &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">1024px</span>;</span><br><span class="line">      <span class="attr">--left-sidebar-max-width</span>: <span class="number">20%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">      <span class="attribute">max-width</span>: <span class="number">1280px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------------------------</span></span><br><span class="line"><span class="comment">//全局页面小图片样式微调</span></span><br><span class="line"><span class="selector-class">.article-list--compact</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">var</span>(--image-size);</span><br><span class="line">  <span class="attribute">height</span>: <span class="built_in">var</span>(--image-size);</span><br><span class="line">  <span class="selector-tag">object</span>-fit: cover;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">17%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// --------------------------------</span></span><br><span class="line"><span class="comment">// 下拉菜单改圆角样式</span></span><br><span class="line"><span class="selector-class">.menu</span> &#123;</span><br><span class="line">  <span class="attribute">padding-left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">list-style</span>: none;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">  <span class="comment">// overflow-y: scroll;</span></span><br><span class="line">  <span class="attribute">flex-grow</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.6rem</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--card-background);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// box-shadow: var(--shadow-l2); // 手机端下拉菜单会有莫名小方块</span></span><br><span class="line">  <span class="attribute">box-shadow</span>: none;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>; <span class="comment">//改为0</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>; <span class="comment">//加个圆角</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">30px</span> <span class="number">30px</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">15px</span> <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;,</span><br><span class="line">  <span class="selector-class">.menu-bottom-section</span> &#123;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">30px</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">      <span class="attribute">gap</span>: <span class="number">25px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.show</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">    <span class="attribute">align-items</span>: flex-end;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">background-color</span>: transparent;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">li</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">vertical-align</span>: middle;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">svg</span> &#123;</span><br><span class="line">      <span class="attribute">stroke-width</span>: <span class="number">1.33</span>;</span><br><span class="line"></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">20px</span>;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">a</span> &#123;</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">      <span class="attribute">display</span>: inline-flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--body-text-color);</span><br><span class="line">      <span class="attribute">gap</span>: <span class="built_in">var</span>(--menu-icon-separation);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">span</span> &#123;</span><br><span class="line">      <span class="attribute">flex</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-class">.current</span> &#123;</span><br><span class="line">      <span class="selector-tag">a</span> &#123;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--accent-color);</span><br><span class="line">        <span class="attribute">font-weight</span>: bold;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*手机模式下的菜单滚动条美化*/</span></span><br><span class="line"><span class="selector-class">.menu</span>::-webkit-scrollbar &#123;</span><br><span class="line">  <span class="attribute">display</span>: none; <span class="comment">//防止大屏幕时出现滚动条</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.sidebar</span> <span class="selector-tag">header</span> <span class="selector-class">.site-name</span> &#123;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">2rem</span>; <span class="comment">//字体大小</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="article-beautification"></a></p><h2 id="二、📝-文章内容美化">二、📝 文章内容美化</h2><p><a id="basic-article-styling"></a></p><h3 id="1-✨-文章内容基本美化">1. ✨ 文章内容基本美化</h3><ul><li>✨ <strong>功能</strong>：优化文章内代码块、图片、引用等元素的显示效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------</span></span><br><span class="line"><span class="comment">// 文章内容引用块样式</span></span><br><span class="line"><span class="selector-class">.article-content</span> &#123;</span><br><span class="line">  <span class="selector-tag">blockquote</span> &#123;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">6px</span> solid <span class="number">#358b9a1f</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#3a97431f</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ---------------------------------------</span></span><br><span class="line"><span class="comment">// 代码块基础样式修改</span></span><br><span class="line"><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">102%</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--pre-background-color);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="built_in">var</span>(--card-padding);</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">margin-left</span>: -<span class="number">7px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: -<span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--shadow-l1) <span class="meta">!important</span>;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="selector-class">.copyCodeButton</span> &#123;</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// keep Codeblocks LTR</span></span><br><span class="line">  <span class="selector-attr">[dir=<span class="string">&quot;rtl&quot;</span>]</span> &amp; &#123;</span><br><span class="line">    <span class="attribute">direction</span>: ltr;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  pre &#123;</span><br><span class="line">    <span class="attribute">margin</span>: initial;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: auto;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//----------------------------------------------</span></span><br><span class="line"><span class="comment">// light模式下的代码块样式调整</span></span><br><span class="line"><span class="selector-attr">[data-scheme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.article-content</span> <span class="selector-class">.highlight</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff9f3</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-scheme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.chroma</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ff6f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fff9f3cc</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//---------------------------------------------------</span></span><br><span class="line"><span class="comment">// 文章内容图片圆角</span></span><br><span class="line"><span class="selector-class">.article-page</span> <span class="selector-class">.main-article</span> <span class="selector-class">.article-content</span> &#123;</span><br><span class="line">  <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">96%</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------------</span></span><br><span class="line"><span class="comment">// 设置选中字体的区域背景颜色</span></span><br><span class="line"><span class="selector-pseudo">::selection</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#001572</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="selector-tag">text</span>-decoration: none;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--accent-color);</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--accent-color-darker);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.link</span> &#123;</span><br><span class="line">    <span class="attribute">font-weight</span>: <span class="number">800</span>; <span class="comment">/* 字体粗细为700（加粗） */</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">2px</span>; <span class="comment">/* 内边距为左右各2px */</span></span><br><span class="line">    <span class="selector-tag">text</span>-decoration: none; <span class="comment">/* 取消默认的下划线 */</span></span><br><span class="line">    <span class="attribute">cursor</span>: pointer; <span class="comment">/* 鼠标指针为指针样式 */</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 超链接默认颜色（明亮模式） */</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#000000</span>; <span class="comment">/* 明亮模式下链接字体为黑色#000000 */</span></span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="selector-tag">text</span>-decoration: underline;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">prefers-color-scheme</span>: dark) &#123;</span><br><span class="line">    <span class="selector-class">.link</span> &#123;</span><br><span class="line">        <span class="comment">/* 超链接默认颜色（暗色模式） */</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="number">#FFFFFF</span>; <span class="comment">/* 暗色模式下链接字体为白色#FFFFFF */</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-------------------------------------------------</span></span><br><span class="line"><span class="comment">//文章封面高度更改</span></span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>; <span class="comment">// 设置图片的高度为 150px</span></span><br><span class="line">  <span class="selector-tag">object</span>-fit: cover;</span><br><span class="line">  </span><br><span class="line">  <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">305px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">// 修复引用块内容窄页面显示问题</span></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">word-break</span>: break-all;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">code</span> &#123;</span><br><span class="line">  <span class="attribute">word-break</span>: break-all;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="blockquote-styling"></a></p><h3 id="2-💬-MD-引用块样式">2. 💬 MD 引用块样式</h3><ul><li>✨ <strong>功能</strong>：为Markdown引用块添加特殊样式，增强视觉效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 文章内容引用块样式</span></span><br><span class="line"><span class="selector-class">.article-content</span> &#123;</span><br><span class="line">  <span class="selector-tag">blockquote</span> &#123;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">6px</span> solid <span class="number">#004b28</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#366e33</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="image-center"></a></p><h3 id="3-🖼️-使图床链接的图片居中">3. 🖼️ 使图床链接的图片居中</h3><ul><li>✨ <strong>功能</strong>：让外部图床的图片也能像本地图片一样居中显示</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/partials/layout/article.scss</code> Line 256 处（同级任意位置）增加以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 图床链接的图片居中</span></span><br><span class="line"><span class="selector-tag">p</span> &gt; <span class="selector-tag">img</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="word-count"></a></p><h3 id="4-📊-统计站点文章数量和字数">4. 📊 统计站点文章数量和字数</h3><ul><li>✨ <strong>功能</strong>：在页脚显示博客总文章数和总字数统计</li><li>📌 <strong>位置</strong>：在<code>./layout/partials/footer/footer.html</code> 的 <code>&lt;section class=&quot;powerby&quot;&gt;</code> 里边，加入代码：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; $articleCount := len .Site.RegularPages &#125;&#125;</span><br><span class="line">&#123;&#123; $totalWordCount := 0 &#125;&#125;</span><br><span class="line">&#123;&#123; range .Site.Pages &#125;&#125;</span><br><span class="line">&#123;&#123; $totalWordCount = add $totalWordCount .WordCount &#125;&#125;</span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>发布了 &#123;&#123; $articleCount &#125;&#125; 篇文章 | 共 &#123;&#123;$totalWordCount&#125;&#125; 字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a id="homepage-articles"></a></p><h3 id="5-🏠-首页文章样式">5. 🏠 首页文章样式</h3><ul><li>✨ <strong>功能</strong>：美化首页文章列表的显示效果，包括图片圆角和悬停动画</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 加入代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*主页文章图片样式*/</span></span><br><span class="line"><span class="variable">$image-scale</span>: <span class="number">1.2</span>;</span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">150px</span>;</span><br><span class="line">  <span class="selector-tag">object</span>-fit: cover;</span><br><span class="line">  <span class="comment">//不同显示器（手机，小屏幕电脑，大屏幕电脑）显示的图片高度大小</span></span><br><span class="line">  <span class="keyword">@include</span> respond(sm) &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">305px</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">305px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">@include</span> respond(xl) &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">325px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*主页文章图片圆角*/</span></span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> &#123;</span><br><span class="line">  <span class="attr">--card-border-radius</span>: <span class="number">24px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*文章标签圆角*/</span></span><br><span class="line"><span class="selector-class">.article-category</span> <span class="selector-tag">a</span>, <span class="selector-class">.article-tags</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">11px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*鼠标移动到文章图片放大*/</span></span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden; <span class="comment">//不显示超出的部分</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="variable">$image-scale</span>); <span class="comment">//放大尺寸</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-list</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">0.85s</span> ease-in-out;<span class="comment">//持续时间</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="internal-images"></a></p><h3 id="6-🖼️-文章内部图片样式">6. 🖼️ 文章内部图片样式</h3><ul><li>✨ <strong>功能</strong>：优化文章内部相关文章区域的图片显示效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 加入代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*文章内部-页脚-相关文章图片圆角*/</span></span><br><span class="line"><span class="selector-class">.article-list--compact</span> <span class="selector-tag">article</span> <span class="selector-class">.article-image</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">17%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*文章内部-页脚-相关文章图片放大动画*/</span></span><br><span class="line"><span class="selector-class">.article-list--compact</span> <span class="selector-tag">article</span> &gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: .<span class="number">6s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-list--compact</span> <span class="selector-tag">article</span> &gt; <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.03</span>, <span class="number">1.03</span>);</span><br><span class="line">  <span class="attribute">overflow</span>: visible;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="macos-codeblocks"></a></p><h3 id="7-💻-MacOS-风格代码块">7. 💻 MacOS 风格代码块</h3><ul><li>✨ <strong>功能</strong>：为代码块添加MacOS风格顶部栏，增强视觉美感</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MacOS 风格代码块</span></span><br><span class="line"><span class="selector-class">.article-content</span> &#123;</span><br><span class="line">  <span class="selector-class">.highlight</span><span class="selector-pseudo">:before</span> &#123;</span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">url</span>(/code-header.svg);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">32px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-size</span>: <span class="number">57px</span>;</span><br><span class="line">    <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">background-position</span>: -<span class="number">1px</span> <span class="number">2px</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// light模式下的代码块样式调整</span></span><br><span class="line"><span class="selector-attr">[data-scheme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.article-content</span> <span class="selector-class">.highlight</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fdf4eb</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-scheme=<span class="string">&quot;light&quot;</span>]</span> <span class="selector-class">.chroma</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ff6f00</span>;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#fcf0e4cc</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>📌 <strong>位置</strong>：在 <code>./static</code> 文件夹下新建 <code>code-header.svg</code>写入以下代码：</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">version</span>=<span class="string">&quot;1.1&quot;</span>  <span class="attr">x</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">y</span>=<span class="string">&quot;0px&quot;</span> <span class="attr">width</span>=<span class="string">&quot;470px&quot;</span> <span class="attr">height</span>=<span class="string">&quot;130px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&quot;65&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;65&quot;</span> <span class="attr">rx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">ry</span>=<span class="string">&quot;52&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;rgb(220,60,54)&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;rgb(237,108,96)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&quot;225&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;65&quot;</span> <span class="attr">rx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">ry</span>=<span class="string">&quot;52&quot;</span>  <span class="attr">stroke</span>=<span class="string">&quot;rgb(218,151,33)&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;rgb(247,193,81)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">ellipse</span> <span class="attr">cx</span>=<span class="string">&quot;385&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;65&quot;</span> <span class="attr">rx</span>=<span class="string">&quot;50&quot;</span> <span class="attr">ry</span>=<span class="string">&quot;52&quot;</span>  <span class="attr">stroke</span>=<span class="string">&quot;rgb(27,161,37)&quot;</span> <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;rgb(100,200,86)&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a id="codeblock-styling"></a></p><h3 id="8-🔧-修改代码块样式">8. 🔧 修改代码块样式</h3><ul><li>✨ <strong>功能</strong>：调整代码块的边距、圆角和复制按钮位置</li><li>📌 <strong>位置</strong>：修改 <code>.\assets\scss\partials\layout\article.scss,</code>在文件尾添加：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// --------------------代码块样式------------------------</span></span><br><span class="line"><span class="comment">// * 修改边距</span></span><br><span class="line"><span class="comment">// * 背景框添加圆角</span></span><br><span class="line"><span class="comment">// * 调整 copy 按钮位置</span></span><br><span class="line"><span class="selector-class">.highlight</span> &#123;</span><br><span class="line">    <span class="attribute">margin-left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--card-border-radius);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.copyCodeButton</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">6px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="syntax-highlighting"></a></p><h3 id="9-🎯-代码块高亮">9. 🎯 代码块高亮</h3><ul><li>✨ <strong>功能</strong>：配置代码语法高亮样式，支持行号显示</li><li>📌 <strong>位置</strong>：在 <code>hugo.yaml</code> 中，添加 <code>highlight</code> 参数：</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">markup:</span></span><br><span class="line">    <span class="attr">highlight:</span></span><br><span class="line">        <span class="attr">noClasses:</span> <span class="literal">false</span></span><br><span class="line">        <span class="attr">codeFences:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">guessSyntax:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">lineNoStart:</span> <span class="number">1</span></span><br><span class="line">        <span class="attr">lineNos:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">lineNumbersInTable:</span> <span class="literal">true</span></span><br><span class="line">        <span class="attr">tabWidth:</span> <span class="number">4</span></span><br><span class="line">        <span class="attr">style:</span> <span class="string">github-dark</span></span><br></pre></td></tr></table></figure><p><a id="hide-language"></a></p><h3 id="10-🚫-关闭代码块语言显示">10. 🚫 关闭代码块语言显示</h3><ul><li>✨ <strong>功能</strong>：隐藏代码块顶部的语言标识</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 关闭代码块语言显示</span></span><br><span class="line"><span class="selector-class">.languageCodeButton</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="external-links"></a></p><h3 id="11-🔗-外部链接后面显示图标">11. 🔗 外部链接后面显示图标</h3><ul><li>✨ <strong>功能</strong>：为外部链接添加图标标识，提示用户这是外部链接</li><li>📌 <strong>位置</strong>：创建<code>./layouts/_default/_markup/render-link.html</code>文件之后增加如下代码:</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;link&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; .Destination | safeURL &#125;&#125;&quot;</span> &#123;&#123; <span class="attr">with</span> <span class="attr">.Title</span> &#125;&#125; <span class="attr">title</span>=<span class="string">&quot;&#123;&#123; . &#125;&#125;&quot;</span> &#123;&#123; <span class="attr">end</span> &#125;&#125; &#123;&#123; <span class="attr">if</span> <span class="attr">strings.HasPrefix</span> <span class="attr">.Destination</span> &quot;<span class="attr">http</span>&quot; &#125;&#125; <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;noopener&quot;</span> &#123;&#123; <span class="attr">end</span> &#125;&#125;&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;display: inline-flex; align-items: center; gap: 0.5em;&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; .Text | safeHTML &#125;&#125;</span><br><span class="line">        &#123;&#123; if strings.HasPrefix .Destination &quot;http&quot; &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">svg</span> <span class="attr">width</span>=<span class="string">&quot;.7em&quot;</span> <span class="attr">height</span>=<span class="string">&quot;.7em&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 21 21&quot;</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;m13 3l3.293 3.293l-7 7l1.414 1.414l7-7L21 11V3z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M19 19H5V5h7l-2-2H5c-1.103 0-2 .897-2 2v14c0 1.103.897 2 2 2h14c1.103 0 2-.897 2-2v-5l-2-2v7z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;currentColor&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">        &#123;&#123; end &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a id="copy-buttons"></a></p><h3 id="12-📋-语言和复制按钮">12. 📋 语言和复制按钮</h3><ul><li>✨ <strong>功能</strong>：改进代码块的语言标识和复制按钮的显示方式</li><li>📌 <strong>位置</strong>：在 <code>./assets/ts/main.ts</code> 中，第 66 行开始，改成以下代码</li></ul><figure class="highlight ts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> highlights = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.article-content div.highlight&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> copyText = <span class="string">`📄拷贝`</span>,</span><br><span class="line">    copiedText = <span class="string">`已拷贝!`</span>;</span><br><span class="line"></span><br><span class="line">highlights.<span class="title function_">forEach</span>(<span class="function">(<span class="params">highlight</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> copyButton = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">    copyButton.<span class="property">innerHTML</span> = copyText;</span><br><span class="line">    copyButton.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;copyCodeButton&quot;</span>);</span><br><span class="line">    highlight.<span class="title function_">appendChild</span>(copyButton);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> codeBlock = highlight.<span class="title function_">querySelector</span>(<span class="string">&quot;code[data-lang]&quot;</span>);</span><br><span class="line">    <span class="comment">// 获取语言</span></span><br><span class="line">    <span class="keyword">const</span> lang = codeBlock.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-lang&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span> (!codeBlock) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    copyButton.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">        navigator.<span class="property">clipboard</span></span><br><span class="line">            .<span class="title function_">writeText</span>(codeBlock.<span class="property">textContent</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                copyButton.<span class="property">textContent</span> = copiedText;</span><br><span class="line"></span><br><span class="line">                <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                    copyButton.<span class="property">textContent</span> = copyText;</span><br><span class="line">                &#125;, <span class="number">1000</span>);</span><br><span class="line">            &#125;)</span><br><span class="line">            .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">                <span class="title function_">alert</span>(err);</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Something went wrong&quot;</span>, err);</span><br><span class="line">            &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Add language code button</span></span><br><span class="line">    <span class="keyword">const</span> languageButton = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;button&quot;</span>);</span><br><span class="line">    languageButton.<span class="property">innerHTML</span> = lang.<span class="title function_">toUpperCase</span>() + <span class="string">&quot;&amp;nbsp;&amp;nbsp;&quot;</span>;</span><br><span class="line">    languageButton.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;languageCodeButton&quot;</span>);</span><br><span class="line"></span><br><span class="line">    highlight.<span class="title function_">appendChild</span>(languageButton);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">StackColorScheme</span>(<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;dark-mode-toggle&quot;</span>));</span><br></pre></td></tr></table></figure><ul><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码调整按钮位置：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 复制按钮样式调整 */</span></span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-class">.copyCodeButton</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">18px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#ffffff</span>; </span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#3d3c3c</span>; </span><br><span class="line">  <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span>; </span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">5px</span> <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">500</span>;</span><br><span class="line">  <span class="selector-tag">text</span>-shadow: <span class="number">0</span> <span class="number">0</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.5</span>); </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 注释语言代码框 */</span></span><br><span class="line"><span class="comment">/* </span></span><br><span class="line"><span class="comment">.article-content .languageCodeButton &#123;</span></span><br><span class="line"><span class="comment">  position: absolute;</span></span><br><span class="line"><span class="comment">  top: 9px;</span></span><br><span class="line"><span class="comment">  right: 100px; </span></span><br><span class="line"><span class="comment">  border-radius: 12px;</span></span><br><span class="line"><span class="comment">  color: #000; </span></span><br><span class="line"><span class="comment">  background: #ffff00; </span></span><br><span class="line"><span class="comment">  border: 1px solid #333; </span></span><br><span class="line"><span class="comment">  padding: 5px 10px;</span></span><br><span class="line"><span class="comment">  font-family: lato;</span></span><br><span class="line"><span class="comment">  font-size: 1.5rem;</span></span><br><span class="line"><span class="comment">  text-shadow: 0 0 1px rgba(255, 255, 255, 0.5); </span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-class">.copyCodeButton</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ffa500</span>; </span><br><span class="line">  <span class="attribute">border-color</span>: <span class="number">#000</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="sidebar-beautification"></a></p><h2 id="三、📌-侧边栏美化">三、📌 侧边栏美化</h2><p><a id="sidebar-width"></a></p><h3 id="1-📏-页面左右边栏宽度">1. 📏 页面左右边栏宽度</h3><ul><li>✨ <strong>功能</strong>：调整左右侧边栏的宽度比例，优化阅读体验</li><li>📌 <strong>位置</strong>：在 <code>/themes/hugo-theme-stack/assets/scss/grid.scss</code> 的第 29、30 行，修改为:</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">--left-sidebar-max-width</span>: <span class="number">14%</span>;</span><br><span class="line"><span class="attr">--right-sidebar-max-width</span>: <span class="number">22%</span>;</span><br></pre></td></tr></table></figure><p><a id="right-sidebar-animation"></a></p><h3 id="2-🎭-右侧导航栏动画">2. 🎭 右侧导航栏动画</h3><ul><li>✨ <strong>功能</strong>：为右侧边栏元素添加悬停动画效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">//归档小图标放大动画</span></span><br><span class="line"><span class="selector-class">.widget</span><span class="selector-class">.archives</span> <span class="selector-class">.widget-archive--list</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform .<span class="number">3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.widget</span><span class="selector-class">.archives</span> <span class="selector-class">.widget-archive--list</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>, <span class="number">1.05</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">//右侧标签放大动画</span></span><br><span class="line"><span class="selector-class">.tagCloud</span> <span class="selector-class">.tagCloud-tags</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.4rem</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform .<span class="number">3s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.tagCloud</span> <span class="selector-class">.tagCloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>, <span class="number">1.1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="left-sidebar-styling"></a></p><h3 id="3-🎨-左侧导航栏美化">3. 🎨 左侧导航栏美化</h3><ul><li>✨ <strong>功能</strong>：美化左侧边栏的头像、社交图标等元素</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 加入代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*--------------------左侧导航栏---------------*/</span></span><br><span class="line"><span class="selector-class">.left-sidebar</span> &#123;</span><br><span class="line">  <span class="attr">--sidebar-avatar-size</span>: <span class="number">115px</span>; <span class="comment">//左侧头像大小</span></span><br><span class="line">  <span class="attr">--sidebar-element-separation</span>: <span class="number">15px</span>; <span class="comment">//头像下方间距</span></span><br><span class="line">  <span class="attr">--emoji-size</span>: <span class="number">40px</span>; <span class="comment">//emoji容器大小</span></span><br><span class="line">  <span class="attr">--emoji-font-size</span>: <span class="number">25px</span>; <span class="comment">//emoji字体大小</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*社交菜单居中*/</span></span><br><span class="line"><span class="selector-class">.social-menu</span> <span class="selector-tag">svg</span> &#123;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">15px</span>;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">30px</span>; <span class="comment">//社交菜单大小</span></span><br><span class="line">  <span class="attribute">stroke</span>: <span class="built_in">var</span>(--body-text-color);</span><br><span class="line">  <span class="attribute">stroke-width</span>: <span class="number">1.33</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="left-sidebar-animation"></a></p><h3 id="4-✨-左侧导航栏动画">4. ✨ 左侧导航栏动画</h3><ul><li>✨ <strong>功能</strong>：为左侧菜单项添加悬停动画效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">/* 左侧栏选项动画 */</span></span><br><span class="line"><span class="selector-id">#main-menu</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: visible;</span><br><span class="line">    <span class="selector-tag">li</span> &#123;</span><br><span class="line">        <span class="selector-tag">a</span> &#123;</span><br><span class="line">            -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">            <span class="attribute">will-change</span>: transform;</span><br><span class="line">            <span class="attribute">transition</span>: transform <span class="number">0.6s</span> ease;</span><br><span class="line">            &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">                <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>, <span class="number">1.1</span>);</span><br><span class="line">                <span class="attribute">will-change</span>: transform;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 归档和链接卡片动画 */</span></span><br><span class="line"><span class="selector-class">.article-list--compact</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: visible;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-list--compact</span> <span class="selector-tag">article</span> &#123;</span><br><span class="line">    <span class="attribute">transition</span>: transform <span class="number">0.6s</span> ease;</span><br><span class="line">    -webkit-<span class="attribute">font-smoothing</span>: antialiased;</span><br><span class="line">    <span class="attribute">will-change</span>: transform;</span><br><span class="line">    </span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>,<span class="number">1.05</span>);</span><br><span class="line">        <span class="attribute">z-index</span>: <span class="number">4</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 分类页面动画 */</span></span><br><span class="line"><span class="selector-class">.article-list--tile</span> <span class="selector-tag">article</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.6s</span> ease;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.article-list--tile</span> <span class="selector-tag">article</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.05</span>, <span class="number">1.05</span>);</span><br><span class="line">  <span class="attribute">will-change</span>: transform;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="social-icons"></a></p><h3 id="5-🤝-社交-social">5. 🤝 社交 social</h3><ul><li>✨ <strong>功能</strong>：自定义社交图标并添加旋转动画效果</li><li>📌 <strong>说明</strong>：自定义图标，iconfont 下载，颜色 #2c3e50，大小 24，格式 svg。下载后放到 <code>.\assets\icons</code></li><li>📌 <strong>说明</strong>：本主题自带了一些来自【<a href="https://tabler.io/icons">Tabler Icons</a>】的 SVG 图标。您可以在主题文件夹下找到它们 <code>.\assets\icons</code></li><li>💡 <strong>提示</strong>：将下载的 img 中的 svg 的所有 #2c3e50 改成 <code>currentColor</code>，否则切换为黑色模式，图标颜色不能自动切换，因为优先使用内部定义的 color</li><li>📌 <strong>位置</strong>：修改 hugo 主配置文件，修改下面的内容：</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">    <span class="attr">main:</span> [] <span class="comment"># 主菜单</span></span><br><span class="line"></span><br><span class="line">    <span class="attr">social:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">identifier:</span> <span class="string">bilibili</span> <span class="comment"># 标识符</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">Bilibili</span> <span class="comment"># 显示名称</span></span><br><span class="line">          <span class="attr">url:</span> <span class="string">https://space.bilibili.com/35158479</span> <span class="comment"># 链接地址</span></span><br><span class="line">          <span class="attr">weight:</span> <span class="number">100</span> <span class="comment"># 项目的优先级，值越低，优先级越高。</span></span><br><span class="line">          <span class="attr">params:</span></span><br><span class="line">              <span class="attr">icon:</span> <span class="string">brand-bilibili</span> <span class="comment"># 图标名称</span></span><br><span class="line">              <span class="attr">newTab:</span> <span class="literal">true</span> <span class="comment"># 新标签页中打开此链接</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">identifier:</span> <span class="string">github</span> <span class="comment"># 标识符</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">GitHub</span> <span class="comment"># 显示名称</span></span><br><span class="line">          <span class="attr">url:</span> <span class="string">https://github.com/meimolihan</span> <span class="comment"># 链接地址</span></span><br><span class="line">          <span class="attr">weight:</span> <span class="number">200</span> <span class="comment"># 项目的优先级，值越低，优先级越高。</span></span><br><span class="line">          <span class="attr">params:</span></span><br><span class="line">              <span class="attr">icon:</span> <span class="string">brand-github</span> <span class="comment"># 图标名称</span></span><br><span class="line">              <span class="attr">newTab:</span> <span class="literal">true</span> <span class="comment"># 新标签页中打开此链接</span></span><br><span class="line"></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">identifier:</span> <span class="string">rss</span> <span class="comment"># 标识符</span></span><br><span class="line">          <span class="attr">name:</span> <span class="string">RSS</span> <span class="comment"># 显示名称</span></span><br><span class="line">          <span class="attr">url:</span> <span class="string">https://meimolihan.github.io/index.xml</span> <span class="comment"># 链接地址</span></span><br><span class="line">          <span class="attr">weight:</span> <span class="number">300</span> <span class="comment"># 项目的优先级，值越低，优先级越高。</span></span><br><span class="line">          <span class="attr">params:</span></span><br><span class="line">              <span class="attr">icon:</span> <span class="string">brand-rss</span> <span class="comment"># 图标名称</span></span><br><span class="line">              <span class="attr">newTab:</span> <span class="literal">true</span> <span class="comment"># 新标签页中打开此链接</span></span><br></pre></td></tr></table></figure><ul><li>📌 <strong>位置</strong>：图标360度旋转动画<code>.\assets\scss\custom.scss</code>追加以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.icon-tabler-brand-bilibili</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">1s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标悬停时让 SVG 图标旋转 360 度 */</span></span><br><span class="line"><span class="selector-class">.icon-tabler-brand-bilibili</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.icon-tabler-brand-github</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">1s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标悬停时让 SVG 图标旋转 360 度 */</span></span><br><span class="line"><span class="selector-class">.icon-tabler-brand-github</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.icon-tabler-rss</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">1s</span> ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 鼠标悬停时让 SVG 图标旋转 360 度 */</span></span><br><span class="line"><span class="selector-class">.icon-tabler-rss</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="dark-mode-toggle"></a></p><h3 id="6-🌓-明亮模式调整位置">6. 🌓 明亮模式调整位置</h3><ul><li>✨ <strong>功能</strong>：调整明暗模式切换按钮的位置</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 明暗模式切换按钮，调整位置</span></span><br><span class="line"><span class="selector-id">#dark-mode-toggle</span> &#123;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">100px</span>; <span class="comment">// 明暗模式，上下高度</span></span><br><span class="line">    <span class="comment">// margin-left: 10px;  // 明暗模式，左右调节</span></span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">30px</span>; <span class="comment">// 明暗模式，横向宽度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="manual-sidebar"></a></p><h3 id="7-⚙️-手动修改左右侧边栏设置样式">7. ⚙️ 手动修改左右侧边栏设置样式</h3><ul><li>✨ <strong>功能</strong>：手动精确控制左右侧边栏的宽度比例</li><li>📌 <strong>位置</strong>：在 <code>/assets/scss/grid.scss</code> 中修改 <code>left-sidebar</code> 和 <code>right-sidebar</code> 的描述：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 为左右侧边栏设置样式，将左侧边栏的排列顺序设为 -3 并将最大宽度设为父容器的 10%，右侧边栏排列顺序设为 -1 且最大宽度为父容器的 20%，同时利用自定义响应式混合器，使右侧边栏在屏幕达到特定大尺寸（对应 lg）时以弹性布局显示。</span></span><br><span class="line">    <span class="selector-class">.left-sidebar</span> &#123;</span><br><span class="line">        <span class="attribute">order</span>: -<span class="number">3</span>;</span><br><span class="line">        <span class="comment">// max-width: var(--left-sidebar-max-width);</span></span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">10%</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.right-sidebar</span> &#123;</span><br><span class="line">        <span class="attribute">order</span>: -<span class="number">1</span>;</span><br><span class="line">        <span class="comment">// max-width: var(--right-sidebar-max-width);</span></span><br><span class="line">        <span class="attribute">max-width</span>: <span class="number">20%</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">/// Display right sidebar when min-width: lg</span></span><br><span class="line">        <span class="keyword">@include</span> respond(lg) &#123;</span><br><span class="line">            <span class="attribute">display</span>: flex;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>把正文的占比改到了 70%, 原来的只有 50% 左右</p><p><a id="avatar-rotation"></a></p><h3 id="8-🔄-头像旋转">8. 🔄 头像旋转</h3><ul><li>✨ <strong>功能</strong>：为博客头像添加旋转动画效果</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------头像旋转动画--------------</span></span><br><span class="line"><span class="selector-class">.sidebar</span> <span class="selector-tag">header</span> <span class="selector-class">.site-avatar</span> <span class="selector-class">.site-logo</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">1.65s</span> ease-in-out; <span class="comment">// 旋转时间</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.sidebar</span> <span class="selector-tag">header</span> <span class="selector-class">.site-avatar</span> <span class="selector-class">.site-logo</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>); <span class="comment">// 旋转角度为360度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="three-column-layout"></a></p><h3 id="9-📂-友情链接-分类-标签-归档【三栏显示】">9. 📂 友情链接+分类+标签+归档【三栏显示】</h3><ul><li>✨ <strong>功能</strong>：将友情链接、分类、标签和归档以三栏网格布局显示</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//------------------------------------------------------</span></span><br><span class="line"><span class="comment">// 友情链接+分类+标签+归档【三栏显示】</span></span><br><span class="line"><span class="keyword">@media</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.article-list--compact</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: grid;</span><br><span class="line">    <span class="comment">// 目前是三列，如需二列，则后面减去一个1fr，以此类推</span></span><br><span class="line">    <span class="attribute">grid-template-columns</span>: <span class="number">1</span>fr <span class="number">1</span>fr <span class="number">1</span>fr;</span><br><span class="line">    <span class="attribute">background</span>: none;</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">1rem</span>;</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">article</span> &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--card-background);</span><br><span class="line">      <span class="attribute">border</span>: none;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--shadow-l2);</span><br><span class="line">      <span class="attribute">margin-bottom</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">margin-right</span>: <span class="number">8px</span>;</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">16px</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="archive-cards"></a></p><h3 id="10-📦-缩小归档页的分类卡片尺寸">10. 📦 缩小归档页的分类卡片尺寸</h3><ul><li>✨ <strong>功能</strong>：调整归档页面分类卡片的尺寸，使其更加紧凑</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/partials/layout/list.scss</code>中加入以下代码：(并修改)</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//---------------缩小归档页的分类卡片尺寸---------------</span></span><br><span class="line"><span class="selector-class">.subsection-list</span> &#123;</span><br><span class="line">    <span class="attribute">overflow-x</span>: auto;</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.article-list--tile</span> &#123;</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">padding-bottom</span>: <span class="number">0px</span>;</span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">article</span> &#123;</span><br><span class="line">            <span class="attribute">width</span>: <span class="number">230px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">120px</span>;</span><br><span class="line">            <span class="attribute">margin-right</span>: <span class="number">5px</span>;</span><br><span class="line">            <span class="attribute">flex-shrink</span>: <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">            <span class="selector-class">.article-title</span> &#123;</span><br><span class="line">                <span class="attribute">margin</span>: <span class="number">0</span>;</span><br><span class="line">                <span class="attribute">font-size</span>: <span class="number">1.8rem</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="selector-class">.article-details</span> &#123;</span><br><span class="line">                <span class="attribute">padding</span>: <span class="number">20px</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="toc-spacing"></a></p><h3 id="11-📋-调整-TOC-目录间距">11. 📋 调整 TOC 目录间距</h3><ul><li>✨ <strong>功能</strong>：优化目录显示的间距和样式，提高可读性</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------调整 TOC 目录间距------------------</span></span><br><span class="line"><span class="comment">// 主要解决了几个问题：</span></span><br><span class="line"><span class="comment">// 目录太高了，使得之前添加的返回顶部按钮可能会被顶出屏幕；</span></span><br><span class="line"><span class="comment">// 目录项前面的小黑点不太好看，隐去；</span></span><br><span class="line"><span class="comment">// 目录项之间的距离不够紧凑。</span></span><br><span class="line"><span class="selector-class">.widget--toc</span> &#123;</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="built_in">var</span>(--card-background);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="built_in">var</span>(--card-border-radius);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--shadow-l2); <span class="comment">//修改阴影样式</span></span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--card-text-color-main);</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">display</span>:inline-block; <span class="comment">//根据内容调整宽度</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#TableOfContents</span> &#123;</span><br><span class="line">      <span class="attribute">max-height</span>: <span class="number">65vh</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">ol</span>,</span><br><span class="line">      <span class="selector-tag">ul</span> &#123;</span><br><span class="line">          <span class="attribute">list-style-type</span>: none;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">li</span> &#123;</span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">10px</span> <span class="number">10px</span>;</span><br><span class="line"></span><br><span class="line">          &amp; &gt; <span class="selector-tag">ol</span>,</span><br><span class="line">          &amp; &gt; <span class="selector-tag">ul</span> &#123;</span><br><span class="line">              <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">              <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">              <span class="attribute">margin-bottom</span>: -<span class="number">5px</span>;</span><br><span class="line"></span><br><span class="line">              &amp; &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">                  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      &amp; &gt; <span class="selector-tag">ul</span> &#123;</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">1em</span>;</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">li</span> &#123;</span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">20px</span>; <span class="comment">//第一个参数是行间距，第二个是卡片周边的宽度</span></span><br><span class="line">          </span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">6px</span>; <span class="comment">//控制内边距</span></span><br><span class="line"></span><br><span class="line">          &amp; &gt; <span class="selector-tag">ol</span>,</span><br><span class="line">          &amp; &gt; <span class="selector-tag">ul</span> &#123;</span><br><span class="line">              <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">              <span class="attribute">padding-left</span>: <span class="number">10px</span>;</span><br><span class="line">              <span class="attribute">margin-bottom</span>: -<span class="number">5px</span>;</span><br><span class="line"></span><br><span class="line">              &amp; &gt; <span class="selector-tag">li</span><span class="selector-pseudo">:last-child</span> &#123;</span><br><span class="line">                  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">              &#125;</span><br><span class="line">          &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="link-hover"></a></p><h3 id="12-🔍-鼠标悬停超链接的显示">12. 🔍 鼠标悬停超链接的显示</h3><ul><li>✨ <strong>功能</strong>：为超链接添加悬停高亮效果，增强交互体验</li><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ---------------------鼠标悬停，超链接的显示-------------------</span></span><br><span class="line"><span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="selector-tag">text</span>-decoration: none;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--accent-color);</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--accent-color-darker);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;<span class="selector-class">.link</span> &#123;</span><br><span class="line">    <span class="comment">// 鼠标未悬停时，超链接显示2px的高亮</span></span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0px</span> -<span class="number">2px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="built_in">var</span>(--link-background-color), <span class="built_in">var</span>(--link-background-opacity-hover)) inset;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.3s</span> ease;</span><br><span class="line"></span><br><span class="line">    &amp;<span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">      <span class="comment">// 鼠标悬停，高亮为18px</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0px</span> -<span class="number">18px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="built_in">var</span>(--link-background-color), <span class="built_in">var</span>(--link-background-opacity-hover)) inset;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="other-widgets"></a></p><h2 id="四、🔧-其它小部件">四、🔧 其它小部件</h2><p><a id="site-stats"></a></p><h3 id="1-📈-添加站点统计信息与-i18n">1. 📈 添加站点统计信息与 i18n</h3><ul><li><p>✨ <strong>功能</strong>：在页脚显示博客运行时间、文章统计和访问量数据，支持多语言</p></li><li><p>📌 <strong>展示格式</strong>：</p><ul><li>本博客已稳定运行 x 天 y 小时 z 分钟</li><li>共发表 x 篇文章・总计 y k 字</li><li>本站总访问量 x 次</li></ul></li><li><p>📌 <strong>位置</strong>：在根目录<code>./layouts/partials/footer/footer.html</code> 文件内添加如下代码:</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;count_info&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;&#123; T &quot;footer.runtime1&quot; &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;ds&quot;</span> <span class="attr">class</span>=<span class="string">&quot;running-days&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;&#123; T &quot;footer.runtime2&quot; &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;hs&quot;</span> <span class="attr">class</span>=<span class="string">&quot;running-days&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;&#123; T &quot;footer.runtime3&quot; &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;ms&quot;</span> <span class="attr">class</span>=<span class="string">&quot;running-days&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            &#123;&#123; T &quot;footer.runtime4&quot; &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            &#123;&#123;$scratch := newScratch&#125;&#125;</span><br><span class="line">            &#123;&#123; range (where .Site.Pages &quot;Kind&quot; &quot;page&quot; )&#125;&#125;</span><br><span class="line">            &#123;&#123;$scratch.Add &quot;total&quot; .WordCount&#125;&#125;</span><br><span class="line">            &#123;&#123; end &#125;&#125;</span><br><span class="line">            &#123;&#123; T &quot;footer.count1&quot; &#125;&#125; &#123;&#123; len (where .Site.RegularPages &quot;Section&quot; &quot;post&quot;) &#125;&#125; &#123;&#123; T &quot;footer.count2&quot; &#125;&#125; &#123;&#123; div ($scratch.Get &quot;total&quot;) 1000.0 | lang.FormatNumber 2 &#125;&#125; k &#123;&#123; T &quot;footer.count3&quot; &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;busuanzi_container_site_pv&quot;</span>&gt;</span>&#123;&#123; T &quot;footer.pv1&quot; &#125;&#125;<span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;busuanzi_value_site_pv&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>&#123;&#123; T &quot;footer.pv2&quot; &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- Add blog running time --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> s1 = <span class="string">&#x27;2023-6-18&#x27;</span>; <span class="comment">//website start date</span></span></span><br><span class="line"><span class="language-javascript">    s1 = <span class="keyword">new</span> <span class="title class_">Date</span>(s1.<span class="title function_">replace</span>(<span class="regexp">/-/g</span>, <span class="string">&quot;/&quot;</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> s2 = <span class="keyword">new</span> <span class="title class_">Date</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> timeDifference = s2.<span class="title function_">getTime</span>() - s1.<span class="title function_">getTime</span>();</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> days = <span class="title class_">Math</span>.<span class="title function_">floor</span>(timeDifference / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> hours = <span class="title class_">Math</span>.<span class="title function_">floor</span>((timeDifference % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span> * <span class="number">24</span>)) / (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> minutes = <span class="title class_">Math</span>.<span class="title function_">floor</span>((timeDifference % (<span class="number">1000</span> * <span class="number">60</span> * <span class="number">60</span>)) / (<span class="number">1000</span> * <span class="number">60</span>));</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ds&#x27;</span>).<span class="property">innerHTML</span> = days;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;hs&#x27;</span>).<span class="property">innerHTML</span> = hours;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;ms&#x27;</span>).<span class="property">innerHTML</span> = minutes;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>📌 <strong>位置</strong>：在主题目录<code>/i18n/zh-cn.yaml</code> 下找到对应语言的文件，在属性 footer 下添加相应字段，结果如下:</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">footer:</span></span><br><span class="line">    <span class="comment"># 本博客已稳定运行1天2小时3分钟</span></span><br><span class="line">    <span class="attr">runtime1:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">本博客已稳定运行</span></span><br><span class="line">    <span class="attr">runtime2:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">天</span></span><br><span class="line">    <span class="attr">runtime3:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">小时</span></span><br><span class="line">    <span class="attr">runtime4:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">分钟</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 共发表x篇文章，总计y k字</span></span><br><span class="line">    <span class="attr">count1:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">共发表</span></span><br><span class="line">    <span class="attr">count2:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">篇文章</span> <span class="string">·</span> <span class="string">总计</span></span><br><span class="line">    <span class="attr">count3:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">字</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 本站总访问量X次</span></span><br><span class="line">    <span class="attr">pv1:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">本站总访问量</span></span><br><span class="line">    <span class="attr">pv2:</span></span><br><span class="line">        <span class="attr">other:</span> <span class="string">次</span></span><br></pre></td></tr></table></figure><p><a id="visitor-map"></a></p><h3 id="2-🗺️-添加访客地图">2. 🗺️ 添加访客地图</h3><ul><li>✨ <strong>功能</strong>：在右侧边栏添加访客地图，可视化显示访问来源</li><li>📌 <strong>位置</strong>：在根目录<code>./layouts/partials/sidebar/right.html</code> 添加后完整代码如下：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;- $scope := default &quot;homepage&quot; .Scope -&#125;&#125;</span><br><span class="line">&#123;&#123;- $context := .Context -&#125;&#125;</span><br><span class="line">&#123;&#123;- with (index .Context.Site.Params.widgets $scope) -&#125;&#125;</span><br><span class="line">    <span class="tag">&lt;<span class="name">aside</span> <span class="attr">class</span>=<span class="string">&quot;sidebar right-sidebar sticky&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; range $widget := . &#125;&#125;</span><br><span class="line">            &#123;&#123; if templates.Exists (printf &quot;partials/widget/%s.html&quot; .type) &#125;&#125;</span><br><span class="line">                &#123;&#123; partial (printf &quot;widget/%s&quot; .type) (dict &quot;Context&quot; $context &quot;Params&quot; .params) &#125;&#125;</span><br><span class="line">            &#123;&#123; else &#125;&#125;</span><br><span class="line">                &#123;&#123; warnf &quot;Widget %s not found&quot; .type &#125;&#125;</span><br><span class="line">            &#123;&#123; end &#125;&#125;</span><br><span class="line">        &#123;&#123; end &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;height: 30%;width: 30%&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">id</span>=<span class="string">&quot;clstr_globe&quot;</span> <span class="attr">src</span>=<span class="string">&quot;//clustrmaps.com/globe.js?d=xxxxx&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">aside</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure><p><a id="custom-cursor"></a></p><h3 id="3-🖱️-鼠标样式">3. 🖱️ 鼠标样式</h3><ul><li>✨ <strong>功能</strong>：自定义鼠标指针样式，增强博客个性化</li><li>📌 <strong>说明</strong>：准备好鼠标样式图片(默认，指针，文本…)，图片大小建议控制在 32px 左右，将.png图片放入<code>static/mouse</code>文件夹下(文件夹自己创建)<br>修改对应的图片名即可</li><li>📌 <strong>位置</strong>：修改<code>./assets/scss/custom.scss</code>(文件不存在则自己创建)，将以下代码复制进去，根据主题按实际情况填写对应的css选择器</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 【Stack主题鼠标样式写法】</span></span><br><span class="line"><span class="comment">// default光标图片</span></span><br><span class="line"><span class="selector-tag">body</span>,</span><br><span class="line"><span class="selector-tag">html</span>,</span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: <span class="built_in">url</span>(../mouse/default.png),</span><br><span class="line">  auto <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// pointer光标图片</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-tag">button</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.copyCodeButton</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-id">#dark-mode-toggle</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: <span class="built_in">url</span>(../mouse/pointer.png),</span><br><span class="line">  auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// text光标图片</span></span><br><span class="line"><span class="selector-tag">input</span><span class="selector-pseudo">:hover</span>,</span><br><span class="line"><span class="selector-class">.site-description</span>,</span><br><span class="line"><span class="selector-class">.article-subtitle</span>,</span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-tag">span</span>,</span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-tag">li</span>,</span><br><span class="line"><span class="selector-class">.article-content</span> <span class="selector-tag">p</span> &#123;</span><br><span class="line">  <span class="attribute">cursor</span>: <span class="built_in">url</span>(../mouse/text.png),</span><br><span class="line">  auto;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*主页布局间距调整*/</span></span><br><span class="line"><span class="selector-class">.main-container</span> &#123;</span><br><span class="line">  <span class="attribute">gap</span>: <span class="number">50px</span>; <span class="comment">//文章宽度</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">@include</span> respond(md) &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">30px</span>;</span><br><span class="line">    <span class="attribute">gap</span>: <span class="number">40px</span>; <span class="comment">//中等屏幕时的文章宽度</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.related-contents</span> &#123;</span><br><span class="line">  <span class="attribute">overflow-x</span>: visible; <span class="comment">//显示隐藏的图标</span></span><br><span class="line">  <span class="attribute">padding-bottom</span>: <span class="number">15px</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="welcome-banner"></a></p><h3 id="4-🎉-首页欢迎横幅">4. 🎉 首页欢迎横幅</h3><ul><li>✨ <strong>功能</strong>：在首页顶部添加动态欢迎横幅，增强用户体验</li><li>📌 <strong>位置</strong>：在 <code>./layouts/index.html</code>的 <code>&lt;section class=&quot;article-list&quot;&gt;</code> 前添加以下代码：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 首页欢迎字幅 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;welcome&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;font-size: 2rem; text-align: center; font-weight: bold&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;shake&quot;</span>&gt;</span>👋<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text1&quot;</span> &gt;</span> Welcome<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text2&quot;</span>&gt;</span> To <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text3&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>Xa<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text4&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>l<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text5&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>a<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text6&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>o<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text7&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>k<span class="tag">&lt;/<span class="name">span</span>&gt;</span><span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text8&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>&#x27;s<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;jump-text9&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:#e99312&quot;</span>&gt;</span>Blog<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 首页欢迎字幅 --&gt;</span></span><br></pre></td></tr></table></figure><ul><li>📌 <strong>位置</strong>：在 <code>./assets/scss/custom.scss</code> 中加入以下代码：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// ----------------首页欢迎板块样式----------------</span></span><br><span class="line"><span class="selector-class">.welcome</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--card-text-color-main);</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--card-background);</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--shadow-l2);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">30px</span>;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 👋emoji实现摆动效果</span></span><br><span class="line"><span class="selector-class">.shake</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: shake <span class="number">1s</span>;</span><br><span class="line">  <span class="attribute">animation-duration</span>: <span class="number">1s</span>;</span><br><span class="line">  <span class="attribute">animation-timing-function</span>: ease;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0s</span>;</span><br><span class="line">  <span class="attribute">animation-iteration-count</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-direction</span>: normal;</span><br><span class="line">  <span class="attribute">animation-fill-mode</span>: none;</span><br><span class="line">  <span class="attribute">animation-play-state</span>: running;</span><br><span class="line">  <span class="attribute">animation-name</span>: shake;</span><br><span class="line">  <span class="attribute">animation-timeline</span>: auto;</span><br><span class="line">  <span class="attribute">animation-range-start</span>: normal;</span><br><span class="line">  <span class="attribute">animation-range-end</span>: normal;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">2s</span>;</span><br><span class="line">  <span class="keyword">@keyframes</span> shake &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">25%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="built_in">scale</span>(<span class="number">1.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>) <span class="built_in">scale</span>(<span class="number">1.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">75%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>) <span class="built_in">scale</span>(<span class="number">1.2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 实现字符跳动动画</span></span><br><span class="line"><span class="selector-class">.jump-text1</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text2</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text3</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.2s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text4</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text5</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.4s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text6</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text7</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.6s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text8</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.7s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.jump-text9</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">animation</span>: jump <span class="number">0.5s</span> <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">animation-delay</span>: <span class="number">0.9s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> jump &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">50%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">20px</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a id="remove-footer"></a></p><h3 id="5-🗑️-删除-使用-Hugo-构建-主题Stack由Jimmy设计-等字样">5. 🗑️ 删除&quot;使用 Hugo 构建 主题Stack由Jimmy设计&quot;等字样</h3><ul><li>✨ <strong>功能</strong>：移除页脚默认的版权信息，替换为自定义内容</li><li>📌 <strong>位置</strong>：删除掉<code>./layout/partials/footer/footer.html</code> 原先的代码，注意是 <section class="powerby"> 里边的</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;- $ThemeVersion := &quot;3.29.0&quot; -&#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;site-footer&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;copyright&quot;</span>&gt;</span></span><br><span class="line">        <span class="symbol">&amp;copy;</span> </span><br><span class="line">        &#123;&#123; if and (.Site.Params.footer.since) (ne .Site.Params.footer.since (int (now.Format &quot;2006&quot;))) &#125;&#125;</span><br><span class="line">            &#123;&#123; .Site.Params.footer.since &#125;&#125; - </span><br><span class="line">        &#123;&#123; end &#125;&#125;</span><br><span class="line">        &#123;&#123; now.Format &quot;2006&quot; &#125;&#125; &#123;&#123; default .Site.Title .Site.Copyright &#125;&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!------------- 以下的删除掉 -------------&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">section</span> <span class="attr">class</span>=<span class="string">&quot;powerby&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; with .Site.Params.footer.customText &#125;&#125;</span><br><span class="line">            &#123;&#123; . | safeHTML &#125;&#125; <span class="tag">&lt;<span class="name">br</span>/&gt;</span></span><br><span class="line">        &#123;&#123; end &#125;&#125;</span><br><span class="line"></span><br><span class="line">        &#123;&#123;- $Generator := `<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://gohugo.io/&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;noopener&quot;</span>&gt;</span>Hugo<span class="tag">&lt;/<span class="name">a</span>&gt;</span>` -&#125;&#125;</span><br><span class="line">        &#123;&#123;- $Theme := printf `<span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://github.com/CaiJimmy/hugo-theme-stack&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;noopener&quot;</span> <span class="attr">data-version</span>=<span class="string">&quot;%s&quot;</span>&gt;</span>Stack<span class="tag">&lt;/<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span>` $ThemeVersion -&#125;&#125;</span><br><span class="line">        &#123;&#123;- $DesignedBy := `<span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;https://jimmycai.com&quot;</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;noopener&quot;</span>&gt;</span>Jimmy<span class="tag">&lt;/<span class="name">a</span>&gt;</span>` -&#125;&#125;</span><br><span class="line"></span><br><span class="line">        &#123;&#123; T &quot;footer.builtWith&quot; (dict &quot;Generator&quot; $Generator) | safeHTML &#125;&#125; <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">        &#123;&#123; T &quot;footer.designedBy&quot; (dict &quot;Theme&quot; $Theme &quot;DesignedBy&quot; $DesignedBy) | safeHTML &#125;&#125;</span><br><span class="line"></span><br><span class="line">        &#123;&#123; $articleCount := len .Site.RegularPages &#125;&#125;</span><br><span class="line">        &#123;&#123; $totalWordCount := 0 &#125;&#125;</span><br><span class="line">        &#123;&#123; range .Site.Pages &#125;&#125;</span><br><span class="line">        &#123;&#123; $totalWordCount = add $totalWordCount .WordCount &#125;&#125;</span><br><span class="line">        &#123;&#123; end &#125;&#125;</span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">p</span>&gt;</span>发布了 &#123;&#123; $articleCount &#125;&#125; 篇文章 | 共 &#123;&#123;$totalWordCount&#125;&#125; 字<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">section</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!------------- 以上的删除掉 -------------&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a id="back-to-top"></a></p><h3 id="6-⬆️-添加【返回顶部】按钮">6. ⬆️ 添加【返回顶部】按钮</h3><ul><li>✨ <strong>功能</strong>：添加平滑滚动返回顶部的按钮，提升用户体验</li><li>📌 <strong>步骤</strong>：<ol><li>返回顶部图片，复制以下代码保存为<code>.svg</code>文件,放到<code>./assets/icons</code>文件夹下(不存在则自行创建)</li></ol></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">svg</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.w3.org/2000/svg&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30&quot;</span> <span class="attr">height</span>=<span class="string">&quot;30&quot;</span> <span class="attr">viewBox</span>=<span class="string">&quot;0 0 24 24&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span> <span class="attr">stroke</span>=<span class="string">&quot;#707070&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">stroke-width</span>=<span class="string">&quot;2&quot;</span> <span class="attr">stroke-linecap</span>=<span class="string">&quot;round&quot;</span> <span class="attr">stroke-linejoin</span>=<span class="string">&quot;round&quot;</span></span></span><br><span class="line"><span class="tag">     <span class="attr">class</span>=<span class="string">&quot;icon icon-tabler icons-tabler-outline icon-tabler-square-rounded-arrow-up&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">stroke</span>=<span class="string">&quot;none&quot;</span> <span class="attr">d</span>=<span class="string">&quot;M0 0h24v24H0z&quot;</span> <span class="attr">fill</span>=<span class="string">&quot;none&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M16 12l-4 -4l-4 4&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M12 16v-8&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">path</span> <span class="attr">d</span>=<span class="string">&quot;M12 3c7.2 0 9 1.8 9 9s-1.8 9 -9 9s-9 -1.8 -9 -9s1.8 -9 9 -9z&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>将以下代码复制到<code>layouts/partials/footer/custom.html</code>文件中(不存在则自行创建)</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- layouts/partials/footer/custom.html --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 返回顶部按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#backTopBtn</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">bottom</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">z-index</span>: <span class="number">99</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">height</span>: <span class="number">30px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#123;&#123; (resources.Get &quot;icons/backTop.svg&quot;</span>).RelPermalink &#125;&#125;);</span></span><br><span class="line"><span class="language-css">      <span class="comment">/* 为 transform 属性添加过渡效果，持续时间 1 秒，过渡方式为缓入缓出 */</span></span></span><br><span class="line"><span class="language-css">      <span class="attribute">transition</span>: transform <span class="number">1s</span> ease-in-out;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">    </span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#backTopBtn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 悬停时360度旋转 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">   * 滚动回顶部初始化</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">   */</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">initScrollTop</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> rightSideBar = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.right-sidebar&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!rightSideBar) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 添加返回顶部按钮到右侧边栏</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="property">id</span> = <span class="string">&quot;backTopBtn&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="property">onclick</span> = backToTop</span></span><br><span class="line"><span class="language-javascript">      rightSideBar.<span class="title function_">appendChild</span>(btn)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 滚动监听</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">onscroll</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 当网页向下滑动 20px 出现&quot;返回顶部&quot; 按钮</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span> &gt; <span class="number">20</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> &gt; <span class="number">20</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              btn.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              btn.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">   * 返回顶部</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">   */</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">backToTop</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(&#123; <span class="attr">top</span>: <span class="number">0</span>, <span class="attr">behavior</span>: <span class="string">&quot;smooth&quot;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">initScrollTop</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="3"><li>我使用中的</li></ol><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#backTopBtn</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">100px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 新增右侧定位 */</span></span></span><br><span class="line"><span class="language-css">    <span class="comment">/* right: 480px; */</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">99</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">cursor</span>: pointer;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">40px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-image</span>: <span class="built_in">url</span>(<span class="string">&#123;&#123; (resources.Get &quot;icons/backTop.svg&quot;</span>).RelPermalink &#125;&#125;);</span></span><br><span class="line"><span class="language-css">    <span class="comment">/* 添加will-change优化渲染性能 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">will-change</span>: transform;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: transform <span class="number">1s</span> ease-in-out;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#backTopBtn</span><span class="selector-pseudo">:hover</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * 滚动回顶部初始化</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     */</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">initScrollTop</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> rightSideBar = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.right-sidebar&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!rightSideBar) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 添加返回顶部按钮到右侧边栏</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> btn = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;div&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="property">id</span> = <span class="string">&quot;backTopBtn&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      btn.<span class="property">onclick</span> = backToTop</span></span><br><span class="line"><span class="language-javascript">      rightSideBar.<span class="title function_">appendChild</span>(btn)</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 滚动监听</span></span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="property">onscroll</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 统一获取页面滚动高度</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> scrollTop = <span class="variable language_">window</span>.<span class="property">pageYOffset</span> || <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">scrollTop</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">scrollTop</span> || <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 当网页向下滑动 20px 出现&quot;返回顶部&quot; 按钮</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (scrollTop &gt; <span class="number">20</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          btn.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          btn.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">/**</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     * 返回顶部</span></span></span><br><span class="line"><span class="comment"><span class="language-javascript">     */</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">backToTop</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(&#123; <span class="attr">top</span>: <span class="number">0</span>, <span class="attr">behavior</span>: <span class="string">&quot;smooth&quot;</span> &#125;)</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">initScrollTop</span>();</span></span><br><span class="line"><span class="language-javascript">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ol start="4"><li>解决 PJAX 刷新问题</li></ol><ul><li>📌 <strong>位置</strong>：编辑<code>.\layouts\partials\footer\pjax.html</code>文件 。<code>pjax:complete</code> 事件下，添加以下内容：</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 重新初始化返回顶部按钮</span></span><br><span class="line">topbar.<span class="title function_">hide</span>();</span><br><span class="line">       <span class="title function_">initScrollTop</span>();</span><br></pre></td></tr></table></figure><p><a id="comments"></a></p><h2 id="五、💬-Hugo-接入评论">五、💬 Hugo 接入评论</h2><h3 id="1、GitHub-打开评论">1、GitHub 打开评论</h3><ul><li>✨ <strong>功能</strong>：启用GitHub Discussions作为博客评论系统</li><li>📌 <strong>步骤</strong>：首先进入【<a href="https://github.com/">GitHub</a>】，hugo 博客项目主页–&gt;&gt;项目设置–&gt;&gt;找到Discussions Loading</li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/giscus-001.jpg" alt=""></p><h3 id="2、giscus-配置">2、giscus 配置</h3><ul><li>✨ <strong>功能</strong>：安装并配置giscus评论系统</li><li>📌 <strong>步骤</strong>：在 github 上安装 【<a href="https://github.com/apps/giscus">giscus APP</a>】</li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/giscus-002.jpg" alt=""></p><h3 id="3、GitHub-博客项目接入-giscus">3、GitHub 博客项目接入 giscus</h3><ul><li>✨ <strong>功能</strong>：将giscus与GitHub博客项目连接</li><li>📌 <strong>步骤</strong>：<br><img src="https://file.meimolihan.eu.org/screenshot/giscus-005.webp" alt=""></li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/giscus-003.jpg" alt=""></p><ul><li>随着官网的说明一步步配置下去。配置完成后便可在 启用 giscus 下找到需要的代码：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://giscus.app/client.js&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-repo</span>=<span class="string">&quot;meimolihan/meimolihan.github.io&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-repo-id</span>=<span class="string">&quot;R_kgDONpRkKg&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-category</span>=<span class="string">&quot;Announcements&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-category-id</span>=<span class="string">&quot;DIC_kwDONpRkKs4CmwSa&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-mapping</span>=<span class="string">&quot;pathname&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-strict</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-reactions-enabled</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-emit-metadata</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-input-position</span>=<span class="string">&quot;bottom&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-theme</span>=<span class="string">&quot;dark&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">data-lang</span>=<span class="string">&quot;zh-CN&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">crossorigin</span>=<span class="string">&quot;anonymous&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">async</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4、修改-hugo-主配置文件">4、修改 hugo 主配置文件</h3><ul><li>✨ <strong>功能</strong>：在Hugo配置中启用giscus评论系统</li><li>📌 <strong>位置</strong>：我使用的是Hugo的stack主题，需要在 config.yaml 中设置</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">comments:</span></span><br><span class="line">  <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">provider:</span> <span class="string">giscus</span></span><br></pre></td></tr></table></figure><h3 id="5、引入-giscus-js文件">5、引入 giscus-js文件</h3><ul><li>✨ <strong>功能</strong>：将giscus JavaScript文件引入到主题中</li><li>📌 <strong>步骤</strong>：将stack主题<code>./themes/hugo-theme-stack/layouts/partials/comments/provider/giscus.html</code>文件拷贝至<code>./layouts/partials/comments/provider/</code>目录下  (需新建)</li><li>然后将giscus-js代码放到下面的位置：</li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/giscus-004.jpg" alt=""></p><h3 id="6、文章-index-md-打开评论">6、文章 <a href="http://index.md">index.md</a> 打开评论</h3><ul><li>✨ <strong>功能</strong>：控制每篇文章是否开启评论功能</li><li>📌 <strong>位置</strong>：<strong>false 关闭评论，true 显示评论。</strong></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">comments:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="7、引入-Pjax-后的评论修复">7、引入 Pjax 后的评论修复</h3><ul><li><strong>修改<code>layouts/partials/comments/include.html</code>，添加一个元素标识，方便判断文章是否开启了评论</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; if .Site.Params.comments.enabled &#125;&#125;</span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;comment&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>创建 <code>layouts/partials/footer/giscusPjax.html</code> ，引入以下代码</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;- with .Site.Params.comments.giscus -&#125;&#125;</span><br><span class="line">  &lt;div class=<span class="string">&quot;js-Pjax&quot;</span>&gt;</span><br><span class="line">    &lt;script&gt;</span><br><span class="line">      (<span class="function"><span class="title">function</span></span> () &#123;</span><br><span class="line">        <span class="built_in">let</span> comment = document.querySelector(<span class="string">&quot;.comment&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (!comment) &#123;</span><br><span class="line">          <span class="built_in">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">let</span> script = document.createElement(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">        script.src = <span class="string">&#x27;https://giscus.app/client.js&#x27;</span>;</span><br><span class="line">        script.crossOrigin = <span class="string">&#x27;anonymous&#x27;</span>;</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-repo&#x27;</span>,<span class="string">&quot;meimolihan/meimolihan.github.io&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-repo-id&#x27;</span>,<span class="string">&quot;R_kgDONpRkKg&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-category&#x27;</span>,<span class="string">&quot;Announcements&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-category-id&#x27;</span>,<span class="string">&quot;DIC_kwDONpRkKs4CmwSa&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-mapping&#x27;</span>,<span class="string">&quot;pathname&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-strict&#x27;</span>, 0 );</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-reactions-enabled&#x27;</span>, 1 );</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-emit-metadata&#x27;</span>, 0 );</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-input-position&#x27;</span>,<span class="string">&quot;top&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-theme&#x27;</span>,<span class="string">&quot;light&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-lang&#x27;</span>,<span class="string">&quot;zh-CN&quot;</span>);</span><br><span class="line">        script.setAttribute(<span class="string">&#x27;data-loading&#x27;</span>, <span class="string">&#x27;lazy&#x27;</span>)</span><br><span class="line">        script.async = <span class="literal">true</span>;</span><br><span class="line">        document.querySelector(<span class="string">&#x27;.site-footer&#x27;</span>).before(script)</span><br><span class="line">      &#125;)(document);</span><br><span class="line">    &lt;/script&gt;</span><br><span class="line">    &lt;div&gt;</span><br><span class="line">&#123;&#123;- end -&#125;&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>在<code>layouts/partials/footer/custom.html</code>，引入 <code>giscusPjax.html</code></strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; partial &quot;footer/giscusPjax.html&quot; . &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>配置完成，<code>hugo server -D</code>启动hugo，在本地就可以看到效果。</li></ul><p><a id="preload-animation"></a></p><h2 id="六、🌀-Hugo-预加载动画">六、🌀 Hugo 预加载动画</h2><p><img src="https://file.meimolihan.eu.org/gif/%E5%BC%80%E5%B1%8F%E5%8A%A8%E7%94%BB.gif" alt=""></p><h3 id="1、新增组件">1、新增组件</h3><ul><li>✨ <strong>功能</strong>：添加页面加载时的预加载动画，提升用户体验</li><li>📌 <strong>位置</strong>：小组件放在<code>layouts/partials/widget/preload.html</code> 文件里，注意，这个文件是自己创建的：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; if .Site.Params.enablePreloadingAnim &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;loading-box&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 页面加载完成之后帷幕拉开的效果 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading-left-bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading-right-bg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 旋转盒子动效 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;spinner-box&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;configure-border-1&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;configure-core&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;configure-border-2&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;configure-core&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading-word&quot;</span>&gt;</span>加载中...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 页面加载动画 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 确保 jQuery 已加载</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (<span class="keyword">typeof</span> $ !== <span class="string">&#x27;function&#x27;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;jQuery is not loaded. Please ensure jQuery is included in your project.&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 使用 window.onload 确保所有资源加载完成后隐藏动画</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> loadingBox = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;loading-box&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (loadingBox) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 延时一段时间以确保动画有足够的时间展示</span></span></span><br><span class="line"><span class="language-javascript">            <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">                loadingBox.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;loaded&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Preloader hidden after all resources are loaded.&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;, <span class="number">500</span>); <span class="comment">// 延时 0.5 秒（可根据需要调整）</span></span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Preloader element not found!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果需要显示加载进度，可以添加以下逻辑（可选）</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> loadedResources = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> totalResources = <span class="variable language_">document</span>.<span class="property">images</span>.<span class="property">length</span> + <span class="variable language_">document</span>.<span class="property">styleSheets</span>.<span class="property">length</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">checkResourceLoad</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        loadedResources++;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> progress = <span class="title class_">Math</span>.<span class="title function_">round</span>((loadedResources / totalResources) * <span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> loadingWord = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.loading-word&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (loadingWord) &#123;</span></span><br><span class="line"><span class="language-javascript">            loadingWord.<span class="property">textContent</span> = <span class="string">`加载中... <span class="subst">$&#123;progress&#125;</span>%`</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (loadedResources &gt;= totalResources) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">window</span>.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;load&#x27;</span>)); <span class="comment">// 手动触发 load 事件</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 监听图片加载</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">images</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">img</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        img.<span class="title function_">addEventListener</span>(<span class="string">&#x27;load&#x27;</span>, checkResourceLoad);</span></span><br><span class="line"><span class="language-javascript">        img.<span class="title function_">addEventListener</span>(<span class="string">&#x27;error&#x27;</span>, checkResourceLoad);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 监听样式表加载</span></span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">document</span>.<span class="property">styleSheets</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">sheet</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">checkResourceLoad</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="2、组件样式">2、组件样式</h3><ul><li>✨ <strong>功能</strong>：定义预加载动画的样式和动画效果</li><li>📌 <strong>位置</strong>：找到 <code>./assets/scss/custom.scss</code> 在文件里面追加 ：</li></ul><figure class="highlight scss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.loading-left-bg</span>,</span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.loading-right-bg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1000</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="comment">// 我在这里小改了一下颜色，</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#b1c0c7</span>;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.5s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.loading-right-bg</span> &#123;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span>&gt;<span class="selector-class">.spinner-box</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1001</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.spinner-box</span> <span class="selector-class">.configure-border-1</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">115px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">115px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ffab91</span>;</span><br><span class="line">    <span class="attribute">animation</span>: configure-clockwise <span class="number">3s</span> ease-in-out <span class="number">0s</span> infinite alternate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.spinner-box</span> <span class="selector-class">.configure-border-2</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">115px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">3px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">115px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">115px</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgb</span>(<span class="number">63</span>, <span class="number">249</span>, <span class="number">220</span>);</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    <span class="attribute">animation</span>: configure-xclockwise <span class="number">3s</span> ease-in-out <span class="number">0s</span> infinite alternate;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.spinner-box</span> <span class="selector-class">.loading-word</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span><br><span class="line">    <span class="comment">// 我在这里小改了一下文字大小和字体，注意！</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">1.8rem</span>;</span><br><span class="line">    <span class="attribute">font-family</span>: <span class="string">&#x27;Zhi Mang Xing&#x27;</span>, cursive;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#loading-box</span> <span class="selector-class">.spinner-box</span> <span class="selector-class">.configure-core</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#37474f</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.loaded</span> <span class="selector-tag">div</span><span class="selector-class">.loading-left-bg</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">100%</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.loaded</span> <span class="selector-tag">div</span><span class="selector-class">.loading-right-bg</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(<span class="number">100%</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.loaded</span> <span class="selector-tag">div</span><span class="selector-class">.spinner-box</span> &#123;</span><br><span class="line">    <span class="comment">// 你可以把这个注释掉，这样就能一直看那个动画的效果了！</span></span><br><span class="line">    <span class="attribute">display</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> configure-clockwise &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">25%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">90deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">180deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">75%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">270deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> configure-xclockwise &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">45deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">25%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">45deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">50%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">135deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">75%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">225deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="number">100%</span> &#123;</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">315deg</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、配置文件">3、配置文件</h3><ul><li>✨ <strong>功能</strong>：通过配置文件控制预加载动画的开启与关闭</li><li>📌 <strong>位置</strong>：hugo配置文件<code>params</code> 栏目底下，加上 <code>enablePreloadingAnim: true</code></li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">params:</span></span><br><span class="line">    <span class="attr">enablePreloadingAnim:</span> <span class="literal">true</span> <span class="comment"># 开屏动画，false为关闭，true为开启</span></span><br></pre></td></tr></table></figure><p><a id="image-lightbox"></a></p><h2 id="七、🖼️-Hugo-图片灯箱">七、🖼️ Hugo 图片灯箱</h2><p><img src="https://file.meimolihan.eu.org/2d/2d-001.jpg" alt=""></p><ul><li>✨ <strong>功能</strong>：使用 Fancybox 实现图片灯箱/放大功能</li><li>📌 <strong>说明</strong>：Hugo 自带的图片渲染是没有灯箱效果的，所以我们需要自己添加。灯箱效果就是点击图片后，图片会放大显示。</li></ul><h3 id="修改-Hugo-配置文件">修改 Hugo 配置文件</h3><ul><li>✨ <strong>功能</strong>：在配置中启用图片灯箱功能</li><li>📌 <strong>位置</strong>：修改网站根目录下的 config.toml 或者 config.yaml 文件，我的配置文件为 yaml 格式，toml 需要自行调整格式，在 params参数下添加以下内容：</li></ul><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">params:</span></span><br><span class="line">    <span class="attr">fancybox:</span> <span class="literal">true</span> <span class="comment"># 图片灯箱，false为关闭，true为开启</span></span><br></pre></td></tr></table></figure><h3 id="创建-render-image-html-文件">创建 render-image.html 文件</h3><ul><li>✨ <strong>功能</strong>：创建图片渲染模板，支持灯箱效果</li><li>📌 <strong>位置</strong>：在你的 Hugo 根目录下创建以下路径和文件：<code>./layouts/_default/_markup/render-image.html</code></li><li>编辑 <code>render-image.html</code> 添加以下内容：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;if .Page.Site.Params.fancybox &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;post-img-view&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">data-fancybox</span>=<span class="string">&quot;gallery&quot;</span> <span class="attr">href</span>=<span class="string">&quot;&#123;&#123; .Destination | safeURL &#125;&#125;&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;&#123;&#123; .Destination | safeURL &#125;&#125;&quot;</span> <span class="attr">alt</span>=<span class="string">&quot;&#123;&#123; .Text &#125;&#125;&quot;</span> &#123;&#123; <span class="attr">with</span> <span class="attr">.Title</span>&#125;&#125; <span class="attr">title</span>=<span class="string">&quot;&#123;&#123; . &#125;&#125;&quot;</span>&#123;&#123; <span class="attr">end</span> &#125;&#125; /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure><h3 id="复制-custom-html-文件">复制 custom.html 文件</h3><ul><li>✨ <strong>功能</strong>：引入Fancybox所需的CSS和JavaScript文件</li><li>📌 <strong>位置</strong>：从你主题目录 <code>./themes/stack/layouts/partials/footer/custom.html</code>复制到 Hugo在你根目录 <code>layouts/partials/footer/custom.html</code> ,添加以下内容：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123;if .Page.Site.Params.fancybox &#125;&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#123;&#123; end &#125;&#125;</span><br></pre></td></tr></table></figure><p>接下来就可以直接 <code>hugo server -D</code> 看看效果了。</p><hr><p><a id="particles-background"></a></p><h2 id="八、✨-引入动态背景">八、✨ 引入动态背景</h2><ul><li>✨ <strong>功能</strong>：为博客添加动态粒子背景效果，增强视觉吸引力</li><li>📌 <strong>来源</strong>：<a href="https://letere-gzj.github.io/hugo-stack/p/hugo/custom-background/#22-%E7%82%B9%E7%BA%BF%E6%BC%82%E6%B5%AEparticlesjs">莱特雷-letere</a></li><li>📌 <strong>文档</strong>：【<a href="https://github.com/VincentGarreau/particles.js">particles.js文档</a>】</li></ul><h3 id="1-前往【配置页面】配置参数">1.  前往【配置页面】配置参数</h3><ul><li>✨ <strong>功能</strong>：自定义粒子效果参数</li><li>📌 <strong>步骤</strong>：前往【<a href="http://vincentgarreau.com/particles.js/">配置页面</a>】配置参数，参数按自己喜好即可，唯一注意要修改的参数是 detect_on，要改成 window</li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/particles-001.png" alt=""></p><h3 id="2-下载配置文件，以及-particles-js-所需要的js文件">2. 下载配置文件，以及 particles.js 所需要的js文件</h3><ul><li>✨ <strong>功能</strong>：获取粒子效果所需的配置文件</li><li>📌 <strong>步骤</strong>：下载【<a href="https://letere-gzj.github.io/hugo-stack/p/hugo/custom-background/particlesjs-config.json">particlesjs-config.json</a>】(Ctrl + S 保存)，本博客的动态背景json配置，有需求的可直接下载</li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/particles-002.png" alt=""></p><h3 id="3-把下载好的文件，解压并将以下两个文件放到assets-background文件夹下">3. 把下载好的文件，解压并将以下两个文件放到assets/background文件夹下</h3><ul><li>✨ <strong>功能</strong>：放置粒子效果所需文件</li><li>📌 <strong>文件</strong>：<ul><li>particlesjs-config.json</li><li>particles.min.js</li></ul></li></ul><p><img src="https://file.meimolihan.eu.org/screenshot/particles-003.png" alt=""></p><h3 id="4-在layouts-partials-footer-custom-html中，引入以下代码">4. 在layouts/partials/footer/custom.html中，引入以下代码</h3><ul><li>✨ <strong>功能</strong>：在页面中引入并初始化粒子效果</li><li>📌 <strong>位置</strong>：</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;particles-js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&#123;&#123;</span> (<span class="attr">resources.Get</span> &quot;<span class="attr">background</span>/<span class="attr">particles.min.js</span>&quot;)<span class="attr">.Permalink</span> &#125;&#125;&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  particlesJS.<span class="title function_">load</span>(<span class="string">&#x27;particles-js&#x27;</span>, &#123;&#123; (resources.<span class="property">Get</span> <span class="string">&quot;background/particlesjs-config.json&quot;</span>).<span class="property">Permalink</span> &#125;&#125;, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;particles.js loaded - callback&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-id">#particles-js</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: fixed;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: -<span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><hr><p><a id="view-count"></a></p><h2 id="八、📊-博客文章浏览数统计">八、📊 博客文章浏览数统计</h2><ul><li>✨ <strong>功能</strong>：引入第三方组件，来给博客文章统计浏览数</li><li>📌 <strong>前言</strong>：</li></ul><blockquote><ul><li>博客文章统计组件个人找到了两个，分别是<a href="https://busuanzi.ibruce.info/"><strong>不蒜子</strong></a>，以及<a href="https://cn.vercount.one/"><strong>vercount</strong></a></li><li><strong>不蒜子</strong>比较老，但很稳定，到现在仍然可以使用，没有停服</li><li><strong>vercount</strong>则比较新，并做了一些代码优化</li><li>两种使用都基本一样，差别不大，看自己喜好，下面的教程是以<strong>vercount</strong>来举例，用不蒜子的话，就把对应的脚本和元素标签替换一下就好</li></ul></blockquote><h3 id="1-基本引入">1 基本引入</h3><ul><li>（1）修改<code>layouts/partials/footer/custom.html</code>（不存在则自行创建），引入脚本</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- vercount的脚本；若用不蒜子，则更换成不蒜子的脚本就好 --&gt;</span> <span class="tag">&lt;<span class="name">script</span> <span class="attr">defer</span> <span class="attr">src</span>=<span class="string">&quot;https://cn.vercount.one/js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span> </span><br></pre></td></tr></table></figure><ul><li><p>（2）准备一张<a href="https://letere-gzj.github.io/hugo-stack/p/hugo/view-count/eye.svg"><strong>浏览量</strong></a>的icon(Ctrl+S保存)，放到<code>assets/icons</code>文件夹下</p></li><li><p>（3）修改<code>layouts/article/components/details.html</code>，在合适的位置下加入以下代码</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;article-details&quot;</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line">    <span class="tag">&lt;<span class="name">footer</span> <span class="attr">class</span>=<span class="string">&quot;article-time&quot;</span>&gt;</span></span><br><span class="line">        ...</span><br><span class="line">        <span class="comment">&lt;!-- 浏览量统计 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;viewCount&quot;</span>&gt;</span></span><br><span class="line">            &#123;&#123; partial &quot;helper/icon&quot; &quot;eye&quot; &#125;&#125;</span><br><span class="line">            <span class="tag">&lt;<span class="name">time</span> <span class="attr">class</span>=<span class="string">&quot;article-time--reading&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!-- vercount统计当前页面浏览数的标签；若用不蒜子，更换成不蒜子对应的标签就好 --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span> <span class="attr">id</span>=<span class="string">&quot;vercount_value_page_pv&quot;</span>&gt;</span>loading... <span class="tag">&lt;/<span class="name">span</span>&gt;</span>次</span><br><span class="line">            <span class="tag">&lt;/<span class="name">time</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></span><br><span class="line">    ...</span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>（4）这样文章详情的开头就显示浏览数了</li></ul><p><a href="https://letere-gzj.github.io/hugo-stack/p/hugo/view-count/%E7%BB%9F%E8%AE%A1%E5%B1%95%E7%A4%BA.png"><img src="https://letere-gzj.github.io/hugo-stack/p/hugo/view-count/%E7%BB%9F%E8%AE%A1%E5%B1%95%E7%A4%BA.png" alt="img"></a></p><h3 id="2-问题修复">2 问题修复</h3><ul><li>问题描述：<ul><li>博客首页的文章列表显示了浏览数，且只有第一篇文章才有浏览数，并且浏览数的数字不正确</li></ul></li></ul><p><a href="https://letere-gzj.github.io/hugo-stack/p/hugo/view-count/%E7%BB%9F%E8%AE%A1%E4%BF%AE%E5%A4%8D1.png"><img src="https://letere-gzj.github.io/hugo-stack/p/hugo/view-count/%E7%BB%9F%E8%AE%A1%E4%BF%AE%E5%A4%8D1.png" alt="img"></a></p><ul><li><p>产生原因：</p><ul><li><code>layouts/partials/article/components/details.html</code>此html文件也被用在了博客首页的文章列表，所以也触发了vercount读取当前页面的浏览数</li><li>因为读取的数据是当前页面的浏览数，也就是首页的浏览数，并非文章的浏览数，所以数据只加载一次，且不准确</li></ul></li><li><p>解决思路：</p><ul><li>由于vercount并未提供<code>只查询文章浏览数</code>的接口，只有一个<code>文章浏览数+1，并且返回浏览数</code>的接口，所以无法实现首页对每篇文章的浏览数的单独查询</li><li>既然无法实现首页展示每篇文章的单独浏览数，那就直接隐藏就好了，等点入文章才看到具体的浏览数</li></ul></li><li><p>具体操作：</p><ul><li>（1）修改<code>layouts/partials/footer/custom.html</code>，引入以下代码</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">showHideView</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 判断是否存在vercount标签</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> viewCounts = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;#viewCount&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (viewCounts) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 判断是否为文章页</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> article =  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.article-page&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (!article) &#123;</span></span><br><span class="line"><span class="language-javascript">                viewCounts.<span class="title function_">forEach</span>(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    ele.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    </span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">showHideView</span>();</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3、引入-Pjax-后浏览数修复">3、引入 Pjax 后浏览数修复</h3><ul><li><strong>创建 <code>layouts/partials/footer/vercountPjax.html</code> ，引入以下代码</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;js-Pjax&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        (<span class="keyword">function</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">            script.<span class="property">defer</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">            script.<span class="property">src</span> = <span class="string">&quot;https://cn.vercount.one/js&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> footer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;footer&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (footer) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="title function_">showHideView</span>()</span></span><br><span class="line"><span class="language-javascript">                footer.<span class="title function_">appendChild</span>(script);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)(<span class="variable language_">document</span>)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">showHideView</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">let</span> viewCounts = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;#viewCount&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (viewCounts) &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">const</span> style = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.article-page&quot;</span>) ? <span class="string">&#x27;&#x27;</span> : <span class="string">&#x27;none&#x27;</span>;</span></span><br><span class="line"><span class="language-javascript">                viewCounts.<span class="title function_">forEach</span>(<span class="function"><span class="params">ele</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                        ele.<span class="property">style</span>.<span class="property">display</span> = style;</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                )</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>在 <code>layouts/partials/footer/custom.html</code> 中引入 <code>vercountPjax.html</code></strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; partial &quot;footer/vercountPjax.html&quot; . &#125;&#125;</span><br></pre></td></tr></table></figure><ul><li>如果嫌麻烦，浏览数统计可以和更新时间一样，放到文章末尾就好，就不会显示到首页上了</li><li>具体修改<code>layouts/partials/article/footer.html</code>就好，看个人喜好吧</li></ul><p><a id="hugo-live2d"></a></p><h2 id="十、💃-博客引入看板娘">十、💃 博客引入看板娘</h2><ul><li><strong>创建 <code>layouts/partials/footer/live2d-v3.html</code> ，引入以下代码</strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> cdnPath = <span class="string">&quot;https://cdn.jsdelivr.net/gh/meimolihan/hugo-static-resource@main&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> config = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">path</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">homePath</span>: <span class="string">&quot;/&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">modelPath</span>: cdnPath + <span class="string">&quot;/live2d-moc3/&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cssPath</span>: cdnPath + <span class="string">&quot;/waifu.css&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tipsJsonPath</span>: cdnPath + <span class="string">&quot;/waifu-tips.json&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tipsJsPath</span>: cdnPath + <span class="string">&quot;/waifu-tips.js&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">live2dCorePath</span>: cdnPath + <span class="string">&quot;/live2dcubismcore.js&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">live2dSdkPath</span>: cdnPath + <span class="string">&quot;/live2d-sdk.js&quot;</span></span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">tools</span>: [<span class="string">&quot;hitokoto&quot;</span>, <span class="string">&quot;asteroids&quot;</span>, <span class="string">&quot;express&quot;</span>, <span class="string">&quot;switch-model&quot;</span>, <span class="string">&quot;switch-texture&quot;</span>, <span class="string">&quot;photo&quot;</span>, <span class="string">&quot;info&quot;</span>, <span class="string">&quot;quit&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">drag</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">enable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">direction</span>: [<span class="string">&quot;x&quot;</span>, <span class="string">&quot;y&quot;</span>]</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">switchType</span>: <span class="string">&quot;order&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">if</span> (screen.<span class="property">width</span> &gt;= <span class="number">768</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">loadExternalResource</span>(config.<span class="property">path</span>.<span class="property">cssPath</span>, <span class="string">&quot;css&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">loadExternalResource</span>(config.<span class="property">path</span>.<span class="property">live2dCorePath</span>, <span class="string">&quot;js&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">loadExternalResource</span>(config.<span class="property">path</span>.<span class="property">live2dSdkPath</span>, <span class="string">&quot;js&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">loadExternalResource</span>(config.<span class="property">path</span>.<span class="property">tipsJsPath</span>, <span class="string">&quot;js&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">    ]).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">initWidget</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">waifuPath</span>: config.<span class="property">path</span>.<span class="property">tipsJsonPath</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">cdnPath</span>: config.<span class="property">path</span>.<span class="property">modelPath</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">tools</span>: config.<span class="property">tools</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">dragEnable</span>: config.<span class="property">drag</span>.<span class="property">enable</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">dragDirection</span>: config.<span class="property">drag</span>.<span class="property">direction</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">switchType</span>: config.<span class="property">switchType</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadExternalResource</span>(<span class="params">url, type</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">let</span> tag;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (type === <span class="string">&quot;css&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        tag = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;link&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        tag.<span class="property">rel</span> = <span class="string">&quot;stylesheet&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        tag.<span class="property">href</span> = url;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">else</span> <span class="keyword">if</span> (type === <span class="string">&quot;js&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        tag = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;script&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        tag.<span class="property">src</span> = url;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (tag) &#123;</span></span><br><span class="line"><span class="language-javascript">        tag.<span class="property">onload</span> = <span class="function">() =&gt;</span> <span class="title function_">resolve</span>(url);</span></span><br><span class="line"><span class="language-javascript">        tag.<span class="property">onerror</span> = <span class="function">() =&gt;</span> <span class="title function_">reject</span>(url);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(tag);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><strong>在 <code>layouts/partials/footer/custom.html</code> 中引入 <code>live2d-v3.html</code></strong></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&#123; partial &quot;footer/live2d-v3.html&quot; . &#125;&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Hugo + Stack 主题美化指南 🎨&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/hugo-stack-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文详细介绍了 Hugo</summary>
      
    
    
    
    <category term="默认分类" scheme="https://www.meimolihan.eu.org/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
    <category term="hugo" scheme="https://www.meimolihan.eu.org/tags/hugo/"/>
    
  </entry>
  
  <entry>
    <title>Halo to Hugo 文章迁移工具 📦</title>
    <link href="https://www.meimolihan.eu.org/posts/541ef58e.html"/>
    <id>https://www.meimolihan.eu.org/posts/541ef58e.html</id>
    <published>2025-09-17T08:12:49.000Z</published>
    <updated>2025-09-17T08:12:49.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Halo to Hugo 文章迁移工具 📦</h1><p><img src="https://file.meimolihan.eu.org/img/halo-to-hugo-01.webp" alt=""></p><blockquote><p>🚀 一款专为博客迁移设计的智能工具，可将 Halo 文章的 Front Matter 格式完美转换为 Hugo 兼容格式，让您的博客迁移过程更加顺畅高效！</p><p>💡 基于优秀开源项目二次开发，源自：<a href="https://github.com/ayuayue/hexo2hugo">https://github.com/ayuayue/hexo2hugo</a></p></blockquote><hr><h2 id="📋-导航目录">📋 导航目录</h2><p><a href="#features">✨ 功能特点</a><br><a href="#usage-guide">📚 使用指南</a><br><a href="#technical-details">🔧 技术细节</a><br><a href="#important-notes">⚠️ 注意事项</a><br><a href="#faq">🐛 常见问题</a><br><a href="#development-guide">💻 开发指南</a></p><hr><p><a id="features"></a></p><h2 id="✨-功能特点">✨ 功能特点</h2><ul><li>🔄 <strong>格式转换</strong>：自动将 Halo 的 Front Matter 转换为 Hugo 兼容格式</li><li>📅 <strong>日期处理</strong>：智能转换日期格式并添加时区信息</li><li>🏷️ <strong>标签分类</strong>：完美处理 <code>tags</code> 和 <code>categories</code> 字段</li><li>🛡️ <strong>安全第一</strong>：创建独立输出目录，不修改原始文件</li><li>📝 <strong>内容保留</strong>：保持文章正文内容完全不变</li><li>⚙️ <strong>灵活扩展</strong>：支持自定义添加其他 Front Matter 字段</li></ul><hr><p><a id="usage-guide"></a></p><h2 id="📚-使用指南">📚 使用指南</h2><h3 id="🚀-快速开始">🚀 快速开始</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 克隆项目到本地</span></span><br><span class="line">git <span class="built_in">clone</span> git@github.com:meimolihan/halo_to_hugo.git</span><br><span class="line"><span class="built_in">cd</span> halo_to_hugo</span><br></pre></td></tr></table></figure><h3 id="详细步骤">详细步骤</h3><ol><li><p><strong>准备测试环境</strong> 📂</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建测试目录并复制一些文章</span></span><br><span class="line"><span class="built_in">mkdir</span> <span class="built_in">test</span></span><br><span class="line"><span class="built_in">cp</span> ~/your-halo-blog/content/posts/*.md <span class="built_in">test</span>/</span><br></pre></td></tr></table></figure></li><li><p><strong>执行转换</strong> ⚡</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 运行转换工具</span></span><br><span class="line">go run main.go <span class="built_in">test</span></span><br></pre></td></tr></table></figure></li><li><p><strong>验证结果</strong> ✅</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看转换后的文件</span></span><br><span class="line"><span class="built_in">ls</span> -la newPost$(<span class="built_in">date</span> +%s)/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查单个文件内容</span></span><br><span class="line"><span class="built_in">head</span> -n 20 newPost1701319905/your-post.md</span><br></pre></td></tr></table></figure></li><li><p><strong>应用到正式环境</strong> 🚀</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将转换后的文章移动到Hugo目录</span></span><br><span class="line"><span class="built_in">mv</span> newPost1701319905/* ~/your-hugo-site/content/posts/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 针对正式目录执行</span></span><br><span class="line">go run main.go ~/your-hugo-site/content/posts/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 运行Hugo测试生成</span></span><br><span class="line"><span class="built_in">cd</span> ~/your-hugo-site</span><br><span class="line">hugo server -D</span><br></pre></td></tr></table></figure></li></ol><h3 id="🎯-生产环境部署">🎯 生产环境部署</h3><ol><li><p><strong>完整迁移流程</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 备份原始数据（重要！）</span></span><br><span class="line">tar -czf halo-backup-$(<span class="built_in">date</span> +%Y%m%d).tar.gz ~/your-halo-blog/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 执行转换</span></span><br><span class="line">go run main.go ~/your-halo-blog/content/posts/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 部署到Hugo</span></span><br><span class="line"><span class="built_in">mv</span> newPost1701319905/* ~/your-hugo-site/content/posts/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 4. 生成静态站点</span></span><br><span class="line"><span class="built_in">cd</span> ~/your-hugo-site</span><br><span class="line">hugo --minify</span><br><span class="line"></span><br><span class="line"><span class="comment"># 5. 验证生成结果</span></span><br><span class="line"><span class="built_in">ls</span> -la public/</span><br></pre></td></tr></table></figure></li><li><p><strong>增量迁移策略</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 只处理新增或修改的文章</span></span><br><span class="line">find ~/your-halo-blog/content/posts/ -name <span class="string">&quot;*.md&quot;</span> -newer last_migration.txt | xargs -I &#123;&#125; <span class="built_in">cp</span> &#123;&#125; ./incremental_posts/</span><br><span class="line">go run main.go ./incremental_posts/</span><br></pre></td></tr></table></figure></li></ol><hr><p><a id="technical-details"></a></p><h2 id="🔧-技术细节">🔧 技术细节</h2><h3 id="支持的-Front-Matter-转换">支持的 Front Matter 转换</h3><table><thead><tr><th>Halo 字段</th><th>Hugo 字段</th><th>转换说明</th></tr></thead><tbody><tr><td><code>title</code></td><td><code>title</code></td><td>添加引号包裹</td></tr><tr><td><code>date</code></td><td><code>date</code></td><td>转换为 ISO8601 格式并添加时区</td></tr><tr><td><code>excerpt</code></td><td><code>description</code></td><td>直接映射</td></tr><tr><td><code>cover</code></td><td><code>image</code></td><td>直接映射</td></tr><tr><td><code>tags</code></td><td><code>tags</code></td><td>支持字符串和列表两种格式</td></tr><tr><td><code>categories</code></td><td><code>categories</code></td><td>支持字符串和列表两种格式</td></tr><tr><td><code>permalink</code></td><td><code>slug</code></td><td>提取最后部分作为slug</td></tr></tbody></table><h3 id="转换示例">转换示例</h3><p><strong>转换前 (Halo格式)</strong>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Halo</span> <span class="string">to</span> <span class="string">Hugo</span> <span class="string">迁移工具</span></span><br><span class="line"><span class="attr">id:</span> <span class="string">770a1b63-4737-4e87-a0d8-b8b38a3f7b6a</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2025-08-26 16:39:39</span></span><br><span class="line"><span class="attr">auther:</span> <span class="string">admin</span></span><br><span class="line"><span class="attr">cover:</span> <span class="string">https://example.com/image.webp</span></span><br><span class="line"><span class="attr">excerpt:</span> <span class="string">Halo</span> <span class="string">to</span> <span class="string">Hugo</span> <span class="string">迁移工具：无缝转换文章</span> <span class="string">Front</span> <span class="string">Matter</span></span><br><span class="line"><span class="attr">permalink:</span> <span class="string">/archives/5uaPaEJk</span></span><br><span class="line"><span class="attr">categories:</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Halo</span></span><br><span class="line"> <span class="bullet">-</span> <span class="string">Hugo</span></span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line"> <span class="bullet">-</span> <span class="string">blog</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><p><strong>转换后 (Hugo格式)</strong>:</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">&quot;Halo to Hugo 迁移工具&quot;</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2025-08-26T16:39:39+08:00</span></span><br><span class="line"><span class="attr">description:</span> <span class="string">&quot;Halo to Hugo 迁移工具：无缝转换文章 Front Matter&quot;</span></span><br><span class="line"><span class="attr">draft:</span> <span class="literal">false</span></span><br><span class="line"><span class="attr">weight:</span> <span class="number">0</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">&quot;https://example.com/image.webp&quot;</span></span><br><span class="line"><span class="attr">categories:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">Halo</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Hugo</span></span><br><span class="line"><span class="attr">tags:</span> </span><br><span class="line">  <span class="bullet">-</span> <span class="string">blog</span></span><br><span class="line"><span class="attr">slug:</span> <span class="string">&quot;5uaPaEJk&quot;</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure><h3 id="📁-文件结构处理">📁 文件结构处理</h3><p><strong>可选操作：Hugo 标准目录结构</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 为每篇文章创建独立目录</span></span><br><span class="line"><span class="keyword">for</span> %F <span class="keyword">in</span> (<span class="string">&quot;*.md&quot;</span>) <span class="keyword">do</span> @md <span class="string">&quot;%~nF&quot;</span> 2&gt;nul &amp; move /Y <span class="string">&quot;%F&quot;</span> <span class="string">&quot;%~nF\&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 2. 统一重命名为 index.md（Hugo标准）</span></span><br><span class="line"><span class="string">for /r %F in (*.md) do @if /i not &quot;</span>%~nF<span class="string">&quot;==&quot;</span>index<span class="string">&quot; ren &quot;</span>%F<span class="string">&quot; &quot;</span>index.md<span class="string">&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 最终结构示例：</span></span><br><span class="line"><span class="string"># content/</span></span><br><span class="line"><span class="string"># └── posts/</span></span><br><span class="line"><span class="string">#     ├── post-1/</span></span><br><span class="line"><span class="string">#     │   └── index.md</span></span><br><span class="line"><span class="string">#     ├── post-2/</span></span><br><span class="line"><span class="string">#     │   └── index.md</span></span><br><span class="line"><span class="string">#     └── post-3/</span></span><br><span class="line"><span class="string">#         └── index.md</span></span><br></pre></td></tr></table></figure><hr><p><a id="important-notes"></a></p><h2 id="⚠️-注意事项">⚠️ 注意事项</h2><h3 id="💾-数据安全第一">💾 数据安全第一</h3><ul><li><strong>重要提醒</strong>：始终在操作前备份原始文件，建议使用版本控制系统</li><li><strong>测试先行</strong>：先在测试目录验证转换结果，确认无误后再应用到正式环境</li><li><strong>分批处理</strong>：对于大量文章，建议分批迁移，便于问题排查</li></ul><h3 id="🔍-转换前检查">🔍 转换前检查</h3><ol><li><strong>文件编码</strong>：确保原始文件使用 UTF-8 编码，避免乱码问题</li><li><strong>格式规范</strong>：确认 Halo 文章使用标准 YAML Front Matter 格式</li><li><strong>特殊字符</strong>：检查标题和描述中是否包含需要转义的特殊字符</li><li><strong>图片资源</strong>：验证封面图链接是否有效，是否需要迁移图床</li></ol><h3 id="🛠️-自定义配置">🛠️ 自定义配置</h3><ul><li><strong>时区设置</strong>：如需修改默认时区，可调整源码中的 <code>Asia/Shanghai</code></li><li><strong>字段扩展</strong>：如需转换其他 Front Matter 字段，可自行修改转换逻辑</li><li><strong>输出格式</strong>：支持调整日期格式、缩进等输出参数</li></ul><h3 id="📝-迁移后验证">📝 迁移后验证</h3><ol><li><strong>内容完整性</strong>：随机抽查多篇文章，确认正文内容无丢失</li><li><strong>Front Matter</strong>：检查所有必要字段是否正确转换</li><li><strong>链接有效性</strong>：测试文章永久链接是否正常跳转</li><li><strong>分类标签</strong>：确认分类体系和标签云显示正常</li></ol><hr><p><a id="faq"></a></p><h2 id="🐛-常见问题">🐛 常见问题</h2><h3 id="🔧-转换相关问题">🔧 转换相关问题</h3><p><strong>Q: 转换后文章内容出现乱码怎么办？</strong><br>A: 这通常是由于文件编码问题导致的。请按以下步骤解决：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查文件编码</span></span><br><span class="line">file -i your-post.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 转换编码为 UTF-8</span></span><br><span class="line">iconv -f GBK -t UTF-8 your-post.md &gt; your-post-utf8.md</span><br></pre></td></tr></table></figure><p><strong>Q: 某些特殊字段没有转换怎么办？</strong><br>A: 工具目前支持常见字段转换。如需添加自定义字段，可以：</p><ol><li>修改 <code>convertFrontMatter</code> 函数</li><li>添加对应的字段映射逻辑</li><li>重新编译工具</li></ol><p><strong>Q: 转换后的日期时区不正确怎么办？</strong><br>A: 修改源码中的时区设置：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 找到这行代码，修改为您的时区</span></span><br><span class="line">location, _ := time.LoadLocation(<span class="string">&quot;Asia/Shanghai&quot;</span>)</span><br><span class="line"><span class="comment">// 例如改为：</span></span><br><span class="line">location, _ := time.LoadLocation(<span class="string">&quot;America/New_York&quot;</span>)</span><br></pre></td></tr></table></figure><h3 id="🚀-使用相关问题">🚀 使用相关问题</h3><p><strong>Q: 工具提示 “目录不存在” 错误？</strong><br>A: 请检查：</p><ul><li>目录路径是否正确</li><li>是否具有该目录的读取权限</li><li>路径中是否包含特殊字符</li></ul><p><strong>Q: 转换过程中程序崩溃怎么办？</strong><br>A: 这可能是由于某篇文章格式异常导致的：</p><ol><li>查看错误信息，定位问题文件</li><li>手动修复该文件的 Front Matter 格式</li><li>重新运行转换工具</li></ol><p><strong>Q: 如何只转换部分文章？</strong><br>A: 可以使用以下方法：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建临时目录，复制需要转换的文章</span></span><br><span class="line"><span class="built_in">mkdir</span> temp_posts</span><br><span class="line"><span class="built_in">cp</span> /path/to/specific/posts/*.md temp_posts/</span><br><span class="line">go run main.go temp_posts</span><br></pre></td></tr></table></figure><h3 id="📊-Hugo-集成问题">📊  Hugo 集成问题</h3><p><strong>Q: 迁移后 Hugo 生成失败？</strong><br>A: 检查可能的 Front Matter 问题：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 Hugo 检查语法</span></span><br><span class="line">hugo --verbose</span><br><span class="line"></span><br><span class="line"><span class="comment"># 检查具体的错误信息</span></span><br><span class="line">hugo server 2&gt;&amp;1 | grep -i error</span><br></pre></td></tr></table></figure><p><strong>Q: 分类和标签在 Hugo 中显示异常？</strong><br>A: 确认 Hugo 配置文件中的分类设置：</p><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># config.toml 中的相关配置</span></span><br><span class="line"><span class="section">[taxonomies]</span></span><br><span class="line">  <span class="attr">category</span> = <span class="string">&quot;categories&quot;</span></span><br><span class="line">  <span class="attr">tag</span> = <span class="string">&quot;tags&quot;</span></span><br></pre></td></tr></table></figure><hr><p><a id="development-guide"></a></p><h2 id="💻-开发指南">💻 开发指南</h2><h3 id="🏗️-项目结构概览">🏗️ 项目结构概览</h3><figure class="highlight nix"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">halo_to_hugo<span class="symbol">/</span></span><br><span class="line">├── main.go              <span class="comment"># 主程序入口</span></span><br><span class="line">├── go.mod              <span class="comment"># 模块定义</span></span><br><span class="line">├── README.md           <span class="comment"># 项目说明</span></span><br><span class="line">└── examples<span class="symbol">/</span>           <span class="comment"># 示例文件</span></span><br><span class="line">    ├── input<span class="symbol">/</span>          <span class="comment"># 输入示例</span></span><br><span class="line">    └── output<span class="symbol">/</span>         <span class="comment"># 输出示例</span></span><br></pre></td></tr></table></figure><h3 id="🔧-核心函数解析">🔧 核心函数解析</h3><ol><li><p><strong>主转换函数</strong> <code>convertFrontMatter</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 主要负责 Front Matter 的解析和转换</span></span><br><span class="line"><span class="comment">// 支持字段映射、日期处理、标签标准化等</span></span><br></pre></td></tr></table></figure></li><li><p><strong>日期处理函数</strong> <code>convertDate</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 功能：多种日期格式解析和时区处理</span></span><br><span class="line"><span class="comment">// 输入：原始日期字符串</span></span><br><span class="line"><span class="comment">// 输出：ISO8601 格式的日期字符串</span></span><br></pre></td></tr></table></figure></li><li><p><strong>标签处理函数</strong> <code>convertToStringSlice</code></p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 功能：统一 tags/categories 字段格式</span></span><br><span class="line"><span class="comment">// 支持：字符串逗号分隔 → 列表转换</span></span><br><span class="line"><span class="comment">// 支持：已有列表格式的标准化</span></span><br></pre></td></tr></table></figure></li></ol><h3 id="🎯-扩展开发指南">🎯 扩展开发指南</h3><p><strong>添加新字段转换</strong>：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">convertFrontMatter</span><span class="params">(original <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span></span> <span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125; &#123;</span><br><span class="line">    newFrontMatter := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="type">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 现有转换逻辑...</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 添加自定义字段转换</span></span><br><span class="line">    <span class="keyword">if</span> customField, exists := original[<span class="string">&quot;custom_field&quot;</span>]; exists &#123;</span><br><span class="line">        newFrontMatter[<span class="string">&quot;hugo_custom_field&quot;</span>] = customField</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> newFrontMatter</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>修改输出格式</strong>：</p><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 调整日期输出格式</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">formatDate</span><span class="params">(t time.Time)</span></span> <span class="type">string</span> &#123;</span><br><span class="line">    <span class="comment">// 自定义格式</span></span><br><span class="line">    <span class="keyword">return</span> t.Format(<span class="string">&quot;2006-01-02 15:04:05 -0700&quot;</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="🤝-贡献指南">🤝 贡献指南</h3><p>欢迎提交 Pull Request 和 Issue！参与开发时请注意：</p><ol><li><strong>代码规范</strong>：遵循 Go 语言标准代码格式</li><li><strong>测试覆盖</strong>：新增功能请添加相应的测试用例</li><li><strong>文档更新</strong>：修改功能时同步更新文档说明</li><li><strong>兼容性</strong>：确保改动不影响现有的转换逻辑</li></ol><h3 id="🔍-调试技巧">🔍 调试技巧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启用详细日志输出</span></span><br><span class="line">go run main.go -verbose test_posts</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调试单篇文章</span></span><br><span class="line">go run main.go -debug single_post.md</span><br><span class="line"></span><br><span class="line"><span class="comment"># 性能分析</span></span><br><span class="line">go run main.go -profile test_posts</span><br></pre></td></tr></table></figure><hr><blockquote><p>🎉 <strong>迁移愉快！</strong> 希望这个工具能让您的博客迁移过程更加顺利！<br>📮 如有任何问题或建议，欢迎在 GitHub 项目中提出 Issue 或 Pull Request！<br>⭐ 如果觉得工具好用，别忘了给项目点个 Star 支持一下！</p></blockquote>]]></content>
    
    
    <summary type="html">一款专为博客迁移设计的工具，可将 Halo 文章的 Front Matter 格式转换为 Hugo 兼容格式，让您的博客迁移过程更加顺畅高效！🚀</summary>
    
    
    
    <category term="默认分类" scheme="https://www.meimolihan.eu.org/categories/%E9%BB%98%E8%AE%A4%E5%88%86%E7%B1%BB/"/>
    
    
    <category term="halo" scheme="https://www.meimolihan.eu.org/tags/halo/"/>
    
    <category term="hugo" scheme="https://www.meimolihan.eu.org/tags/hugo/"/>
    
  </entry>
  
  <entry>
    <title>Linux 文件压缩与解压脚本 &amp; 交互式 📦</title>
    <link href="https://www.meimolihan.eu.org/posts/512fc1f8.html"/>
    <id>https://www.meimolihan.eu.org/posts/512fc1f8.html</id>
    <published>2025-09-15T05:16:56.000Z</published>
    <updated>2025-09-15T05:16:56.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Linux 文件压缩与解压脚本 &amp; 交互式 📦</h1><p><img src="https://file.meimolihan.eu.org/img/zip-gz-01.webp" alt=""></p><blockquote><p>本文档提供一系列用于文件压缩与解压的 Bash 脚本，支持 ZIP 和 TAR.GZ 格式，可自动化处理当前目录下的文件与子目录。所有脚本均通过远程链接一键执行，方便快捷！</p></blockquote><hr><h2 id="📚-导航目录">📚 导航目录</h2><ul><li><a href="#zip-format">📦 ZIP 格式处理</a><ul><li><a href="#backup-zip">压缩为ZIP文件</a></li><li><a href="#unzip">解压ZIP文件</a></li></ul></li><li><a href="#tar-gz-format">📦 TAR.GZ 格式处理</a><ul><li><a href="#backup-gz">压缩为TAR.GZ文件</a></li><li><a href="#untar-gz">解压TAR.GZ文件</a></li></ul></li><li><a href="#notes">💡 使用注意事项</a></li><li><a href="#customization">🔧 自定义与扩展</a></li></ul><hr><p><a id="zip-format"></a></p><h2 id="📦-ZIP-格式处理">📦 ZIP 格式处理</h2><p>本节介绍与 ZIP 格式相关的压缩与解压操作。</p><p><a id="backup-zip"></a></p><h3 id="📦-压缩为ZIP文件">📦 压缩为ZIP文件</h3><p>此功能用于遍历当前目录下的所有子目录，并将每个子目录单独压缩为一个同名的 <code>.zip</code> 文件。适合用于批量备份或整理项目目录。</p><p><strong>✨ 特点：</strong></p><ul><li>🔄 自动化遍历：无需手动指定路径，自动处理所有子目录。</li><li>🗂️ 保留结构：压缩后的 ZIP 文件完整保留原始目录结构。</li><li>🌐 远程脚本：直接通过 curl 下载并执行，无需本地保存脚本。</li></ul><p><strong>📝 使用命令：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/zip/backup_zip.sh)</span><br></pre></td></tr></table></figure><ul><li>或使用国内镜像（若访问 GitHub 受限）：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/zip/backup_zip.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/backup-zip-001.webp" alt="backup-zip压缩示例"></p><p><a id="unzip"></a></p><h3 id="🔓-解压ZIP文件">🔓 解压ZIP文件</h3><p>此功能用于遍历当前目录下的所有 <code>.zip</code> 文件，并将每个 ZIP 文件解压到当前目录下。适用于批量恢复备份或提取多个压缩包。</p><p><strong>✨ 特点：</strong></p><ul><li>🔄 批量处理：自动识别所有 ZIP 文件，无需逐个解压。</li><li>📂 解压到当前目录：所有文件提取到当前文件夹，保持路径清晰。</li><li>⚡ 一键执行：简化重复性操作，提高效率。</li></ul><p><strong>📝 使用命令：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/zip/unzip.sh)</span><br></pre></td></tr></table></figure><ul><li>或使用国内镜像：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/zip/unzip.sh)</span><br></pre></td></tr></table></figure><hr><p><a id="tar-gz-format"></a></p><h2 id="📦-TAR-GZ-格式处理">📦 TAR.GZ 格式处理</h2><p>本节介绍与 TAR.GZ 格式相关的压缩与解压操作。</p><p><a id="backup-gz"></a></p><h3 id="📦-压缩为TAR-GZ文件">📦 压缩为TAR.GZ文件</h3><p>此功能用于遍历当前目录下的所有子目录，并将每个子目录压缩为一个同名的 <code>.tar.gz</code> 文件。TAR.GZ 格式在 Linux 环境中广泛使用，具有较好的压缩效率和兼容性。</p><p><strong>✨ 特点：</strong></p><ul><li>🐧 Linux 友好：TAR.GZ 是 Linux 系统常见的压缩格式。</li><li>📦 高压缩比：相比 ZIP，TAR.GZ 通常能提供更高的压缩率。</li><li>🔗 远程执行：直接通过网络脚本执行，无需本地安装。</li></ul><p><strong>📝 使用命令：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/gz/backup_gz.sh)</span><br></pre></td></tr></table></figure><ul><li>或使用国内镜像：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/gz/backup_gz.sh)</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/backup-gz-001.webp" alt="backup-gz压缩示例"></p><p><a id="untar-gz"></a></p><h3 id="🔓-解压TAR-GZ文件">🔓 解压TAR.GZ文件</h3><p>此功能用于遍历当前目录下的所有 <code>.tar.gz</code> 文件，并将每个文件解压到当前目录下。适用于从 TAR.GZ 备份中恢复数据或提取压缩内容。</p><p><strong>✨ 特点：</strong></p><ul><li>🔍 自动识别：自动查找所有 TAR.GZ 文件并进行处理。</li><li>🗃️ 保留权限：解压时保留原始文件权限和属性（适用于 Linux 系统）。</li><li>🚀 快速执行：一条命令即可完成所有解压操作。</li></ul><p><strong>📝 使用命令：</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/gz/untar.sh)</span><br></pre></td></tr></table></figure><ul><li>或使用国内镜像：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/gz/untar.sh)</span><br></pre></td></tr></table></figure><hr><p><a id="notes"></a></p><h2 id="💡-使用注意事项">💡 使用注意事项</h2><ol><li><strong>🌐 网络依赖</strong>：这些脚本需要通过 curl 下载，请确保您的系统已连接互联网，并且能够访问 <code>script.meimolihan.eu.org</code> 或 <code>gitee.com</code>。</li><li><strong>🔐 安全提醒</strong>：执行远程脚本前，请确保您信任脚本来源。建议先检查脚本内容（可通过 curl 下载后查看），再执行。</li><li><strong>📁 目录结构</strong>：压缩脚本会遍历当前目录下的所有子目录，每个子目录生成一个压缩文件。请确保当前目录下没有无关子目录，以免产生多余文件。</li><li><strong>⚙️ 系统兼容</strong>：这些脚本主要在 Linux 或 macOS 环境中测试通过，Windows 用户可能需要使用 WSL 或类似环境。</li><li><strong>⚠️ 覆盖风险</strong>：解压时，如果当前目录已存在同名文件或文件夹，可能会被覆盖，请提前做好备份。</li></ol><hr><p><a id="customization"></a></p><h2 id="🔧-自定义与扩展">🔧 自定义与扩展</h2><p>如果您需要修改脚本以满足特定需求（如排除某些目录、添加压缩密码等），可以先将脚本下载到本地，然后进行编辑：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载脚本到本地</span></span><br><span class="line">curl -sL script.meimolihan.eu.org/sh/zip/backup-zip.sh &gt; my-backup-script.sh</span><br><span class="line"><span class="comment"># 编辑脚本</span></span><br><span class="line">nano my-backup-script.sh</span><br><span class="line"><span class="comment"># 授予执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x my-backup-script.sh</span><br><span class="line"><span class="comment"># 运行本地脚本</span></span><br><span class="line">./my-backup-script.sh</span><br></pre></td></tr></table></figure><p><strong>🎯 常见自定义场景：</strong></p><ul><li>添加压缩密码（ZIP 格式支持）。</li><li>排除特定目录或文件（如 node_modules、.git 等）。</li><li>修改压缩级别（ZIP 和 TAR.GZ 均支持）。</li><li>将压缩文件上传到远程服务器或云存储。</li></ul><hr><p>希望这些脚本能帮助您更高效地管理文件！如有问题或建议，欢迎反馈。🚀</p>]]></content>
    
    
    <summary type="html">本文档提供一系列用于文件压缩与解压的 Bash 脚本，支持 ZIP 和 TAR.GZ 格式，可自动化处理当前目录下的文件与子目录。所有脚本均通过远程链接一键执行，方便快捷！</summary>
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="我的" scheme="https://www.meimolihan.eu.org/tags/%E6%88%91%E7%9A%84/"/>
    
    <category term="同步&amp;备份" scheme="https://www.meimolihan.eu.org/tags/%E5%90%8C%E6%AD%A5-%E5%A4%87%E4%BB%BD/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Linux 完整目录备份与解压自动化脚本📂</title>
    <link href="https://www.meimolihan.eu.org/posts/53235b92.html"/>
    <id>https://www.meimolihan.eu.org/posts/53235b92.html</id>
    <published>2025-09-14T20:09:55.000Z</published>
    <updated>2025-09-14T20:09:55.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Linux 完整目录备份与解压自动化脚本 📂</h1><p><img src="https://file.meimolihan.eu.org/img/linux-rar-01.webp" alt=""></p><blockquote><p>本文详细介绍通用自动备份脚本的功能、使用方法及恢复指南，帮助您轻松管理重要数据的安全。</p></blockquote><hr><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#script-overview">📦 脚本概述</a></li><li><a href="#features">✨ 一、备份脚本功能与特点</a></li><li><a href="#extract-features">📦 二、解压命令功能与特点</a></li><li><a href="#usage">🔧 三、使用方法</a><ul><li><a href="#remote-usage">🌐 1. 远程执行方式（压缩与解压）</a><ul><li><a href="#remote-backup">📦 远程压缩操作</a></li><li><a href="#remote-extract">📤 本地解压操作</a></li></ul></li><li><a href="#local-usage">💻 2. 本地执行方式（压缩与解压）</a><ul><li><a href="#local-backup">📦 本地压缩操作</a></li><li><a href="#local-extract">📤 本地解压操作</a></li></ul></li></ul></li><li><a href="#test-backup-extract">🔍 四、测试压缩与解压</a></li><li><a href="#backup-compression">📁 五、备份原理与压缩机制</a></li><li><a href="#cron-setup">⏰ 六、定时任务设置</a></li><li><a href="#notes">💡 七、注意事项</a></li></ul><hr><p><a id="script-overview"></a></p><h2 id="📦-脚本概述">📦 脚本概述</h2><p>通用自动备份脚本是一个高效的数据保护工具，能够自动化完成目录的压缩备份、版本管理和旧备份清理工作。通过简单的命令即可实现一键备份，确保您的数据安全无忧。</p><hr><p><a id="features"></a></p><h2 id="一、-✨-备份脚本功能与特点">一、 ✨ 备份脚本功能与特点</h2><ul><li>✅ <strong>完全免交互</strong>：适合自动化任务和定时执行</li><li>✅ <strong>智能保留策略</strong>：自动保留指定数量的最新备份文件</li><li>✅ <strong>时间戳标识</strong>：每个备份文件包含精确到秒的创建时间</li><li>✅ <strong>完整性检查</strong>：自动验证源目录和备份目录的可用性</li><li>✅ <strong>详细日志输出</strong>：实时显示备份进度和结果</li><li>✅ <strong>空间管理</strong>：自动清理旧备份，避免磁盘空间不足</li></ul><hr><p><a id="extract-features"></a></p><h2 id="二、📦-解压命令功能与特点">二、📦 解压命令功能与特点</h2><ul><li>✅ <strong>灵活解压</strong>：支持解压到当前目录、指定目录，满足不同场景需求</li><li>✅ <strong>内容预览</strong>：可在解压前查看归档文件内容，避免覆盖重要文件</li><li>✅ <strong>选择性解压</strong>：支持从大型备份中提取单个或特定目录的文件</li><li>✅ <strong>权限保持</strong>：完整保留文件原始权限、所有权及时间戳属性</li><li>✅ <strong>进度可视化</strong>：使用<code>-v</code>参数可显示解压过程的详细文件列表</li><li>✅ <strong>通用性强</strong>：标准tar/gzip格式，兼容所有Linux/Unix系统及常见解压软件</li></ul><hr><p><a id="usage"></a></p><h2 id="三、🔧-使用方法">三、🔧 使用方法</h2><p><a id="remote-usage"></a></p><h3 id="1-远程执行方式（压缩与解压）">1. 远程执行方式（压缩与解压）</h3><ul><li><strong>基本命令格式 <code>bash ~/universal_backup.sh &lt;源目录&gt; &lt;备份目录&gt; [保留数量]</code></strong></li><li><strong>备份目录下仅保留  <code>源目录名_时间戳.tar.gz</code> 格式压缩包，每包即源目录的完整备份。</strong></li></ul><p><a id="remote-backup"></a></p><h4 id="📦-远程压缩操作">📦 远程压缩操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用主域名执行</span></span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/backup/universal_backup.sh) /源目录 /备份目录 保留数量</span><br><span class="line"></span><br><span class="line"><span class="comment"># 或使用Gitee镜像执行（国内用户推荐）</span></span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/universal_backup.sh) /源目录 /备份目录 保留数量</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/universal_backup-001.webp" alt=""></p><p><a id="remote-extract"></a></p><h4 id="📤-本地解压操作">📤 本地解压操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压到当前目录</span></span><br><span class="line">tar -xzvf /备份目录/备份文件.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压到指定目录</span></span><br><span class="line">tar -xzvf /备份目录/备份文件.tar.gz -C /目标目录/</span><br></pre></td></tr></table></figure><ul><li><strong>实际解压示例</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压到当前目录（会在当前目录创建原目录结构）</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压到指定目录</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz -C /var/www/new_html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只查看归档内容而不解压</span></span><br><span class="line">tar -tzvf /backups/html_20231201_143022.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压特定文件</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz path/to/specific/file</span><br></pre></td></tr></table></figure><ul><li><strong>解压参数详解</strong><ul><li><code>-x</code>：从归档中解压文件</li><li><code>-z</code>：使用gzip解压缩</li><li><code>-v</code>：显示详细处理过程</li><li><code>-f</code>：指定归档文件名</li><li><code>-C</code>：指定解压目标目录</li></ul></li></ul><hr><p><a id="local-usage"></a></p><h3 id="💻-2-本地执行方式（压缩与解压）">💻 2. 本地执行方式（压缩与解压）</h3><p><a id="local-backup"></a></p><h4 id="📦-本地压缩操作">📦 本地压缩操作</h4><ul><li><strong>基本命令格式 <code>bash ~/universal_backup.sh &lt;源目录&gt; &lt;备份目录&gt; [保留数量]</code></strong></li><li><strong>备份目录下仅保留  <code>源目录名_时间戳.tar.gz</code> 格式压缩包，每包即源目录的完整备份。</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载备份脚本</span></span><br><span class="line"><span class="built_in">cd</span> /mnt &amp;&amp; \</span><br><span class="line">wget -c https://gitee.com/meimolihan/script/raw/master/sh/backup/universal_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋予执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x universal_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决可能存在的换行符问题（如果需要）</span></span><br><span class="line"><span class="built_in">sudo</span> apt install dos2unix</span><br><span class="line">dos2unix universal_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 基本用法（保留3个备份）</span></span><br><span class="line">/mnt/universal_backup.sh  /源目录 /备份目录</span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定保留备份数量</span></span><br><span class="line">/mnt/universal_backup.sh /源目录 /备份目录 保留数量</span><br><span class="line"></span><br><span class="line"><span class="comment"># 实际示例</span></span><br><span class="line">/mnt/universal_backup.sh /mnt/test1 /mnt/test2</span><br><span class="line">/mnt/universal_backup.sh /mnt/test1 /mnt/test2 7</span><br></pre></td></tr></table></figure><p><a id="local-extract"></a></p><h4 id="📤-本地解压操作-2">📤 本地解压操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压到当前目录</span></span><br><span class="line">tar -xzvf /备份目录/备份文件.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压到指定目录</span></span><br><span class="line">tar -xzvf /备份目录/备份文件.tar.gz -C /目标目录/</span><br></pre></td></tr></table></figure><ul><li><strong>实际解压示例</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解压到当前目录（会在当前目录创建原目录结构）</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压到指定目录</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz -C /var/www/new_html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只查看归档内容而不解压</span></span><br><span class="line">tar -tzvf /backups/html_20231201_143022.tar.gz</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解压特定文件</span></span><br><span class="line">tar -xzvf /backups/html_20231201_143022.tar.gz path/to/specific/file</span><br></pre></td></tr></table></figure><ul><li><strong>解压参数详解</strong><ul><li><code>-x</code>：从归档中解压文件</li><li><code>-z</code>：使用gzip解压缩</li><li><code>-v</code>：显示详细处理过程</li><li><code>-f</code>：指定归档文件名</li><li><code>-C</code>：指定解压目标目录</li></ul></li></ul><hr><p><a id="test-backup-extract"></a></p><h2 id="四、🔍-测试压缩与解压">四、🔍 测试压缩与解压</h2><p>以下是一个完整的测试流程，展示如何使用这两个脚本进行压缩和解压操作：</p><h3 id="🧪-1-创建测试文件">🧪 1. 创建测试文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /mnt/&#123;test1,test2,test3&#125; &amp;&amp; \</span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/test1/&#123;aaa,bbb,ccc&#125; &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;测试文件内容&quot;</span> &gt; /mnt/test1/aaa/test1.txt &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;另一个测试文件&quot;</span> &gt; /mnt/test1/bbb/test2.txt &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第三个测试文件&quot;</span> &gt; /mnt/test1/ccc/test3.txt &amp;&amp; \</span><br><span class="line">tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>初始测试目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 / <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">/mnt/test3</span><br></pre></td></tr></table></figure><h3 id="🧪-2-测试-压缩">🧪 2. 测试 <code>压缩</code></h3><ul><li>这里指定了 <code>保留数量 5</code>，默认是<code>保留数量 3</code>。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/universal_backup.sh) /mnt/test1 /mnt/test2 5 &amp;&amp; tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>完成 <code>压缩</code> 后的目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 / <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">└── test1_20250916_193521.tar.gz</span><br><span class="line">/mnt/test3</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="🧪-3-测试-解压">🧪 3. 测试 <code>解压</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -xzvf /mnt/test2/test1_*.tar.gz -C /mnt/test3/ &amp;&amp; tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>完成 <code>解压</code> 后的目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 ~ <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">└── test1_20250916_193521.tar.gz</span><br><span class="line">/mnt/test3</span><br><span class="line">└── test1</span><br><span class="line">    ├── aaa</span><br><span class="line">    │   └── test1.txt</span><br><span class="line">    ├── bbb</span><br><span class="line">    │   └── test2.txt</span><br><span class="line">    └── ccc</span><br><span class="line">        └── test3.txt</span><br></pre></td></tr></table></figure><h4 id="🧪-4-删除测试文件">🧪 4. 删除测试文件</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">rm</span> -rf /mnt/test1 /mnt/test2 /mnt/test3 &amp;&amp; \</span><br><span class="line"><span class="built_in">ls</span> /mnt</span><br></pre></td></tr></table></figure><p>这个测试流程展示了：</p><ol><li>创建测试目录结构和文件</li><li>使用备份脚本将目录压缩为一个tar.gz文件</li><li>使用解压脚本将这些压缩包解压到目标目录</li><li>验证解压结果是否正确</li></ol><p>通过这个完整的测试流程，您可以确保脚本正常工作，并且理解整个压缩和解压的过程。🧪</p><hr><p><a id="backup-compression"></a></p><h2 id="五、📁-备份原理与压缩机制">五、📁 备份原理与压缩机制</h2><h3 id="压缩技术">压缩技术</h3><p>脚本使用标准的 <code>tar</code> 和 <code>gzip</code> 工具进行压缩，具有以下特点：</p><ul><li><strong>高压缩比</strong>：gzip压缩算法在保证速度的同时提供良好的压缩率</li><li><strong>广泛兼容</strong>：tar.gz格式在所有Linux/Unix系统上均可直接处理</li><li><strong>保留权限</strong>：完整保留文件权限、所有权和时间戳信息</li></ul><h3 id="备份流程">备份流程</h3><ol><li><strong>参数验证</strong>：检查源目录是否存在，备份目录是否可写</li><li><strong>压缩创建</strong>：使用 <code>tar -czf</code> 命令创建gzip压缩的归档文件</li><li><strong>文件命名</strong>：采用&quot;目录名_年月日_时分秒.tar.gz&quot;格式</li><li><strong>清理策略</strong>：按时间排序备份文件，保留最新的N个文件</li><li><strong>结果报告</strong>：显示备份大小和当前保留的备份列表</li></ol><hr><p><a id="cron-setup"></a></p><h2 id="六、⏰-定时任务设置">六、⏰ 定时任务设置</h2><h3 id="设置定时自动备份">设置定时自动备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑当前用户的crontab</span></span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加以下任务示例：</span></span><br><span class="line"><span class="comment"># 每天凌晨2点执行备份，保留7个备份</span></span><br><span class="line">0 2 * * * /path/to/universal_backup.sh /var/www/html /backups 7</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每周日凌晨1点执行备份，保留4个备份</span></span><br><span class="line">0 1 * * 0 /path/to/universal_backup.sh /home/user/documents /mnt/backup 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每6小时执行一次备份</span></span><br><span class="line">0 */6 * * * /path/to/universal_backup.sh /important/data /backups 10</span><br></pre></td></tr></table></figure><h3 id="日志记录配置">日志记录配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将输出同时记录到日志文件</span></span><br><span class="line">0 2 * * * /path/to/universal_backup.sh /var/www/html /backups 7 &gt;&gt; /var/log/backup.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只记录错误信息</span></span><br><span class="line">0 2 * * * /path/to/universal_backup.sh /var/www/html /backups 7 &gt; /dev/null 2&gt;&gt; /var/log/backup-error.log</span><br></pre></td></tr></table></figure><hr><p><a id="notes"></a></p><h2 id="七、💡-注意事项">七、💡 注意事项</h2><ol><li><strong>权限要求</strong>：运行脚本的用户需要对源目录有读取权限，对备份目录有写入权限</li><li><strong>磁盘空间</strong>：确保备份目录有足够的空间存储备份文件</li><li><strong>路径规范</strong>：建议使用绝对路径，避免相对路径可能带来的问题</li><li><strong>特殊字符</strong>：目录名中避免使用特殊字符，以免影响脚本执行</li><li><strong>文件系统</strong>：对于大量小文件，压缩过程可能较慢，建议在系统负载低时执行</li><li><strong>网络备份</strong>：如需备份到远程位置，可先本地备份再使用rsync同步</li></ol><h3 id="性能优化建议">性能优化建议</h3><ul><li>对于大型目录，考虑使用更高效的压缩算法（如pigz）</li><li>使用<code>ionice</code>和<code>nice</code>调整备份任务的IO和CPU优先级</li><li>对于数据库应用，建议先停止服务或使用专用备份工具</li></ul><h3 id="恢复测试建议">恢复测试建议</h3><p>定期测试备份文件的恢复过程，确保：</p><ul><li>备份文件完整无损</li><li>恢复后的文件权限正确</li><li>重要数据没有遗漏</li></ul><hr><blockquote><p>🚀 定期备份是数据安全的重要保障，建议您设置定时任务自动执行此脚本，为您的重要数据提供持续的保护。定期测试恢复流程，确保在需要时能够快速有效地恢复数据。</p></blockquote>]]></content>
    
    
    <summary type="html">本文详细介绍通用自动备份脚本的功能、使用方法及恢复指南，帮助您轻松管理重要数据的安全。</summary>
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="同步&amp;备份" scheme="https://www.meimolihan.eu.org/tags/%E5%90%8C%E6%AD%A5-%E5%A4%87%E4%BB%BD/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Linux 子目录分离备份与解压自动化脚本 📂</title>
    <link href="https://www.meimolihan.eu.org/posts/155e792c.html"/>
    <id>https://www.meimolihan.eu.org/posts/155e792c.html</id>
    <published>2025-09-14T20:08:51.000Z</published>
    <updated>2025-09-14T20:08:51.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Linux 子目录分离备份与解压自动化脚本 📂</h1><p><img src="https://file.meimolihan.eu.org/img/linux-rar-01.webp" alt=""></p><blockquote><p>本文介绍两个实用的自动化脚本：<code>directory_backup.sh</code> 和 <code>directory_extract.sh</code>，它们分别用于目录备份和解压操作。这些脚本采用免交互设计，非常适合集成到自动化运维流程或定时任务中，能够显著提高文件管理效率。✨</p></blockquote><hr><p><a id="navigation"></a></p><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#script-intro">📚 脚本简介</a></li><li><a href="#backup-features">⚙️ 一、备份脚本功能与特点</a></li><li><a href="#extract-features">📦 二、解压脚本功能与特点</a></li><li><a href="#usage">🚀 三、使用方法</a><ul><li><a href="#remote-usage">🌐 1. 远程执行方式（压缩与解压）</a><ul><li><a href="#remote-backup">📦 远程压缩操作</a></li><li><a href="#remote-extract">📤 远程解压操作</a></li></ul></li><li><a href="#local-usage">💻 2. 本地执行方式（压缩与解压）</a><ul><li><a href="#local-backup">📦 本地压缩操作</a></li><li><a href="#local-extract">📤 本地解压操作</a></li></ul></li></ul></li><li><a href="#test-backup-extract">🔍 四、测试压缩与解压</a></li><li><a href="#script-summary">🔧 五、脚本功能概括</a></li><li><a href="#cron-setup">⏰ 六、定时任务设置</a></li><li><a href="#scenarios-tips">💡 七、使用场景与建议</a></li></ul><hr><p><a id="script-intro"></a></p><h2 id="📚-脚本简介">📚 脚本简介</h2><p>本文介绍两个实用的自动化脚本：<code>directory_backup.sh</code> 和 <code>directory_extract.sh</code>，它们分别用于目录备份和解压操作。这些脚本采用免交互设计，非常适合集成到自动化运维流程或定时任务中，能够显著提高文件管理效率。✨</p><p>无论是系统管理员需要定期备份重要数据，还是开发人员需要快速部署环境，这两个脚本都能提供简单而强大的解决方案。它们支持多种压缩格式，具有详细的执行日志和错误报告，让用户随时了解操作状态。</p><hr><p><a id="backup-features"></a></p><h2 id="一、⚙️-备份脚本功能与特点">一、⚙️ 备份脚本功能与特点</h2><p><strong><code>directory_backup.sh</code> 是一个专业的目录备份工具，具有以下突出特点：</strong></p><ul><li><strong>🎯 自动化备份</strong>：一键指定备份目录下的所有非隐藏子目录，无需人工干预</li><li><strong>📁 智能压缩</strong>：每个子目录单独压缩为 <code>.tar.gz</code> 文件，保持结构清晰</li><li><strong>🔄 自动覆盖</strong>：免交互设计自动覆盖已存在的备份文件，适合自动化任务</li><li><strong>⏰ 日期标记</strong>：备份文件名格式为 <code>目录名-YYYY-MM-DD-HH-MM-SS.tar.gz</code>，便于版本管理</li><li><strong>👁️ 透明操作</strong>：提供详细的执行日志，实时显示备份进度和结果</li><li><strong>🚫 智能过滤</strong>：自动跳过隐藏目录（以<code>.</code>开头的目录），避免不必要的备份</li></ul><p>该脚本特别适合需要定期备份数据的场景，如网站数据备份、配置文件备份或项目版本存档等。🔒</p><hr><p><a id="extract-features"></a></p><h2 id="二、📦-解压脚本功能与特点">二、📦 解压脚本功能与特点</h2><p><strong><code>directory_extract.sh</code> 是一个多功能解压工具，具有以下核心功能：</strong></p><ul><li><strong>🔓 多格式支持</strong>：全面支持 <code>.tar.gz</code>, <code>.tgz</code>, <code>.tar</code>, <code>.zip</code>, <code>.gz</code> 等多种压缩格式</li><li><strong>📂 批量处理</strong>：自动遍历当前目录下的所有压缩包，一次性完成解压操作</li><li><strong>🏗️ 自动创建</strong>：如果目标目录不存在，会自动创建所需目录结构</li><li><strong>📊 详细报告</strong>：显示每个文件的解压状态和最终统计结果，一目了然</li><li><strong>🛡️ 错误处理</strong>：具备完善的错误处理机制，单个文件失败不影响其他操作</li><li><strong>🔍 智能识别</strong>：正确处理复合扩展名（如 <code>.tar.gz</code>），避免重复解压问题</li></ul><p>无论是从备份恢复数据，还是处理下载的压缩包集合，这个脚本都能大大简化工作流程。📤</p><hr><p><a id="usage"></a></p><h2 id="三、🚀-使用方法">三、🚀 使用方法</h2><p><a id="remote-usage"></a></p><h3 id="1-🌐-远程执行方式（压缩与解压）">1. 🌐 远程执行方式（压缩与解压）</h3><p>最简单的方法是直接通过远程URL执行脚本，无需下载：</p><p><a id="remote-backup"></a></p><h4 id="📦-远程压缩操作">📦 远程压缩操作</h4><ul><li><strong>基本命令格式 <code>bash ~/directory_backup.sh &lt;源目录&gt; &lt;备份目录&gt; [保留数量]</code></strong></li><li><strong>备份目录下仅保留按 <code>子目录名_时间戳.tar.gz</code> 命名的压缩包，每个对应<code>源目录</code>下的一轮 <code>子目录</code> 备份。</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/backup/directory_backup.sh) /mnt/test1 /mnt/test2/ 5</span><br></pre></td></tr></table></figure><ul><li><strong>或使用Gitee镜像：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/directory_backup.sh) /mnt/test1 /mnt/test2/ 5</span><br></pre></td></tr></table></figure><p><img src="https://file.meimolihan.eu.org/screenshot/directory_backup-001.webp" alt=""></p><p><a id="remote-extract"></a></p><h4 id="📤-远程解压操作">📤 远程解压操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到需要解压文件目录并执行解压到指定目录</span></span><br><span class="line"><span class="built_in">cd</span> /mnt/test2 &amp;&amp; \</span><br><span class="line">bash &lt;(curl -sL script.meimolihan.eu.org/sh/backup/directory_extract.sh) /mnt/test3/ &amp;&amp; \</span><br><span class="line">tree /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>或使用Gitee镜像：</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 切换到需要解压文件目录并执行解压到指定目录</span></span><br><span class="line"><span class="built_in">cd</span> /mnt/test2 &amp;&amp; \</span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/directory_extract.sh) /mnt/test3/ &amp;&amp; \</span><br><span class="line">tree /mnt/test3</span><br></pre></td></tr></table></figure><hr><p><a id="local-usage"></a></p><h3 id="2-💻-本地执行方式（压缩与解压）">2. 💻 本地执行方式（压缩与解压）</h3><p>如果需要频繁使用，可以下载脚本到本地：</p><p><a id="local-backup"></a></p><h4 id="📦-本地压缩操作">📦 本地压缩操作</h4><ul><li><strong>基本命令格式 <code>bash ~/directory_backup.sh &lt;源目录&gt; &lt;备份目录&gt; [保留数量]</code></strong></li><li><strong>备份目录下仅保留按 <code>子目录名_时间戳.tar.gz</code> 命名的压缩包，每个对应<code>源目录</code>下的一轮 <code>子目录</code> 备份。</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载备份脚本</span></span><br><span class="line">wget -c https://gitee.com/meimolihan/script/raw/master/sh/backup/directory_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋予执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x directory_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决可能存在的换行符问题（如果需要）</span></span><br><span class="line"><span class="built_in">sudo</span> apt install dos2unix</span><br><span class="line">dos2unix directory_backup.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 切换到需要备份的目录并执行备份到指定目录</span></span><br><span class="line">bash directory_backup.sh /mnt/test1 /mnt/test2 5 &amp;&amp; \</span><br><span class="line"><span class="built_in">ls</span> /mnt/test2</span><br></pre></td></tr></table></figure><p><a id="local-extract"></a></p><h4 id="📤-本地解压操作">📤 本地解压操作</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 下载解压脚本</span></span><br><span class="line">wget -c https://gitee.com/meimolihan/script/raw/master/sh/backup/directory_extract.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 赋予执行权限</span></span><br><span class="line"><span class="built_in">chmod</span> +x directory_extract.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解决可能存在的换行符问题（如果需要）</span></span><br><span class="line"><span class="built_in">sudo</span> apt install dos2unix</span><br><span class="line">dos2unix directory_extract.sh</span><br><span class="line"></span><br><span class="line"><span class="comment"># 执行脚本</span></span><br><span class="line"><span class="comment"># 切换到需要解压文件目录并执行解压到指定目录</span></span><br><span class="line"><span class="built_in">cd</span> /mnt/test2 &amp;&amp; \</span><br><span class="line">/mnt/directory_extract.sh /mnt/test3 &amp;&amp; \</span><br><span class="line">tree /mnt/test3</span><br></pre></td></tr></table></figure><p>解压脚本的使用方法类似，只需替换相应的脚本名称和URL即可。</p><hr><p><a id="test-backup-extract"></a></p><h2 id="四、🔍-测试压缩与解压">四、🔍 测试压缩与解压</h2><ul><li>以下是一个完整的测试流程，展示如何使用这两个脚本进行压缩和解压操作：</li></ul><h3 id="🧪-1-创建测试文件">🧪 1. 创建测试文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /mnt/&#123;test1,test2,test3&#125; &amp;&amp; \</span><br><span class="line"><span class="built_in">mkdir</span> -p /mnt/test1/&#123;aaa,bbb,ccc&#125; &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;测试文件内容&quot;</span> &gt; /mnt/test1/aaa/test1.txt &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;另一个测试文件&quot;</span> &gt; /mnt/test1/bbb/test2.txt &amp;&amp; \</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;第三个测试文件&quot;</span> &gt; /mnt/test1/ccc/test3.txt &amp;&amp; \</span><br><span class="line">tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>初始测试目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 / <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">/mnt/test3</span><br></pre></td></tr></table></figure><h3 id="🧪-2-测试-压缩">🧪 2. 测试 <code>压缩</code></h3><ul><li>这里指定了 <code>保留数量 5</code>，默认是<code>保留数量 3</code>。</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/directory_backup.sh) /mnt/test1 /mnt/test2 5 &amp;&amp; tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>完成 <code>压缩</code> 后的目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 / <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">├── aaa_20250916_192217.tar.gz</span><br><span class="line">├── bbb_20250916_192217.tar.gz</span><br><span class="line">└── ccc_20250916_192217.tar.gz</span><br><span class="line">/mnt/test3</span><br></pre></td></tr></table></figure><h3 id="🧪-3-测试解压">🧪 3. 测试<code>解压</code></h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt/test2 &amp;&amp; \</span><br><span class="line">bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/directory_extract.sh) /mnt/test3/ &amp;&amp; \</span><br><span class="line">tree /mnt/test1 /mnt/test2 /mnt/test3</span><br></pre></td></tr></table></figure><ul><li><strong>完成 <code>解压</code> 后的目录结构</strong></li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">root@debian13 ~ <span class="comment"># tree /mnt/test1 /mnt/test2 /mnt/test3</span></span><br><span class="line">/mnt/test1</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br><span class="line">/mnt/test2</span><br><span class="line">├── aaa_20250916_191032.tar.gz</span><br><span class="line">├── bbb_20250916_191032.tar.gz</span><br><span class="line">└── ccc_20250916_191032.tar.gz</span><br><span class="line">/mnt/test3</span><br><span class="line">├── aaa</span><br><span class="line">│   └── test1.txt</span><br><span class="line">├── bbb</span><br><span class="line">│   └── test2.txt</span><br><span class="line">└── ccc</span><br><span class="line">    └── test3.txt</span><br></pre></td></tr></table></figure><h3 id="🧪-4-删除测试文件">🧪 4. 删除测试文件</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> .. &amp;&amp; \</span><br><span class="line"><span class="built_in">rm</span> -rf /mnt/test1 /mnt/test2 /mnt/test3 &amp;&amp; \</span><br><span class="line"><span class="built_in">ls</span> /mnt</span><br></pre></td></tr></table></figure><p>这个测试流程展示了：</p><ol><li>创建测试目录结构和文件</li><li>使用备份脚本将目录压缩为多个tar.gz文件</li><li>使用解压脚本将这些压缩包解压到目标目录</li><li>验证解压结果是否正确</li></ol><p>通过这个完整的测试流程，您可以确保脚本正常工作，并且理解整个压缩和解压的过程。🧪</p><hr><p><a id="script-summary"></a></p><h2 id="五、🔧-脚本功能概括">五、🔧 脚本功能概括</h2><h3 id="directory-backup-sh">directory_backup.sh</h3><ul><li><strong>核心功能</strong>：自动化备份当前工作目录下的所有非隐藏子目录</li><li><strong>备份格式</strong>：每个子目录压缩为单独的 <code>目录名-YYYY-MM-DD.tar.gz</code> 文件</li><li><strong>适用场景</strong>：定期自动化备份、系统定时任务、脚本集成和批处理操作</li></ul><h3 id="directory-extract-sh">directory_extract.sh</h3><ul><li><strong>核心功能</strong>：自动解压当前目录下的所有压缩包到指定目录</li><li><strong>支持格式</strong>：<code>.tar.gz</code>, <code>.tgz</code>, <code>.tar</code>, <code>.zip</code>, <code>.gz</code></li><li><strong>适用场景</strong>：从备份恢复数据、批量处理下载的压缩包、环境部署</li></ul><hr><p><a id="cron-setup"></a></p><h2 id="六、⏰-定时任务设置">六、⏰ 定时任务设置</h2><h3 id="设置定时自动备份">设置定时自动备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 编辑当前用户的crontab</span></span><br><span class="line">crontab -e</span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加以下任务示例：</span></span><br><span class="line"><span class="comment"># 每天凌晨2点执行备份，保留7个备份</span></span><br><span class="line">0 2 * * * bash &lt;(curl -sL gitee.com/meimolihan/script/raw/master/sh/backup/directory_backup.sh) /mnt/test2/ /mnt/test2/ 7</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每周日凌晨1点执行备份，保留4个备份</span></span><br><span class="line">0 1 * * 0 /path/to/universal_backup.sh /home/user/documents /mnt/backup 4</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每6小时执行一次备份</span></span><br><span class="line">0 */6 * * * /path/to/universal_backup.sh /important/data /backups 10</span><br></pre></td></tr></table></figure><h3 id="日志记录配置">日志记录配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将输出同时记录到日志文件</span></span><br><span class="line">0 2 * * * /path/to/universal_backup.sh /var/www/html /backups 7 &gt;&gt; /var/log/backup.log 2&gt;&amp;1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 只记录错误信息</span></span><br><span class="line">0 2 * * * /path/to/universal_backup.sh /var/www/html /backups 7 &gt; /dev/null 2&gt;&gt; /var/log/backup-error.log</span><br></pre></td></tr></table></figure><hr><p><a id="scenarios-tips"></a></p><h2 id="七、💡-使用场景与建议">七、💡 使用场景与建议</h2><h3 id="常见使用场景">常见使用场景</h3><ol><li><strong>🔄 定期数据备份</strong>：结合cron定时任务，定期备份重要数据</li><li><strong>🚚 项目部署</strong>：快速解压多个组件包到指定目录</li><li><strong>📦 数据迁移</strong>：将数据打包后迁移到新服务器或新位置</li><li><strong>🛡️ 版本归档</strong>：定期创建项目或数据的版本快照</li></ol><h3 id="实用建议">实用建议</h3><ol><li><strong>🔐 权限管理</strong>：确保运行脚本的用户有足够的读写权限</li><li><strong>💾 空间检查</strong>：在执行备份前检查目标磁盘空间是否充足</li><li><strong>📝 日志监控</strong>：关注脚本输出，及时发现和处理错误</li><li><strong>🔄 测试验证</strong>：首次使用前在小范围测试，验证脚本行为符合预期</li><li><strong>⏰ 定时任务</strong>：使用cron等工具设置定期自动执行备份任务</li></ol><h3 id="高级技巧">高级技巧</h3><ul><li>结合其他工具（如rsync）实现增量备份</li><li>使用脚本返回值（exit code）在自动化流程中判断执行结果</li><li>通过重定向输出保存执行日志：<code>./script.sh /backup/dir &gt; backup.log 2&gt;&amp;1</code></li></ul><p>这两个脚本虽然简单，但功能强大，能够满足大多数日常备份和解压需求。通过合理使用，可以显著提高工作效率并减少人为错误。🎯</p><hr><p><em>如有问题或建议，欢迎反馈！希望这些脚本能为您的工作带来便利。</em> 😊</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Linux 子目录分离备份与解压自动化脚本 📂&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/linux-rar-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;本文介绍两个实用的自动</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="同步&amp;备份" scheme="https://www.meimolihan.eu.org/tags/%E5%90%8C%E6%AD%A5-%E5%A4%87%E4%BB%BD/"/>
    
    <category term="脚本" scheme="https://www.meimolihan.eu.org/tags/%E8%84%9A%E6%9C%AC/"/>
    
  </entry>
  
  <entry>
    <title>Docker 部署 Halo 博客系统-PostgreSQL ✨</title>
    <link href="https://www.meimolihan.eu.org/posts/92c231df.html"/>
    <id>https://www.meimolihan.eu.org/posts/92c231df.html</id>
    <published>2025-09-14T14:47:15.000Z</published>
    <updated>2025-09-14T14:47:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Docker 部署 Halo 博客系统-PostgreSQL ✨</h1><p><img src="https://file.meimolihan.eu.org/img/halo-01.webp" alt="Halo Banner"></p><p><video src="http://file.meimolihan.eu.org/mp4/halo-2.0.mp4" controls="controls" width="650" height="400"></video></p><hr><h2 id="📋-目录导航">📋 目录导航</h2><ul><li><a href="#project-intro">🎯 项目简介</a></li><li><a href="#features">🛠️ 核心特性</a></li><li><a href="#deploy">🐳 一、Docker 部署 Halo 博客</a><ul><li><a href="#deploy-setup">1. 创建目录并编写 <code>docker-compose.yml</code> 文件 📁</a></li><li><a href="#deploy-start">2. 拉取镜像并启动容器 🚀</a></li><li><a href="#postgresql-version">3. PostgreSQL 版本管理与验证 🔍</a></li></ul></li><li><a href="#usage">🚀 二、使用 Halo 博客</a><ul><li><a href="#usage-setup">1. 首次访问设置 🎯</a></li><li><a href="#usage-features">2. 功能特性 ✨</a></li></ul></li><li><a href="#nginx">🌐 三、Nginx 反向代理配置</a><ul><li><a href="#nginx-config">1. 创建 Nginx 配置文件 🔧</a></li><li><a href="#nginx-reload">2. 测试并重载 Nginx 🔄</a></li></ul></li><li><a href="#maintenance">🔧 四、容器维护命令</a><ul><li><a href="#docker-compose">1. Docker Compose 命令 🐳</a></li><li><a href="#docker">2. Docker 容器命令 📦</a></li><li><a href="#docker-images">3. Docker 镜像管理 📀</a></li></ul></li><li><a href="#conclusion">🌟 启航创作，连接世界</a></li></ul><hr><p><a id="project-intro"></a></p><h2 id="🎯-项目简介">🎯 项目简介</h2><ul><li><strong>🌐 <code>Halo</code> 官网地址：<a href="https://www.halo.run/">https://www.halo.run/</a></strong></li><li><strong>🐱 <code>GitHub</code> 项目地址：<a href="https://github.com/halo-dev">https://github.com/halo-dev</a></strong></li><li><strong>🐋 <code>Docker</code> 镜像地址：<a href="https://hub.docker.com/r/halohub/halo">https://hub.docker.com/r/halohub/halo</a></strong></li></ul><p><strong><a href="https://www.halo.run/">Halo</a></strong> 是一款现代化的开源博客/CMS 系统，基于 Java 和 Spring Boot 构建。它提供了丰富的主题和插件生态系统，让用户可以轻松创建和管理自己的网站。</p><hr><p><a id="features"></a></p><h2 id="🛠️-核心特性">🛠️ 核心特性</h2><table><thead><tr><th>特性类别</th><th>功能描述</th><th>优势</th></tr></thead><tbody><tr><td><strong>🎨 主题系统</strong></td><td>丰富的主题选择</td><td>支持自定义设计，满足个性化需求</td></tr><tr><td><strong>🔌 插件生态</strong></td><td>功能扩展灵活</td><td>社区插件丰富，满足各种需求</td></tr><tr><td><strong>📝 编辑器</strong></td><td>富文本和Markdown支持</td><td>强大的内容编辑体验</td></tr><tr><td><strong>👥 用户管理</strong></td><td>多用户权限控制</td><td>支持团队协作和权限管理</td></tr><tr><td><strong>📊 数据统计</strong></td><td>访问统计和分析</td><td>提供详细的数据分析报告</td></tr><tr><td><strong>🔍 SEO 优化</strong></td><td>内置SEO功能</td><td>提升搜索引擎排名和可见度</td></tr><tr><td><strong>🌐 响应式设计</strong></td><td>多端适配</td><td>在手机、平板和电脑上均有良好体验</td></tr><tr><td><strong>🐳 Docker 部署</strong></td><td>容器化部署</td><td>简单便捷，易于维护和升级</td></tr></tbody></table><hr><p><a id="deploy"></a></p><h2 id="🐳-一、Docker-部署-Halo-博客">🐳 一、Docker 部署 Halo 博客</h2><p><a id="deploy-setup"></a></p><h3 id="1-创建目录并编写-docker-compose-yml-文件-📁">1. 创建目录并编写 <code>docker-compose.yml</code> 文件 📁</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /mnt/mydisk/home/halo &amp;&amp; <span class="built_in">cd</span> <span class="variable">$_</span> &amp;&amp; \</span><br><span class="line"><span class="built_in">cat</span> &gt; docker-compose.yml &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">services:</span><br><span class="line">  halo:</span><br><span class="line">    image: registry.fit2cloud.com/halo/halo:2</span><br><span class="line">    container_name: halo</span><br><span class="line">    restart: on-failure:3</span><br><span class="line">    depends_on:</span><br><span class="line">      halodb:</span><br><span class="line">        condition: service_healthy</span><br><span class="line">    networks:</span><br><span class="line">      halo_network:</span><br><span class="line">    volumes:</span><br><span class="line">      - ./halo2:/root/.halo2</span><br><span class="line">    ports:</span><br><span class="line">      - <span class="string">&quot;8090:8090&quot;</span></span><br><span class="line">    healthcheck:</span><br><span class="line">      <span class="built_in">test</span>: [<span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;curl&quot;</span>, <span class="string">&quot;-f&quot;</span>, <span class="string">&quot;http://localhost:8090/actuator/health/readiness&quot;</span>]</span><br><span class="line">      interval: 30s</span><br><span class="line">      <span class="built_in">timeout</span>: 5s</span><br><span class="line">      retries: 5</span><br><span class="line">      start_period: 30s</span><br><span class="line">    environment:</span><br><span class="line">      <span class="comment"># JVM 参数，默认为 -Xmx256m -Xms256m，可以根据实际情况做调整，置空表示不添加 JVM 参数</span></span><br><span class="line">      - JVM_OPTS=-Xmx256m -Xms256m</span><br><span class="line">    <span class="built_in">command</span>:</span><br><span class="line">      - --spring.r2dbc.url=r2dbc:pool:postgresql://halodb/halo</span><br><span class="line">      - --spring.r2dbc.username=halo</span><br><span class="line">      <span class="comment"># PostgreSQL 的密码，请保证与下方 POSTGRES_PASSWORD 的变量值一致。</span></span><br><span class="line">      - --spring.r2dbc.password=openpostgresql</span><br><span class="line">      - --spring.sql.init.platform=postgresql</span><br><span class="line">      <span class="comment"># 外部访问地址，请根据实际需要修改</span></span><br><span class="line">      - --halo.external-url=http://localhost:8090/</span><br><span class="line">  halodb:</span><br><span class="line">    image: postgres:17.6</span><br><span class="line">    container_name: halodb</span><br><span class="line">    restart: on-failure:3</span><br><span class="line">    networks:</span><br><span class="line">      halo_network:</span><br><span class="line">    volumes:</span><br><span class="line">      - ./db:/var/lib/postgresql/data</span><br><span class="line">    healthcheck:</span><br><span class="line">      <span class="built_in">test</span>: [ <span class="string">&quot;CMD&quot;</span>, <span class="string">&quot;pg_isready&quot;</span> ]</span><br><span class="line">      interval: 10s</span><br><span class="line">      <span class="built_in">timeout</span>: 5s</span><br><span class="line">      retries: 5</span><br><span class="line">    environment:</span><br><span class="line">      - POSTGRES_PASSWORD=openpostgresql</span><br><span class="line">      - POSTGRES_USER=halo</span><br><span class="line">      - POSTGRES_DB=halo</span><br><span class="line">      - PGUSER=halo</span><br><span class="line"></span><br><span class="line">networks:</span><br><span class="line">  halo_network:</span><br><span class="line">    name: halo_network</span><br><span class="line">    driver: bridge</span><br><span class="line"></span><br><span class="line"><span class="comment"># Halo博客_后台地址：http://10.10.10.245:8090/console</span></span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><a id="deploy-start"></a></p><h3 id="2-拉取镜像并启动容器-🚀">2. 拉取镜像并启动容器 🚀</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker-compose up -d</span><br></pre></td></tr></table></figure><p><a id="postgresql-version"></a></p><h3 id="3-PostgreSQL-版本管理与验证-🔍">3. PostgreSQL 版本管理与验证 🔍</h3><ul><li>如需使用其他版本的 <code>PostgreSQL</code> 镜像，可以使用以下命令查询可用版本标签：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">curl -sS <span class="string">&quot;https://registry.hub.docker.com/v2/repositories/library/postgres/tags/?page_size=100&quot;</span> \</span><br><span class="line">| jq -r <span class="string">&#x27;.results[].name&#x27;</span> | grep -E <span class="string">&#x27;^[0-9]+(\.[0-9]+)?$&#x27;</span> | <span class="built_in">sort</span> -V</span><br></pre></td></tr></table></figure><ul><li>部署完成后，可以使用以下命令验证 <code>PostgreSQL</code> 版本：</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it halodb pg_config --version</span><br></pre></td></tr></table></figure><hr><p><a id="usage"></a></p><h2 id="🚀-二、使用-Halo-博客">🚀 二、使用 Halo 博客</h2><p><a id="usage-setup"></a></p><h3 id="1-首次访问设置-🎯">1. 首次访问设置 🎯</h3><ol><li>打开浏览器访问: <a href="http://xn--IP-0p3cl7jf7fo83a16x:8090/console">http://你的服务器IP:8090/console</a></li><li>按照页面提示完成初始设置：<ul><li>创建管理员账户</li><li>设置博客基本信息</li><li>选择初始主题</li></ul></li></ol><p><a id="usage-features"></a></p><h3 id="2-功能特性-✨">2. 功能特性 ✨</h3><ul><li>🎨 <strong>主题系统</strong>: 丰富的主题选择，支持自定义</li><li>🔌 <strong>插件生态</strong>: 扩展功能，满足各种需求</li><li>📝 <strong>编辑器</strong>: 强大的富文本和Markdown编辑器</li><li>👥 <strong>用户管理</strong>: 多用户支持，权限控制</li><li>📊 <strong>数据统计</strong>: 访问统计和内容分析</li><li>🔍 <strong>SEO 优化</strong>: 内置SEO功能，提升搜索引擎排名</li></ul><hr><p><a id="nginx"></a></p><h2 id="🌐-三、Nginx-反向代理配置">🌐 三、Nginx 反向代理配置</h2><blockquote><p><strong>访问地址示例：<a href="https://halo.example.com:666">https://halo.example.com:666</a></strong></p></blockquote><p><a id="nginx-config"></a></p><h3 id="1-创建-Nginx-配置文件-🔧">1. 创建 Nginx 配置文件 🔧</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> -p /etc/nginx/conf.d &amp;&amp; \</span><br><span class="line"><span class="built_in">cat</span> &gt; /etc/nginx/conf.d/halo.conf &lt;&lt;<span class="string">&#x27;EOF&#x27;</span></span><br><span class="line">server &#123;</span><br><span class="line">    listen 666 ssl;</span><br><span class="line">    listen [::]:666 ssl;</span><br><span class="line">    server_name halo.example.com;   <span class="comment"># 替换为你的域名</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># SSL 证书</span></span><br><span class="line">    ssl_certificate /etc/nginx/keyfile/cert.pem;</span><br><span class="line">    ssl_certificate_key /etc/nginx/keyfile/key.pem;</span><br><span class="line">    ssl_protocols TLSv1.2 TLSv1.3;</span><br><span class="line">    ssl_prefer_server_ciphers off;</span><br><span class="line">    ssl_ciphers ECDHE+AESGCM:ECDHE+CHACHA20:!aNULL:!MD5;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 安全头部</span></span><br><span class="line">    add_header X-Frame-Options DENY;</span><br><span class="line">    add_header X-Content-Type-Options nosniff;</span><br><span class="line">    add_header X-XSS-Protection <span class="string">&quot;1; mode=block&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 文件大小限制</span></span><br><span class="line">    client_max_body_size 100M;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://127.0.0.1:8090;</span><br><span class="line">        proxy_set_header Host <span class="variable">$host</span>;</span><br><span class="line">        proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</span><br><span class="line">        proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</span><br><span class="line">        proxy_http_version 1.1;</span><br><span class="line">        proxy_buffering off;</span><br><span class="line"></span><br><span class="line">        <span class="comment"># WebSocket 支持</span></span><br><span class="line">        proxy_set_header Upgrade <span class="variable">$http_upgrade</span>;</span><br><span class="line">        proxy_set_header Connection <span class="string">&quot;upgrade&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 错误页</span></span><br><span class="line">    error_page 404 500 502 503 504 /50x.html;</span><br><span class="line">    location = /50x.html &#123;</span><br><span class="line">        root /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure><p><a id="nginx-reload"></a></p><h3 id="2-测试并重载-Nginx-🔄">2. 测试并重载 Nginx 🔄</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nginx -t &amp;&amp; <span class="built_in">sudo</span> systemctl reload nginx</span><br></pre></td></tr></table></figure><hr><p><a id="maintenance"></a></p><h2 id="🔧-四、容器维护命令">🔧 四、容器维护命令</h2><p><a id="docker-compose"></a></p><h3 id="1-Docker-Compose-命令-🐳">1. Docker Compose 命令 🐳</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 进入项目目录</span></span><br><span class="line"><span class="built_in">cd</span> /mnt/mydisk/home/halo</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止并删除容器</span></span><br><span class="line">docker-compose down</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拉取最新镜像</span></span><br><span class="line">docker-compose pull</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动容器</span></span><br><span class="line">docker-compose up -d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务状态</span></span><br><span class="line">docker-compose ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看服务日志</span></span><br><span class="line">docker-compose logs</span><br><span class="line"></span><br><span class="line"><span class="comment"># 跟踪服务日志</span></span><br><span class="line">docker-compose logs -f</span><br><span class="line"></span><br><span class="line"><span class="comment"># 完整升级流程</span></span><br><span class="line">docker-compose down &amp;&amp; \</span><br><span class="line">docker-compose pull &amp;&amp; \</span><br><span class="line">docker-compose up -d &amp;&amp; \</span><br><span class="line">docker image prune -f</span><br></pre></td></tr></table></figure><p><a id="docker"></a></p><h3 id="2-Docker-容器命令-📦">2. Docker 容器命令 📦</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查看运行中容器</span></span><br><span class="line">docker ps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 停止/启动/重启容器</span></span><br><span class="line">docker stop halo halodb</span><br><span class="line">docker start halo halodb  </span><br><span class="line">docker restart halo halodb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删除容器</span></span><br><span class="line">docker <span class="built_in">rm</span> halo halodb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入容器Shell</span></span><br><span class="line">docker <span class="built_in">exec</span> -it halo sh</span><br><span class="line">docker <span class="built_in">exec</span> -it halo bash</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器日志</span></span><br><span class="line">docker logs halo</span><br><span class="line">docker logs halodb</span><br><span class="line">docker logs -f halo</span><br><span class="line">docker logs --<span class="built_in">tail</span> 50 halodb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 监控资源使用</span></span><br><span class="line">docker stats halo halodb</span><br><span class="line"></span><br><span class="line"><span class="comment"># 查看容器详情</span></span><br><span class="line">docker inspect halo</span><br></pre></td></tr></table></figure><p><a id="docker-images"></a></p><h3 id="3-Docker-镜像管理-📀">3. Docker 镜像管理 📀</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br><span class="line">docker rmi halohub/halo:2.20.12 mysql:8.3.0</span><br><span class="line">docker image prune -f</span><br><span class="line">docker image prune -a -f</span><br></pre></td></tr></table></figure><hr><p><a id="conclusion"></a></p><h2 id="🌟-启航创作，连接世界">🌟 启航创作，连接世界</h2><p>通过本文档，你已经成功使用 Docker 部署了 Halo 博客系统，并借助 Nginx 反向代理实现了安全便捷的远程访问。现在，你可以：</p><p>✍️ <strong>自由表达</strong> 书写所想、记录生活、分享知识，打造属于你自己的内容天地<br>🎨 <strong>个性定制</strong> 借助丰富的主题与插件，构建独一无二的博客风格与功能<br>🌍 <strong>广泛传播</strong> 通过多端适配与SEO优化，让你的内容被更多人发现与认可<br>🤝 <strong>互动交流</strong> 开放评论与订阅功能，与读者建立更深度的连接与对话</p><p>博客不仅是记录的工具，更是思想的载体和连接的桥梁。愿 Halo 成为你畅所欲言、展示自我的最佳伙伴，陪伴你在每一个创作的时刻和分享的瞬间。</p><p>从现在开始，发布你的第一篇博客，向世界发出你的声音吧！🚀</p><hr><p>📌 <strong>持续关注</strong>：建议订阅 <a href="https://www.halo.run/">Halo 官方更新</a>，及时获取新功能与主题插件。<br>🐛 <strong>反馈与支持</strong>：使用中如有问题或建议，可前往 <a href="https://github.com/halo-dev/halo/issues">GitHub Issues</a> 提出。</p><p>祝你写作愉快，博客有成！🎉</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Docker 部署 Halo 博客系统-PostgreSQL ✨&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/halo-01.webp&quot; alt=&quot;Halo Banner&quot;&gt;&lt;/p&gt;
&lt;p&gt;&lt;video src</summary>
      
    
    
    
    <category term="Docker" scheme="https://www.meimolihan.eu.org/categories/Docker/"/>
    
    
    <category term="compose" scheme="https://www.meimolihan.eu.org/tags/compose/"/>
    
    <category term="halo" scheme="https://www.meimolihan.eu.org/tags/halo/"/>
    
  </entry>
  
  <entry>
    <title>Halo 博客升级 MySQL 数据库指南 🚀</title>
    <link href="https://www.meimolihan.eu.org/posts/8743bdf0.html"/>
    <id>https://www.meimolihan.eu.org/posts/8743bdf0.html</id>
    <published>2025-09-14T10:09:45.000Z</published>
    <updated>2025-09-14T10:09:45.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Halo 博客升级 MySQL 数据库指南 🚀</h1><p><img src="https://file.meimolihan.eu.org/img/mysql-01.webp" alt=""></p><p>📌 <strong>导读</strong>：本文详细记录将 Halo 博客的 MySQL 数据库从 8.3.0 版本安全升级至 9.4.0 的完整操作流程。包含版本路线规划、数据备份、升级参数配置、健康检查及收尾操作，适用于生产环境下的平滑升级。</p><hr><h2 id="📋-导航目录">📋 导航目录</h2><ul><li><a href="#upgrade-background">✨ 升级背景与注意事项</a></li><li><a href="#version-path">🔍 版本升级路线</a></li><li><a href="#check-tags">📦 准备工作：查询可用版本标签</a></li><li><a href="#full-backup">💾 关键第一步：整库逻辑备份（必做！）</a></li><li><a href="#cross-upgrade">⚙️ 跨主版本升级（8.4.2 → 9.0.1）</a><ul><li><a href="#change-image-tag">📝 修改 Docker 镜像标签</a></li><li><a href="#add-upgrade-param">⚒️ 添加临时升级参数</a></li></ul></li><li><a href="#execute-upgrade">🚀 执行升级操作</a></li><li><a href="#health-check">✅ 升级状态确认</a></li><li><a href="#cleanup">🔧 收尾工作</a></li><li><a href="#qa-summary">💡 常见问题与总结</a></li></ul><hr><p><a id="upgrade-background"></a></p><h2 id="✨-升级背景与注意事项">✨ 升级背景与注意事项</h2><p>MySQL 8.x 至 9.x 属于跨主版本升级，涉及<strong>系统表元数据格式变更</strong>且升级过程不可逆。🔴 <strong>重要提示</strong>：生产环境升级前务必完成全量逻辑备份，避免数据丢失风险。</p><blockquote><p>📝 <strong>升级特点</strong>：</p><ul><li>✨ <strong>性能提升</strong>：MySQL 9.x 优化了查询处理器，复杂查询性能提升显著；</li><li>🔒 <strong>增强安全</strong>：新增角色继承、密码验证策略强化等安全特性；</li><li>📊 <strong>JSON功能扩展</strong>：JSON数据类型支持更多函数和路径表达式；</li><li>💾 <strong>兼容性保障</strong>：9.0 版本兼容 8.4 的数据文件格式；</li><li>⚠️ <strong>升级单向性</strong>：升级后会更新系统表结构以支持新特性，且不可回退；</li><li>🔧 <strong>参数要求</strong>：仅首次启动需添加 <code>--upgrade=FORCE</code> 参数，后续重启无需此操作。</li></ul></blockquote><hr><p><a id="version-path"></a></p><h2 id="🔍-版本升级路线">🔍 版本升级路线</h2><p>本次升级采用渐进式路径，确保兼容性稳定：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8.3.0 → 8.4.0 → 8.4.2 → 9.0.1 → 9.4.0</span><br></pre></td></tr></table></figure><blockquote><p>💡 <strong>提示</strong>：建议逐步升级，避免跨多个主版本直接升级，以减少意外错误。每个中间版本都解决了特定的兼容性问题，确保数据迁移的平稳性。</p></blockquote><hr><p><a id="check-tags"></a></p><h2 id="📦-准备工作：查询可用版本标签">📦 准备工作：查询可用版本标签</h2><p>使用以下命令列出所有官方 MySQL 镜像标签（8.x 和 9.x 系列），并按版本号排序：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查询官方仓库所有 tag（返回 JSON，用 jq 过滤更爽）</span></span><br><span class="line">docker run --<span class="built_in">rm</span> quay.io/skopeo/stable list-tags docker://mysql \</span><br><span class="line">  | jq -r <span class="string">&#x27;.Tags[]&#x27;</span> \</span><br><span class="line">  | grep -E <span class="string">&#x27;^[8-9]\.&#x27;</span> \</span><br><span class="line">  | <span class="built_in">sort</span> -V</span><br></pre></td></tr></table></figure><p>🔍 <strong>功能说明</strong>：此步骤确保你获取到官方支持的所有版本标签，避免使用非稳定版或已废弃版本。建议优先选择标记为&quot;latest&quot;或&quot;stable&quot;的版本分支。</p><hr><p><a id="full-backup"></a></p><h2 id="💾-关键第一步：整库逻辑备份（必做！）">💾 关键第一步：整库逻辑备份（必做！）</h2><p>⚠️ <strong>警告</strong>：跳过备份可能导致数据无法回退！务必执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it halodb mysqldump --all-databases --single-transaction -uroot -p<span class="string">&#x27;o#DwN&amp;JSa56&#x27;</span> &gt; all_$(<span class="built_in">date</span> +%F_%H-%M).sql</span><br></pre></td></tr></table></figure><p>📌 <strong>参数说明</strong>：</p><ul><li><code>--single-transaction</code>：确保备份期间数据一致性，使用事务隔离机制；</li><li><code>-uroot -p'你的密码'</code>：按实际数据库密码修改，建议使用配置文件避免密码暴露；</li><li>备份文件命名包含时间戳，便于版本管理；</li><li>🔒 <strong>安全建议</strong>：备份完成后将备份文件传输到远程存储或不同物理设备。</li></ul><p>💡 <strong>扩展功能</strong>：考虑使用自动化备份脚本，定期执行并保留多个备份版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line">BACKUP_DIR=<span class="string">&quot;/path/to/backup&quot;</span></span><br><span class="line"><span class="built_in">mkdir</span> -p <span class="variable">$BACKUP_DIR</span></span><br><span class="line">docker <span class="built_in">exec</span> halodb mysqldump --all-databases --single-transaction -uroot -p<span class="string">&#x27;password&#x27;</span> | gzip &gt; <span class="variable">$BACKUP_DIR</span>/all_$(<span class="built_in">date</span> +%F_%H-%M).sql.gz</span><br><span class="line"><span class="comment"># 保留最近7天备份</span></span><br><span class="line">find <span class="variable">$BACKUP_DIR</span> -name <span class="string">&quot;*.sql.gz&quot;</span> -mtime +7 -delete</span><br></pre></td></tr></table></figure><hr><p><a id="cross-upgrade"></a></p><h2 id="⚙️-跨主版本升级（8-4-2-→-9-0-1）">⚙️ 跨主版本升级（8.4.2 → 9.0.1）</h2><p><a id="change-image-tag"></a></p><h3 id="📝-修改-Docker-镜像标签">📝 修改 Docker 镜像标签</h3><p>编辑 <code>docker-compose.yml</code>，将 MySQL 镜像标签改为目标版本：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nano docker-compose.yml</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改前</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">mysql:8.4.2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 修改后</span></span><br><span class="line"><span class="attr">image:</span> <span class="string">mysql:9.0.1</span></span><br></pre></td></tr></table></figure><p>📝 <strong>注意</strong>：确保使用的镜像标签存在且为官方稳定版本，避免使用latest标签可能导致的不兼容问题。</p><p><a id="add-upgrade-param"></a></p><h3 id="⚒️-添加临时升级参数">⚒️ 添加临时升级参数</h3><p>在 <code>command</code> 部分<strong>临时添加</strong> <code>--upgrade=FORCE</code> 参数：</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">command:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">--upgrade=FORCE</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">--character-set-server=utf8mb4</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">--collation-server=utf8mb4_general_ci</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">--explicit_defaults_for_timestamp=true</span></span><br></pre></td></tr></table></figure><p>🔧 <strong>参数详解</strong>：</p><ul><li><code>--upgrade=FORCE</code>：强制升级系统表结构，必需参数；</li><li><code>--character-set-server=utf8mb4</code>：确保字符集与Halo博客兼容；</li><li><code>--collation-server=utf8mb4_general_ci</code>：设置正确的排序规则；</li><li><code>--explicit_defaults_for_timestamp=true</code>：解决TIMESTAMP字段的兼容性问题。</li></ul><hr><p><a id="execute-upgrade"></a></p><h2 id="🚀-执行升级操作">🚀 执行升级操作</h2><ol><li><p><strong>拉取新版本镜像</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose pull halodb</span><br></pre></td></tr></table></figure></li><li><p><strong>启动升级</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up -d halodb</span><br></pre></td></tr></table></figure></li><li><p><strong>观察升级日志</strong>（耗时约 1-3 分钟）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">timeout</span> 180 docker compose logs -f halodb</span><br></pre></td></tr></table></figure><p>✅ <strong>成功标志</strong>：出现 <code>[Server] /usr/sbin/mysqld: ready for connections. Version: '9.0.1'</code> 且状态转为 healthy。</p></li></ol><p>📊 <strong>升级过程监控</strong>：升级期间MySQL会执行以下操作：</p><ul><li>检查现有数据文件的兼容性</li><li>升级系统表（mysql.*）到新格式</li><li>更新性能 schema 和 information_schema</li><li>验证所有数据库对象的完整性</li></ul><hr><p><a id="health-check"></a></p><h2 id="✅-升级状态确认">✅ 升级状态确认</h2><ol><li><p><strong>检查容器状态</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose ps halodb</span><br></pre></td></tr></table></figure></li><li><p><strong>手动健康检查</strong>（如果状态未更新）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> halodb mysqladmin ping -h127.0.0.1 -uroot -p<span class="string">&#x27;o#DwN&amp;JSa56&#x27;</span> --silent</span><br><span class="line"><span class="built_in">echo</span> $?   <span class="comment"># 返回 0 表示数据库正常运行</span></span><br></pre></td></tr></table></figure></li><li><p><strong>验证版本号</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it halodb mysql -uroot -p<span class="string">&#x27;o#DwN&amp;JSa56&#x27;</span> -e <span class="string">&quot;SELECT @@version;&quot;</span></span><br></pre></td></tr></table></figure><p>📌 输出应为：<code>9.0.1</code></p></li><li><p><strong>检查数据库完整性</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it halodb mysqlcheck -uroot -p<span class="string">&#x27;o#DwN&amp;JSa56&#x27;</span> --all-databases</span><br></pre></td></tr></table></figure></li></ol><hr><p><a id="cleanup"></a></p><h2 id="🔧-收尾工作">🔧 收尾工作</h2><p>升级完成后<strong>务必删除</strong>临时参数 <code>--upgrade=FORCE</code>，避免下次重启再次执行升级流程：</p><ol><li><p>编辑 <code>docker-compose.yml</code>，删除 <code>--upgrade=FORCE</code> 行；</p></li><li><p>重新部署：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose up -d</span><br></pre></td></tr></table></figure></li><li><p><strong>验证常规启动</strong>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker compose logs halodb | grep -i <span class="string">&quot;upgrade&quot;</span></span><br></pre></td></tr></table></figure><p>🚫 不应出现任何与upgrade相关的日志信息。</p></li></ol><hr><p><a id="qa-summary"></a></p><h2 id="💡-常见问题与总结">💡 常见问题与总结</h2><p>❓ <strong>Q1：升级失败如何回退？</strong><br>A：使用备份文件还原至旧版本 MySQL 容器，执行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cat</span> all_2023-11-10_12-00.sql | docker <span class="built_in">exec</span> -i halodb mysql -uroot -p<span class="string">&#x27;密码&#x27;</span></span><br></pre></td></tr></table></figure><p>❓ <strong>Q2：升级后 Halo 博客无法连接数据库？</strong><br>A：检查数据库字符集配置是否与 Halo 要求一致（通常为 <code>utf8mb4</code>），并验证网络连接。同时检查MySQL用户权限是否正常。</p><p>❓ <strong>Q3：升级过程中断怎么办？</strong><br>A：MySQL 9.x 具备升级事务完整性，中断后会自动回滚。检查日志确定中断原因，解决问题后重新启动升级流程。</p><p>❓ <strong>Q4：升级后性能下降怎么办？</strong><br>A：运行 <code>mysql_upgrade</code> 命令优化表结构，并重新生成统计信息：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> halodb mysql_upgrade -uroot -p<span class="string">&#x27;密码&#x27;</span></span><br></pre></td></tr></table></figure><p>🎯 <strong>总结</strong>：</p><ul><li>📋 跨主版本升级需谨慎操作，备份优先；</li><li>⚙️ 通过 <code>--upgrade=FORCE</code> 参数触发元数据升级；</li><li>🔧 收尾时移除临时参数，避免重复升级；</li><li>🧪 建议在测试环境演练后再升级生产环境；</li><li>📊 升级后监控系统性能，确保稳定运行。</li></ul><hr><blockquote><p>🔗 相关资源：<a href="https://dev.mysql.com/doc/refman/9.0/en/upgrading.html">MySQL 官方升级文档</a><br>💬 问题反馈：如遇到本文未覆盖的问题，请查看MySQL官方日志或社区支持</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Halo 博客升级 MySQL 数据库指南 🚀&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/mysql-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;📌 &lt;strong&gt;导读&lt;/strong&gt;：本文详细记</summary>
      
    
    
    
    <category term="Docker" scheme="https://www.meimolihan.eu.org/categories/Docker/"/>
    
    
    <category term="halo" scheme="https://www.meimolihan.eu.org/tags/halo/"/>
    
  </entry>
  
  <entry>
    <title>Debian13 服务器文件备份与恢复指南 📂</title>
    <link href="https://www.meimolihan.eu.org/posts/29d171aa.html"/>
    <id>https://www.meimolihan.eu.org/posts/29d171aa.html</id>
    <published>2025-09-14T04:13:15.000Z</published>
    <updated>2025-09-14T04:13:15.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Debian13 服务器文件备份与恢复指南 📂</h1><p><img src="https://file.meimolihan.eu.org/img/debian-backup-01.webp" alt=""></p><p>本文提供 Debian13 服务器文件备份与恢复的完整解决方案，涵盖多种同步方法与详细操作指南，助您构建可靠的数据保护策略。</p><hr><h2 id="导航目录-📚">导航目录 📚</h2><ul><li><a href="#backup-importance">📦 一 、备份的重要性与策略</a></li><li><a href="#backup">📦 二、备份操作指南</a><ul><li><a href="#local-rsync-backup">🔧 1. 本地 rsync 同步备份</a></li><li><a href="#scp-remote-backup">🚀 2. scp 远程同步备份</a></li><li><a href="#rsync-remote-backup">⚡ 3. rsync 远程同步备份</a></li></ul></li><li><a href="#restore-operations">🔄 三、恢复操作指南</a><ul><li><a href="#restore-from-local">📌 1. 从本地备份恢复</a></li><li><a href="#restore-from-remote">📌 2. 从远程备份恢复</a></li></ul></li><li><a href="#method-comparison">📊 四、三种方法对比分析</a></li><li><a href="#backup-best-practices">💡 五、备份最佳实践</a></li></ul><hr><p><a id="backup-importance"></a></p><h2 id="一、📦-备份的重要性与策略">一、📦 备份的重要性与策略</h2><p>数据是服务器中最宝贵的资产，合理的备份策略可以防止以下风险：</p><ul><li>🔴 <strong>硬件故障</strong>：磁盘损坏、服务器宕机</li><li>🔴 <strong>人为错误</strong>：误删除、错误配置</li><li>🔴 <strong>安全事件</strong>：勒索软件、黑客攻击</li><li>🔴 <strong>自然灾害</strong>：火灾、洪水等不可抗力</li></ul><p><strong>备份 3-2-1 原则</strong>：至少保留 3 个数据副本，使用 2 种不同介质，其中 1 份为异地备份。</p><hr><p><a id="backup"></a></p><h2 id="二、📦-备份操作指南">二、📦 备份操作指南</h2><p><a id="local-rsync-backup"></a></p><h3 id="1-🔧-本地-rsync-同步备份">1.🔧 本地 rsync 同步备份</h3><ul><li>rsync 是 Linux 下强大的文件同步工具，支持增量备份和属性保留。</li></ul><p><strong>测试同步（干跑模式）</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rsync -avhzL --progress --delete-delay --dry-run \</span><br><span class="line">    /etc/nginx/ \</span><br><span class="line">    <span class="string">&quot;/mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 📌 同步 nginx 主目录</span></span><br><span class="line">rsync -avhz --progress --delete-delay --mkpath \</span><br><span class="line">    /etc/nginx/ \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment">#📌 同步 html 目录</span></span><br><span class="line">rsync -avzh --progress --delete-delay --mkpath \</span><br><span class="line">    /var/www/html/ \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-标准版/html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 📌 同步文件服务目录</span></span><br><span class="line">rsync -avzh --progress --delete-delay --mkpath \</span><br><span class="line">    /mnt/file/ \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/file/</span><br></pre></td></tr></table></figure><p><strong>✨ 参数说明</strong>：</p><ul><li><code>-a</code>：归档模式，保留文件属性</li><li><code>-v</code>：详细输出</li><li><code>-h</code>：人类可读格式</li><li><code>-z</code>：压缩传输</li><li><code>--progress</code>：显示传输进度</li><li><code>--delete-delay</code>：同步后删除目标端多余文件</li><li><code>--mkpath</code>：自动创建目标路径</li></ul><p><strong>✅ 效果： 完美同步所有隐藏文件。</strong><br>✨ 原因： -a (archive) 参数包含了 -r (recursive)，它会递归复制源目录 /etc/nginx/ 下的所有内容和子目录，包括隐藏文件。这是 rsync 的默认行为，也是最可靠的方式。</p><hr><p><a id="scp-remote-backup"></a></p><h3 id="2-🚀-scp-远程同步备份">2.🚀 scp 远程同步备份</h3><p>scp 基于 SSH 协议，适合简单的文件传输任务。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 📌 同步 nginx 主目录</span></span><br><span class="line">scp -P 22 -r \</span><br><span class="line">    /etc/nginx/. \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 📌 同步 html 目录</span></span><br><span class="line">scp -P 22 -r \</span><br><span class="line">    /var/www/html/. \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 📌 同步文件服务目录</span></span><br><span class="line">scp -P 22 -r \</span><br><span class="line">    /mnt/file/ \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/file/</span><br></pre></td></tr></table></figure><p><strong>✨ 参数说明</strong>：</p><ul><li><code>-P 22</code>：指定 SSH 端口（默认22可省略）</li><li><code>-r</code>：递归复制整个目录</li><li><code>.</code> 与 <code>/</code> 的区别：使用 <code>/etc/nginx/.</code> 可包含隐藏文件</li></ul><p><strong>✅ 效果： 可以同步隐藏文件。</strong></p><ul><li>✨ 原因： 关键在于您源路径的写法 /etc/nginx/.。末尾的 /. 明确告诉 SCP 命令“复制这个目录里面的所有内容”，而不仅仅是目录本身。这个语法包含了所有文件和文件夹，包括隐藏的。</li><li>⚠️ 注意： 如果您将命令写成 /etc/nginx 或 /etc/nginx/（没有最后的 .），SCP 将无法同步隐藏文件。您的写法是正确的。</li></ul><hr><p><a id="rsync-remote-backup"></a></p><h3 id="3-⚡-rsync-远程同步备份">3.⚡ rsync 远程同步备份</h3><p>rsync 远程模式结合了本地同步的高效和远程操作的便利性。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 📌 同步 nginx 主目录</span></span><br><span class="line">rsync -avzP \</span><br><span class="line">    /etc/nginx/ \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 📌 同步 html 目录</span></span><br><span class="line">rsync -avzP \</span><br><span class="line">    /var/www/html/ \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 📌 同步文件服务目录</span></span><br><span class="line">rsync -avzP \</span><br><span class="line">    /mnt/file/ \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/file/</span><br></pre></td></tr></table></figure><p><strong>✨ 参数说明</strong>：</p><ul><li><code>-P</code>：等同于 <code>--partial --progress</code>（保留部分文件并显示进度）</li><li><code>-z</code>：压缩传输，节省带宽</li></ul><p><strong>✅ 效果： 完美同步所有隐藏文件。</strong></p><ul><li>✨ 原因： 和本地 rsync 一样，-a 参数保证了它会递归处理源目录下的所有内容，包括隐藏文件。这是同步隐藏文件到远程服务器的最佳方式。</li></ul><hr><p><a id="restore-operations"></a></p><h2 id="三、🔄-恢复操作指南">三、🔄 恢复操作指南</h2><p><a id="restore-from-local"></a></p><h3 id="1-📌-从本地备份恢复">1. 📌 从本地备份恢复</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 恢复 nginx 配置</span></span><br><span class="line">rsync -avzh --progress --mkpath \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/ \</span><br><span class="line">    /etc/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复网站文件</span></span><br><span class="line">rsync -avzh --progress --mkpath \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/nginx-标准版/html/ \</span><br><span class="line">    /var/www/html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 恢复文件服务</span></span><br><span class="line">rsync -avzh --progress --mkpath \</span><br><span class="line">    /mnt/smb_fnos/阿里云盘/教程文件/Debian13/backup/file/ \</span><br><span class="line">    /mnt/file/</span><br></pre></td></tr></table></figure><p><a id="restore-from-remote"></a></p><h3 id="2-📌-从远程备份恢复">2. 📌 从远程备份恢复</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 rsync 从远程恢复 nginx 配置</span></span><br><span class="line">rsync -avzP \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/nginx/ \</span><br><span class="line">    /etc/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 scp 从远程恢复网站文件</span></span><br><span class="line">scp -P 22 -r \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/nginx-标准版/html/. \</span><br><span class="line">    /var/www/html/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 rsync 从远程恢复文件服务</span></span><br><span class="line">rsync -avzP \</span><br><span class="line">    root@10.10.10.251:/vol2/1000/阿里云盘/教程文件/Debian13/backup/file/ \</span><br><span class="line">    /mnt/file/</span><br></pre></td></tr></table></figure><blockquote><p><strong>⚠️ 重要提示</strong>：恢复操作会覆盖目标目录中的现有文件，执行前请务必：</p><ol><li>确认备份数据的完整性和正确性</li><li>对当前状态做一次快照备份</li><li>在测试环境验证恢复流程</li></ol></blockquote><hr><p><a id="method-comparison"></a></p><h2 id="四、📊-三种方法对比分析">四、📊 三种方法对比分析</h2><table><thead><tr><th style="text-align:left">特性维度</th><th style="text-align:left">🔧 本地 rsync 同步</th><th style="text-align:left">🚀 scp 远程同步</th><th style="text-align:left">⚡ rsync 远程同步</th></tr></thead><tbody><tr><td style="text-align:left"><strong>速度性能</strong></td><td style="text-align:left">⭐⭐⭐⭐⭐<br>极快（无网络延迟）</td><td style="text-align:left">⭐⭐☆☆☆<br>较慢（全量传输）</td><td style="text-align:left">⭐⭐⭐⭐☆<br>很快（增量同步）</td></tr><tr><td style="text-align:left"><strong>带宽效率</strong></td><td style="text-align:left">不占用网络带宽</td><td style="text-align:left">效率低（全量传输）</td><td style="text-align:left">效率高（只传差异部分）</td></tr><tr><td style="text-align:left"><strong>属性保留</strong></td><td style="text-align:left">完美保留所有属性</td><td style="text-align:left">默认不保留所有属性</td><td style="text-align:left">完美保留所有属性</td></tr><tr><td style="text-align:left"><strong>可靠性</strong></td><td style="text-align:left">高</td><td style="text-align:left">高（基于SSH）</td><td style="text-align:left">高（支持断点续传）</td></tr><tr><td style="text-align:left"><strong>易用性</strong></td><td style="text-align:left">中等（需挂载远程目录）</td><td style="text-align:left">非常简单（直接使用）</td><td style="text-align:left">中等（命令稍复杂）</td></tr><tr><td style="text-align:left"><strong>适用场景</strong></td><td style="text-align:left">已挂载NAS的日常备份</td><td style="text-align:left">临时少量文件传输</td><td style="text-align:left">常规远程异地备份</td></tr></tbody></table><p><strong>选择建议</strong>：</p><ul><li>🏠 <strong>本地 rsync</strong>：适合已将远程存储挂载到本地的日常自动化备份</li><li>🚀 <strong>scp</strong>：适合临时传输少量文件，简单快捷</li><li>⚡ <strong>远程 rsync</strong>：适合设置定期远程备份任务，效率最高</li></ul><hr><p><a id="backup-best-practices"></a></p><h2 id="五、💡-备份最佳实践">五、💡 备份最佳实践</h2><h3 id="1-自动化备份策略">1. 自动化备份策略</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每日凌晨2点自动备份nginx配置</span></span><br><span class="line">0 2 * * * /usr/bin/rsync -avz --delete /etc/nginx/ /mnt/backup/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 每周日凌晨1点全量备份</span></span><br><span class="line">0 1 * * 0 /root/scripts/full-backup.sh</span><br></pre></td></tr></table></figure><h3 id="2-多版本备份策略">2. 多版本备份策略</h3><p>保留多个时间点的备份版本：</p><ul><li>保留最近7天的每日备份</li><li>保留最近4周的每周备份</li><li>保留最近3个月的月度备份</li></ul><h3 id="3-备份验证策略">3. 备份验证策略</h3><p>定期检查备份的有效性：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 检查备份完整性</span></span><br><span class="line">rsync -n -avhi --delete /mnt/backup/nginx/ /etc/nginx/ | <span class="built_in">head</span> -20</span><br><span class="line"></span><br><span class="line"><span class="comment"># 随机恢复测试</span></span><br><span class="line"><span class="built_in">mkdir</span> /tmp/backup-test &amp;&amp; rsync -av /mnt/backup/html/ /tmp/backup-test/</span><br></pre></td></tr></table></figure><h3 id="4-安全加固措施">4. 安全加固措施</h3><ul><li>🔐 对敏感数据加密备份</li><li>👮 严格控制备份目录权限</li><li>📝 详细记录备份日志</li><li>🚨 设置备份失败告警机制</li></ul><h3 id="5-监控与告警">5. 监控与告警</h3><p>设置监控项：</p><ul><li>备份任务执行状态</li><li>备份文件大小变化</li><li>备份存储空间使用率</li><li>最后一次成功备份时间</li></ul><hr><blockquote><p><strong>💎 核心建议</strong>：没有完美的备份方案，只有适合的备份策略。最重要的是定期测试恢复流程，确保在需要时能够快速可靠地恢复数据。</p></blockquote>]]></content>
    
    
      
      
    <summary type="html">&lt;h1&gt;Debian13 服务器文件备份与恢复指南 📂&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://file.meimolihan.eu.org/img/debian-backup-01.webp&quot; alt=&quot;&quot;&gt;&lt;/p&gt;
&lt;p&gt;本文提供 Debian13 服务器文件备</summary>
      
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="debian" scheme="https://www.meimolihan.eu.org/tags/debian/"/>
    
  </entry>
  
  <entry>
    <title>Nginx 配置备份与恢复指南 🔐</title>
    <link href="https://www.meimolihan.eu.org/posts/d51d958e.html"/>
    <id>https://www.meimolihan.eu.org/posts/d51d958e.html</id>
    <published>2025-09-14T02:31:37.000Z</published>
    <updated>2025-09-14T02:31:37.000Z</updated>
    
    <content type="html"><![CDATA[<h1>Nginx 配置备份与恢复指南 🔐</h1><p><img src="https://file.meimolihan.eu.org/img/nginx-01.webp" alt=""></p><blockquote><p>为确保您的 Nginx 服务器稳定运行，定期备份和掌握恢复方法至关重要。本文全面介绍了多种 Nginx 备份与恢复策略，从简单的压缩备份到高效的同步方案，助您构建完整的数据保护体系。</p></blockquote><hr><h2 id="📚-文章导航目录">📚 文章导航目录</h2><ul><li><a href="#preface-why-backup-nginx">💡 前言：为何需要备份 Nginx？</a></li><li><a href="#method-one-backup-with-zip">📦 方法一：使用 ZIP 压缩备份</a><ul><li><a href="#features-and-functions-zip">✨ 特点与功能</a></li><li><a href="#commands-zip">🔧 操作命令</a></li></ul></li><li><a href="#method-two-backup-with-targz">🗂️ 方法二：使用 TAR.GZ 压缩备份</a><ul><li><a href="#features-and-functions-tar">✨ 特点与功能</a></li><li><a href="#commands-tar">🔧 操作命令</a></li></ul></li><li><a href="#method-three-backup-with-rsync">🔄 方法三：使用 Rsync 同步备份</a><ul><li><a href="#features-and-functions-rsync">✨ 特点与功能</a></li><li><a href="#commands-rsync">🔧 操作命令</a></li></ul></li><li><a href="#backup-summary-and-comparison">📊 备份方法总结与对比</a></li><li><a href="#pre-restore-preparation">🛡️ 恢复前的准备工作</a></li><li><a href="#restore-from-backups">📤 从各种备份恢复</a><ul><li><a href="#restore-from-zip">从 ZIP 备份恢复</a><ul><li><a href="#zip-restore-commands">操作命令</a></li></ul></li><li><a href="#restore-from-targz">从 TAR.GZ 备份恢复</a><ul><li><a href="#targz-restore-commands">操作命令</a></li><li><a href="#targz-restore-scenarios">不同压缩方式的恢复场景</a></li></ul></li><li><a href="#restore-from-rsync">从 Rsync 备份恢复</a><ul><li><a href="#rsync-restore-commands">操作命令</a></li><li><a href="#rsync-restore-warning">重要警告</a></li></ul></li></ul></li><li><a href="#post-restore-actions">✅ 恢复后的必要操作</a></li><li><a href="#notes-and-faq">🚨 注意事项与常见问题</a></li><li><a href="#complete-process-summary">🎯 完整备份与恢复流程总结</a></li></ul><hr><p><a id="preface-why-backup-nginx"></a></p><h2 id="💡-前言：为何需要备份-Nginx？">💡 前言：为何需要备份 Nginx？</h2><p>Nginx 的配置是其核心，包含了网站域名、反向代理规则、负载均衡设置、SSL 证书路径等关键信息。一旦因为误操作、服务器磁盘故障或软件冲突导致配置丢失或损坏，可能会造成服务长时间中断。定期备份可以帮助您：</p><ul><li><strong>快速恢复</strong> ⚡：在出现问题时，迅速还原至最新可用的状态。</li><li><strong>版本追溯</strong> 🔍：保留历史版本，便于对比更改或回滚到特定版本。</li><li><strong>迁移便利</strong> 🚚：在新服务器上快速部署相同的 Nginx 环境。</li></ul><p>🔔 <strong>备份核心目标</strong>：通常需要备份 <code>/etc/nginx/</code> 目录（包含主配置文件 <code>nginx.conf</code> 和 <code>sites-available/</code> 等）以及 <code>/var/www/html/</code> 或您的自定义网站根目录。</p><p><a id="method-one-backup-with-zip"></a></p><h2 id="📦-方法一：使用-ZIP-压缩备份">📦 方法一：使用 ZIP 压缩备份</h2><p>ZIP 是一种跨平台、通用的压缩格式，在 Windows 和 Linux 系统上都能轻松打开和处理，非常适合需要在不同环境间传输的备份。</p><p><a id="features-and-functions-zip"></a></p><h3 id="✨-特点与功能">✨ 特点与功能</h3><ul><li><strong>通用性强</strong> 🌍：几乎所有操作系统都内置或易于安装解压支持。</li><li><strong>兼容性好</strong> 🤝：便于分享给其他团队成员，无需担心环境问题。</li><li><strong>可设置密码</strong> 🔒：支持使用密码加密压缩包，保护敏感配置（如 SSL 证书密钥）。</li><li><strong>灵活性高</strong> 🧩：可以自由选择是否递归压缩、排除特定文件等。</li></ul><p><a id="commands-zip"></a></p><h3 id="🔧-操作命令">🔧 操作命令</h3><p><a id="recursive-compression-common-practice"></a></p><h4 id="1-递归压缩（常见做法）">1. 递归压缩（常见做法）</h4><p>此命令会备份 <code>/etc/nginx</code> 目录下的所有文件和子目录。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 压缩并带上日期</span></span><br><span class="line">zip -r /mnt/backup/nginx-backup-$(<span class="built_in">date</span> +%Y%m%d).zip /etc/nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># -r 参数：递归处理，压缩目录下的所有子目录和文件。</span></span><br><span class="line"><span class="comment"># $(date +%Y%m%d): shell 命令，生成当前日期（例如：20230915），用于文件名。</span></span><br></pre></td></tr></table></figure><p><a id="non-recursive-compression-top-level-only"></a></p><h4 id="2-非递归压缩（仅顶级目录）">2. 非递归压缩（仅顶级目录）</h4><p>根据您的需求，如果只想备份 <code>/etc/nginx</code> 第一层的文件和目录（但不压缩它们里面的内容），可以使用 <code>find</code> 命令。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 非递归压缩：仅备份 /etc/nginx 下的直接文件和文件夹（其内容不压缩）</span></span><br><span class="line">find /etc/nginx -maxdepth 1 -mindepth 1 -<span class="built_in">exec</span> zip /mnt/backup/nginx-backup-$(<span class="built_in">date</span> +%Y%m%d).zip &#123;&#125; +</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># find ... -exec ... + : 找到指定的文件列表并将其传递给 zip 命令。</span></span><br><span class="line"><span class="comment"># -maxdepth 1: 只查找第一层。</span></span><br><span class="line"><span class="comment"># -mindepth 1: 排除路径本身（即排除 `/etc/nginx/.`）。</span></span><br></pre></td></tr></table></figure><p><a id="method-two-backup-with-targz"></a></p><h2 id="🗂️-方法二：使用-TAR-GZ-压缩备份">🗂️ 方法二：使用 TAR.GZ 压缩备份</h2><p>TAR.GZ (<code>.tar.gz</code>) 是 Linux 系统中最常见、效率最高的压缩格式之一。它通常能提供比 ZIP 更好的压缩率，且完美保留 Linux 文件权限和所有权信息。</p><p><a id="features-and-functions-tar"></a></p><h3 id="✨-特点与功能-2">✨ 特点与功能</h3><ul><li><strong>高压缩率</strong> 📦：通常能生成比 ZIP 更小的文件，节省存储空间。</li><li><strong>保留元数据</strong> 📋：完美保留文件权限、所有者和时间戳，对于还原至关重要。</li><li><strong>Linux 原生支持</strong> 🐧：是 Linux 系统备份和分发的标准格式。</li><li><strong>流式处理</strong> 🔄：适合在管道中与其他命令（如 <code>ssh</code>, <code>gpg</code>) 结合使用。</li></ul><p><a id="commands-tar"></a></p><h3 id="🔧-操作命令-2">🔧 操作命令</h3><p><a id="regular-compression-full-path"></a></p><h4 id="1-常规压缩（保留完整路径）">1. 常规压缩（保留完整路径）</h4><p>此方法会保留完整的绝对路径结构。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 常规压缩</span></span><br><span class="line">tar -czf /mnt/backup/nginx-backup-$(<span class="built_in">date</span> +%Y%m%d).tar.gz /etc/nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># -c: 创建新的归档文件。</span></span><br><span class="line"><span class="comment"># -z: 使用 gzip 压缩。</span></span><br><span class="line"><span class="comment"># -f: 指定归档文件名。</span></span><br></pre></td></tr></table></figure><p><a id="precise-compression-control-structure"></a></p><h4 id="2-精准压缩（控制解压结构）">2. 精准压缩（控制解压结构）</h4><p>使用 <code>-C</code> 参数改变当前目录，可以控制解压后的目录结构。<strong>这是非常推荐的技巧</strong>，可以让解压后的目录名称统一为 <code>nginx</code>，而不是包含完整路径 <code>etc/nginx</code>。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 精准压缩：解压后直接得到 `nginx` 文件夹</span></span><br><span class="line">tar -czf /mnt/backup/nginx-backup-$(<span class="built_in">date</span> +%Y%m%d).tar.gz -C /etc nginx</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># -C /etc: 先切换到 /etc 目录。</span></span><br><span class="line"><span class="comment"># nginx: 然后压缩该目录下的 nginx 文件夹。</span></span><br><span class="line"><span class="comment"># 这样操作后，解压 tar.gz 文件会直接产生一个名为 `nginx` 的目录，而不是 `etc/nginx/`。</span></span><br></pre></td></tr></table></figure><p><a id="method-three-backup-with-rsync"></a></p><h2 id="🔄-方法三：使用-Rsync-同步备份">🔄 方法三：使用 Rsync 同步备份</h2><p>Rsync 是一个强大的增量备份和同步工具。它并不压缩文件，而是通过比较源和目标之间的差异，仅传输改变的部分，因此速度极快，非常适合频繁备份或大型网站文件的同步。</p><p><a id="features-and-functions-rsync"></a></p><h3 id="✨-特点与功能-3">✨ 特点与功能</h3><ul><li><strong>增量备份</strong> 📈：仅同步发生变化的文件，效率极高，节省带宽和时间。</li><li><strong>保持一致性</strong> 🔒：可以完美保留所有的文件属性（权限、时间戳、符号链接等）。</li><li><strong>灵活性高</strong> 🎛️：可以轻松实现本地同步和远程同步。</li><li><strong>可脚本化</strong> 🤖：非常适合放入 <code>cron</code> 计划任务中，实现定时自动备份。</li></ul><p><a id="commands-rsync"></a></p><h3 id="🔧-操作命令-3">🔧 操作命令</h3><p><a id="local-sync-fast-incremental"></a></p><h4 id="1-本地同步（快速增量）">1. 本地同步（快速增量）</h4><p>将 Nginx 配置同步到本地另一个磁盘或分区。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 本地同步</span></span><br><span class="line">rsync -av --delete /etc/nginx/ /mnt/backup/nginx-config/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># -a: 归档模式，保持所有文件属性，并递归同步。</span></span><br><span class="line"><span class="comment"># -v: 详细模式，输出同步过程信息。</span></span><br><span class="line"><span class="comment"># --delete: 删除目标目录中源目录没有的文件，确保两边完全一致（使用前请谨慎！）。</span></span><br><span class="line"><span class="comment"># 注意：源目录路径后的尾随斜杠 `/` 很重要，它表示同步目录内的内容，而不是目录本身。</span></span><br></pre></td></tr></table></figure><p><a id="remote-sync-off-site-disaster-recovery"></a></p><h4 id="2-远程同步（异机容灾）">2. 远程同步（异机容灾）</h4><p>将本地 Nginx 配置同步到远程服务器，实现异机容灾。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 远程同步</span></span><br><span class="line">rsync -avz -e ssh /etc/nginx/ user@remote_server_ip:/path/to/backup/nginx-config/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 解释：</span></span><br><span class="line"><span class="comment"># -z: 在传输过程中进行压缩，提高速度。</span></span><br><span class="line"><span class="comment"># -e ssh: 使用 SSH 协议进行安全传输。</span></span><br><span class="line"><span class="comment"># user@remote_server_ip: 远程服务器的用户名和 IP 地址。</span></span><br></pre></td></tr></table></figure><p><a id="backup-summary-and-comparison"></a></p><h2 id="📊-备份方法总结与对比">📊 备份方法总结与对比</h2><table><thead><tr><th style="text-align:left">方法</th><th style="text-align:left">格式</th><th style="text-align:left">优点</th><th style="text-align:left">缺点</th><th style="text-align:left">适用场景</th></tr></thead><tbody><tr><td style="text-align:left"><strong>ZIP 压缩</strong></td><td style="text-align:left"><code>.zip</code></td><td style="text-align:left">通用性强，跨平台，可加密</td><td style="text-align:left">Linux 下压缩率通常不如 tar.gz，保留元数据稍逊</td><td style="text-align:left">需要与 Windows 系统共享备份文件</td></tr><tr><td style="text-align:left"><strong>TAR.GZ 压缩</strong></td><td style="text-align:left"><code>.tar.gz</code></td><td style="text-align:left"><strong>高压缩率</strong>，<strong>完美保留 Linux 属性</strong>，标准格式</td><td style="text-align:left">Windows 需安装软件才能解压</td><td style="text-align:left"><strong>Linux 系统下的标准完整备份</strong>，长期归档</td></tr><tr><td style="text-align:left"><strong>Rsync 同步</strong></td><td style="text-align:left">原始文件</td><td style="text-align:left"><strong>增量同步，速度极快</strong>，可本地/远程，可脚本化</td><td style="text-align:left">不压缩，占用更多空间</td><td style="text-align:left"><strong>频繁的快速备份</strong>，<strong>异地容灾</strong>，<strong>网站文件同步</strong></td></tr></tbody></table><p><a id="pre-restore-preparation"></a></p><h2 id="🛡️-恢复前的准备工作">🛡️ 恢复前的准备工作</h2><p>在开始任何恢复操作之前，请务必完成以下步骤，这是数据安全的黄金法则：</p><ol><li><p><strong>【强烈建议】备份当前状态</strong> 💾：即使当前的 Nginx 配置是损坏的，也先将其打包备份，防止恢复过程中出现意外，导致完全无法回退。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 备份当前的 nginx 配置</span></span><br><span class="line"><span class="built_in">sudo</span> tar -czf /tmp/nginx-broken-backup-$(<span class="built_in">date</span> +%Y%m%d).tar.gz /etc/nginx</span><br></pre></td></tr></table></figure></li><li><p><strong>验证备份文件</strong> 🔍：检查您的备份文件是否完整、可用。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 列出 ZIP 压缩包内容</span></span><br><span class="line">unzip -l /mnt/backup/nginx-backup-20230915.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 列出 TAR.GZ 压缩包内容</span></span><br><span class="line">tar -tzf /mnt/backup/nginx-backup-20230915.tar.gz</span><br></pre></td></tr></table></figure></li><li><p><strong>选择恢复目标</strong> 🎯：确定您是要<strong>完全覆盖</strong>现有配置，还是只<strong>恢复部分文件</strong>（如某个 server block 配置）。</p></li></ol><p><a id="restore-from-backups"></a></p><h2 id="📤-从各种备份恢复">📤 从各种备份恢复</h2><p>本章节详细介绍了如何从之前创建的三种不同类型的备份中进行恢复。请根据您采用的备份方法，选择对应的恢复指南。</p><p><a id="restore-from-zip"></a></p><h3 id="1-从-ZIP-备份恢复">1. 从 ZIP 备份恢复</h3><p>使用 <code>unzip</code> 命令来解压恢复。</p><p><a id="zip-restore-commands"></a></p><h4 id="🔧-操作命令-4">🔧 操作命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 1. 安全做法：解压到当前目录查看内容（会得到包含完整路径的 etc/nginx/ 目录结构）</span></span><br><span class="line">unzip /mnt/backup/nginx-backup-20230915.zip</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 直接覆盖恢复到系统原始路径 (使用 -o 参数覆盖现有文件，-d / 指定解压到根目录)</span></span><br><span class="line"><span class="built_in">sudo</span> unzip -o /mnt/backup/nginx-backup-20230915.zip -d /</span><br></pre></td></tr></table></figure><p><a id="restore-from-targz"></a></p><h3 id="2-从-TAR-GZ-备份恢复">2. 从 TAR.GZ 备份恢复</h3><p>使用 <code>tar</code> 命令来解压恢复，这是 Linux 系统中最常用且可靠的方式。</p><p><a id="targz-restore-commands"></a></p><h4 id="🔧-操作命令-5">🔧 操作命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 场景一：恢复&quot;常规压缩&quot;的备份（压缩时使用了 `tar -czf backup.tar.gz /etc/nginx`，压缩包内保留了完整路径 /etc/nginx/...）</span></span><br><span class="line"><span class="comment"># -C / 参数指定解压到根目录，压缩包里的 etc/nginx 就会覆盖系统中的 /etc/nginx</span></span><br><span class="line"><span class="built_in">sudo</span> tar -xzf /mnt/backup/nginx-backup-20230915.tar.gz -C /</span><br><span class="line"></span><br><span class="line"><span class="comment"># 场景二：恢复&quot;精准压缩&quot;的备份（压缩时使用了 `tar -czf backup.tar.gz -C /etc nginx`，压缩包内直接是 nginx/... 目录）</span></span><br><span class="line"><span class="comment"># -C /etc 参数指定解压到 /etc 目录，压缩包里的 nginx 文件夹就会覆盖 /etc/nginx</span></span><br><span class="line"><span class="built_in">sudo</span> tar -xzf /mnt/backup/nginx-backup-20230915.tar.gz -C /etc</span><br><span class="line"></span><br><span class="line"><span class="comment"># 场景三：最安全、最推荐的做法！解压到临时目录检查后再手动复制</span></span><br><span class="line"><span class="comment"># 1. 创建临时目录</span></span><br><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /tmp/nginx-restore</span><br><span class="line"><span class="comment"># 2. 解压到临时目录</span></span><br><span class="line"><span class="built_in">sudo</span> tar -xzf /mnt/backup/nginx-backup-20230915.tar.gz -C /tmp/nginx-restore</span><br><span class="line"><span class="comment"># 3. 查看解压后的结构，确认是否正确</span></span><br><span class="line"><span class="built_in">ls</span> -la /tmp/nginx-restore/</span><br><span class="line"><span class="comment"># 4. 使用 rsync 同步到目标位置（这样可以再次确认文件变更）</span></span><br><span class="line"><span class="built_in">sudo</span> rsync -av /tmp/nginx-restore/nginx/ /etc/nginx/</span><br><span class="line"><span class="comment"># 如果解压后是 etc/nginx 结构，则使用：</span></span><br><span class="line"><span class="comment"># sudo rsync -av /tmp/nginx-restore/etc/nginx/ /etc/nginx/</span></span><br></pre></td></tr></table></figure><p><a id="targz-restore-scenarios"></a></p><h4 id="📋-不同压缩方式的恢复场景">📋 不同压缩方式的恢复场景</h4><ul><li><strong>完整路径备份</strong>：使用 <code>tar -czf backup.tar.gz /etc/nginx</code> 创建，恢复时使用 <code>sudo tar -xzf backup.tar.gz -C /</code></li><li><strong>精准路径备份</strong>：使用 <code>tar -czf backup.tar.gz -C /etc nginx</code> 创建，恢复时使用 <code>sudo tar -xzf backup.tar.gz -C /etc</code></li></ul><p><a id="restore-from-rsync"></a></p><h3 id="3-从-Rsync-备份恢复">3. 从 Rsync 备份恢复</h3><p>从 Rsync 备份恢复的本质，就是<strong>将同步过程反向操作</strong>。您的备份目录现在是&quot;源&quot;，系统的 <code>/etc/nginx</code> 目录是&quot;目标&quot;。</p><p><a id="rsync-restore-commands"></a></p><h4 id="🔧-操作命令-6">🔧 操作命令</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 从本地备份目录恢复</span></span><br><span class="line"><span class="built_in">sudo</span> rsync -av /mnt/backup/nginx-config/ /etc/nginx/</span><br><span class="line"></span><br><span class="line"><span class="comment"># 从远程备份服务器恢复</span></span><br><span class="line"><span class="built_in">sudo</span> rsync -avz -e ssh user@remote_server_ip:/path/to/backup/nginx-config/ /etc/nginx/</span><br></pre></td></tr></table></figure><p><a id="rsync-restore-warning"></a></p><h4 id="⚠️-重要警告">⚠️ 重要警告</h4><p>如果当初备份时使用了 <code>--delete</code> 参数，恢复时<strong>请极其谨慎地使用它</strong>。在恢复命令中加上 <code>--delete</code> 会<strong>删除目标目录（即您的当前配置）中所有源目录（即您的备份）里不存在的文件</strong>。这可能导致数据丢失。<br><strong>建议流程</strong>：先不加 <code>--delete</code> 同步，检查无误后，再手动清理多余文件。</p><p><a id="post-restore-actions"></a></p><h2 id="✅-恢复后的必要操作">✅ 恢复后的必要操作</h2><p>恢复文件只是第一步，接下来的验证和激活同样重要。</p><ol><li><p><strong>测试 Nginx 配置语法</strong> ✅：<strong>这是必须的一步！</strong> 它可以检查恢复的配置文件是否有语法错误，避免重启失败导致服务中断。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> nginx -t</span><br></pre></td></tr></table></figure><p>如果输出 <code>syntax is ok</code> 和 <code>test is successful</code>，说明配置语法正确。</p></li><li><p><strong>重载 Nginx</strong> 🔄：在语法测试通过后，让 Nginx 重新加载配置即可，<strong>无需完全重启</strong>，服务不会中断。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl reload nginx</span><br><span class="line"><span class="comment"># 或者使用 nginx 命令</span></span><br><span class="line"><span class="built_in">sudo</span> nginx -s reload</span><br></pre></td></tr></table></figure></li><li><p><strong>验证服务状态</strong> 📊：检查 Nginx 是否正常运行。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl status nginx</span><br></pre></td></tr></table></figure></li><li><p><strong>测试网站访问</strong> 🌐：最终通过浏览器或 <code>curl</code> 命令访问你的网站，确认服务已按预期恢复。</p></li></ol><p><a id="notes-and-faq"></a></p><h2 id="🚨-注意事项与常见问题">🚨 注意事项与常见问题</h2><ul><li><strong>权限问题</strong> 🔐：使用 <code>sudo</code> 进行恢复操作，确保你有足够的权限写入 <code>/etc/nginx</code> 等系统目录。解压后检查重要文件（如 SSL 证书私钥）的权限是否过于开放（如 <code>600</code> 或 <code>400</code>）。</li><li><strong>&quot;精准压缩&quot;备份的恢复</strong> 🎯：这是最容易出错的点。务必先 <code>tar -tzf</code> 查看压缩包内结构，再决定 <code>-C</code> 参数的使用。</li><li><strong>Rsync 的 <code>--delete</code> 参数</strong> ⚠️：恢复时请<strong>谨慎使用</strong> <code>--delete</code>。最好先不加该参数同步，然后再手动清理差异文件。</li><li><strong>文件覆盖</strong> 📁：恢复操作会覆盖目标路径下的同名文件，且通常无法撤销。这就是为什么第一步强调要<strong>备份当前状态</strong>。</li><li><strong>环境差异</strong> 🔄：如果是在新的服务器上恢复，请注意可能与旧环境存在差异（如依赖的模块、版本、系统路径等）。</li></ul><p><a id="complete-process-summary"></a></p><h2 id="🎯-完整备份与恢复流程总结">🎯 完整备份与恢复流程总结</h2><p><strong>备份策略建议</strong>：</p><ul><li><strong>组合使用</strong> 🤝：使用 <code>rsync</code> 进行每日的增量同步到远程服务器，同时每周使用 <code>tar -czf</code> 进行一次完整压缩备份并异地存储。</li><li><strong>自动化</strong> 🤖：将备份命令写入脚本，并通过 <code>cron</code> 计划任务实现定时自动备份。</li><li><strong>验证备份</strong> 🔍：定期检查备份文件是否完好无损，并尝试在测试环境中还原，确保备份的有效性。</li></ul><p><strong>恢复流程</strong>：准备 → 验证备份 → 执行恢复 → 测试配置 (<code>nginx -t</code>) → 重载服务 (<code>reload</code>) → 业务验证</p><p>遵循这个完整流程，可以最大限度地保证 Nginx 配置备份与恢复操作的安全性和可靠性，确保您的 Web 服务持续稳定运行。🚀</p><hr><blockquote><p>💡 提示：定期演练恢复过程至关重要，确保在真正需要时您能够熟练、快速地进行操作。</p></blockquote>]]></content>
    
    
    <summary type="html">为确保您的 Nginx 服务器稳定运行，定期备份和掌握恢复方法至关重要。本文全面介绍了多种 Nginx 备份与恢复策略，从简单的压缩备份到高效的同步方案，助您构建完整的数据保护体系。</summary>
    
    
    
    <category term="Linux" scheme="https://www.meimolihan.eu.org/categories/Linux/"/>
    
    
    <category term="nginx" scheme="https://www.meimolihan.eu.org/tags/nginx/"/>
    
  </entry>
  
</feed>
